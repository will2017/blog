<html><head title="/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/email/header.py"><style type='text/css'>
body { color: #666666; } 
a {text-decoration: none; color: #5A82F7}
table, th, td { border: 1px solid lightgrey; padding: 5px; corner: rounded; }
.builtin {color: #B17E41;}
.comment, .block-comment {color: #aaaaaa; font-style: italic;}
.constant {color: #888888;}
.decorator {color: #778899;}
.doc-string {color: #aaaaaa;}
.error {border-bottom: 1px solid red;}
.field-name {color: #2e8b57;}
.function {color: #4682b4;}
.identifier {color: #8b7765;}
.info {border-bottom: 1px dotted RoyalBlue;}
.keyword {color: #0000cd;}
.lineno {color: #aaaaaa;}
.number {color: #483d8b;}
.parameter {color: #777777;}
.string {color: #999999;}
.type-name {color: #4682b4;}
.warning {border-bottom: 1px dotted orange;}
</style>
<script language="JavaScript" type="text/javascript">
var highlighted = new Array();
function highlight()
{
    // clear existing highlights
    for (var i = 0; i < highlighted.length; i++) {
        var elm = document.getElementById(highlighted[i]);
        if (elm != null) {
            elm.style.backgroundColor = 'white';
        }
    }
    highlighted = new Array();
    for (var i = 0; i < arguments.length; i++) {
        var elm = document.getElementById(arguments[i]);
        if (elm != null) {
            elm.style.backgroundColor='gold';
        }
        highlighted.push(arguments[i]);
    }
} </script>
</head>
<body>
<table width=100% border='1px solid gray'><tr><td valign='top'><ul>
<li><a href='#re', onmouseover='highlight("re")'>re</a></li><li><a href='#header.__all__', onmouseover='highlight("header___all__")'><span class='identifier'>__all__</span></a></li><li><a href='#header.NL', onmouseover='highlight("header_NL")'><span class='identifier'>NL</span></a></li><li><a href='#header.SPACE', onmouseover='highlight("header_SPACE")'><span class='identifier'>SPACE</span></a></li><li><a href='#header.USPACE', onmouseover='highlight("header_USPACE")'><span class='identifier'>USPACE</span></a></li><li><a href='#header.SPACE8', onmouseover='highlight("header_SPACE8")'><span class='identifier'>SPACE8</span></a></li><li><a href='#header.UEMPTYSTRING', onmouseover='highlight("header_UEMPTYSTRING")'><span class='identifier'>UEMPTYSTRING</span></a></li><li><a href='#header.MAXLINELEN', onmouseover='highlight("header_MAXLINELEN")'><span class='identifier'>MAXLINELEN</span></a></li><li><a href='#header.USASCII', onmouseover='highlight("header_USASCII")'><span class='identifier'>USASCII</span></a></li><li><a href='#header.UTF8', onmouseover='highlight("header_UTF8")'><span class='identifier'>UTF8</span></a></li><li><a href='#header.ecre', onmouseover='highlight("header_ecre")'><span class='identifier'>ecre</span></a></li><li><a href='#header.fcre', onmouseover='highlight("header_fcre")'><span class='identifier'>fcre</span></a></li><li><a href='#header._embeded_header', onmouseover='highlight("header__embeded_header")'><span class='identifier'>_embeded_header</span></a></li><li><a href='#header._max_append', onmouseover='highlight("header__max_append")'><span class='identifier'>_max_append</span></a></li><li><a href='#header.decode_header', onmouseover='highlight("header_decode_header")'><span class='function'>decode_header</span></a></li><li><a href='#header.make_header', onmouseover='highlight("header_make_header")'><span class='function'>make_header</span></a></li><li><a href='#header.Header', onmouseover='highlight("header_Header")'><span class='type-name'>Header</span></a><ul>
<li><a href='#header.Header.__init__', onmouseover='highlight("header_Header___init__")'><span class='function'>__init__</span></a></li><li><a href='#header.Header.__str__', onmouseover='highlight("header_Header___str__")'><span class='function'>__str__</span></a></li><li><a href='#header.Header.__unicode__', onmouseover='highlight("header_Header___unicode__")'><span class='function'>__unicode__</span></a></li><li><a href='#header.Header.__eq__', onmouseover='highlight("header_Header___eq__")'><span class='function'>__eq__</span></a></li><li><a href='#header.Header.__ne__', onmouseover='highlight("header_Header___ne__")'><span class='function'>__ne__</span></a></li><li><a href='#header.Header.append', onmouseover='highlight("header_Header_append")'><span class='function'>append</span></a></li><li><a href='#header.Header._split', onmouseover='highlight("header_Header__split")'><span class='function'>_split</span></a></li><li><a href='#header.Header._split_ascii', onmouseover='highlight("header_Header__split_ascii")'><span class='function'>_split_ascii</span></a></li><li><a href='#header.Header._encode_chunks', onmouseover='highlight("header_Header__encode_chunks")'><span class='function'>_encode_chunks</span></a></li><li><a href='#header.Header.encode', onmouseover='highlight("header_Header_encode")'><span class='function'>encode</span></a></li></ul>
</li><li><a href='#header._split_ascii', onmouseover='highlight("header__split_ascii")'><span class='function'>_split_ascii</span></a></li><li><a href='#header._binsplit', onmouseover='highlight("header__binsplit")'><span class='function'>_binsplit</span></a></li></ul>
</td><td><pre><span class='lineno'>1</span> # Copyr<a name='__init__.py', id ='544053356', onmouseover='highlight("1312919555","1312954056","544053356","1312977122")', title='__init__.py :: email'><a name='re', id ='544053356', onmouseover='highlight("1312915708","544053356","1312915616","1312917631","2045943688","1312915650","1150735634","1312919396")', title='re :: re'><a href='../re.py.html#re', id ='544053356', onmouseover='highlight("544053356","544053356")', title='{re :: re | __init__.py :: email}'>i</a>g</a>ht</a> (<a href='quoprimime.py.html#quoprimime', id ='314215013', onmouseover='highlight("314215013","1794655924")', title='quoprimime :: quoprimime'><a name='quoprimime', id ='314215013', onmouseover='highlight("841815585","841782914","1312920233","841838803","841784774","1312954083","1794655924","314215013","841847421","841817420")', title='quoprimime :: quoprimime'><a name='base64mime', id ='314215013', onmouseover='highlight("841838554","841781918","841783967","1794655924","314215013","841816613","841846491","1312977149","841814624")', title='base64mime :: base64mime'>C) 2002-2</a></a>0</a>06 Python Software Foundation
<span class='lineno'>2</span> # Author: Ben Gertzfield, Barry Warsaw
<span class='lineno'>3</span> # Contact: email-sig@python.org
<span class='lineno'>4</span> 
<span class='lineno'>5</span> <span class='doc-string'>&quot;&quot;&quot;Header encoding and decoding functionality.<span class='doc-string'>&quot;&quot;&quot;</span>
<span class='lineno'>6</span> 
<span class='lineno'>7</span> <a name='header.__all__', id ='1150730989', title='header.__all__ :: [str]'>__all__</a> = [
<span class='lineno'>8</span>     &#39;Header&#39;,
<span class='lineno'>9</span>     &#39;decode_header&#39;,
<span class='lineno'>10</span>     &#39;make_header&#39;,
<span class='lineno'>11</span>     ]
<span class='lineno'>12</span> 
<span class='lineno'>13</span> import re
<span class='lineno'>14</span> import binascii
<span class='lineno'>15</span> 
<span class='lineno'>16</span> import email.quoprimime
<span class='lineno'>17</span> import email.base64mime
<span class='lineno'>18</span> 
<span class='lineno'>19</span> from email.errors import HeaderParseError
<span class='lineno'>20</span> from email.charset import Charset
<span class='lineno'>21</span> 
<span class='lineno'>22</span> <a name='header.NL', id ='1150733651', onmouseover='highlight(2045851590)', title='header.NL :: str'><span class='constant'>NL</a></span> = &#39;\n&#39;
<span class='lineno'>23</span> <span class='constant'><a name='header.SPACE', id ='1150733682', onmouseover='highlight(1312951145)', title='header.SPACE :: str'>SPACE</span></a> = &#39; &#39;
<span class='lineno'>24</span> <a name='header.USPACE', id ='1150733715', onmouseover='highlight("1313127871","1313126139")', title='header.USPACE :: str'><span class='constant'>USPACE</a></span> = u&#39; &#39;
<span class='lineno'>25</span> <a name='header.SPACE8', id ='1150733750', onmouseover='highlight("2045945643","1313070302")', title='header.SPACE8 :: str'><span class='constant'>SPACE8</a></span> = &#39; &#39; * <span class='number'>8</span>
<span class='lineno'>26</span> <a name='header.UEMPTYSTRING', id ='1150733809', onmouseover='highlight(1313128836)', title='header.UEMPTYSTRING :: str'><span class='constant'>UEMPTYSTRING</a></span> = u&#39;&#39;
<span class='lineno'>27</span> 
<span class='lineno'>28</span> <span class='constant'><a name='header.MAXLINELEN', id ='1150733871', onmouseover='highlight(1313072321)', title='header.MAXLINELEN :: int'>MAXLINELEN</a></span> = <span class='number'>76</span>
<span class='lineno'>29</span> 
<span class='lineno'>30</span> <a name='header.USASCII', id ='1150733930', onmouseover='highlight("2045706448","1313068263")', title='header.USASCII :: ?'><span class='constant'>USASCII</span></a> = Charset(&#39;us-ascii&#39;)
<span class='lineno'>31</span> <span class='constant'><a name='header.UTF8', id ='1150734674', onmouseover='highlight(2045706508)', title='header.UTF8 :: ?'>UTF8</a></span> = Charset(&#39;utf-8&#39;)
<span class='lineno'>32</span> 
<span class='lineno'>33</span> # Match encoded-word strings in the form =?charset?q?Hello_World?=
<span class='lineno'>34</span> <a name='header.ecre', id ='1150735606', onmouseover='highlight("1312948102","1312948388","1312946213")', title='header.ecre :: ?'>ecre</a> = <a href='../re.py.html#re', id ='1150735634', onmouseover='highlight(544053356)', title='re :: re'>re</a>.<a href='../re.py.html#re.compile', id ='1150735637', onmouseover='highlight(2025599818)', title='re.compile :: (str, int) -> ? | (my_unicode, int) -> ?'>compile</a>(r&#39;&#39;&#39;
<span class='lineno'>35</span>   =\?                   # literal =?
<span class='lineno'>36</span>   (?P&lt;charset&gt;[^?]*?)   # non-greedy up to the next ? is the charset
<span class='lineno'>37</span>   \?                    # literal ?
<span class='lineno'>38</span>   (?P&lt;encoding&gt;[qb])    # either a &quot;q&quot; or a &quot;b&quot;, case insensitive
<span class='lineno'>39</span>   \?                    # literal ?
<span class='lineno'>40</span>   (?P&lt;encoded&gt;.*?)      # non-greedy up to the next ?= is the encoded string
<span class='lineno'>41</span>   \?=                   # literal ?=
<span class='lineno'>42</span>   (?=[ \t]|$)           # whitespace or the end of the string
<span class='lineno'>43</span>   &#39;&#39;&#39;, <a href='../re.py.html#re', id ='1312915616', onmouseover='highlight(544053356)', title='re :: re'>re</a>.<a href='../re.py.html#re.VERBOSE', id ='1312915619', onmouseover='highlight(2025532338)', title='re.VERBOSE :: ?'>VERBOSE</a> | <a href='../re.py.html#re', id ='1312915650', onmouseover='highlight(544053356)', title='re :: re'>re</a>.<a href='../re.py.html#re.IGNORECASE', id ='1312915674', onmouseover='highlight(2025508493)', title='re.IGNORECASE :: ?'>IGNORECASE</a> | <a href='../re.py.html#re', id ='1312915708', onmouseover='highlight(544053356)', title='re :: re'>re</a>.<a href='../re.py.html#re.MULTILINE', id ='1312915711', onmouseover='highlight(2025510416)', title='re.MULTILINE :: ?'>MULTILINE</a>)
<span class='lineno'>44</span> 
<span class='lineno'>45</span> # Field name regexp, including trailing colon, but not separating whitespace,
<span class='lineno'>46</span> # according to RFC 2822.  Character range is from tilde to exclamation mark.
<span class='lineno'>47</span> # For use with .match()
<span class='lineno'>48</span> <a name='header.fcre', id ='1312917603', onmouseover='highlight(2045949642)', title='header.fcre :: ?'>fcre</a> = <a href='../re.py.html#re', id ='1312917631', onmouseover='highlight(544053356)', title='re :: re'>re</a>.<a href='../re.py.html#re.compile', id ='1312917634', onmouseover='highlight(2025599818)', title='re.compile :: (str, int) -> ? | (my_unicode, int) -> ?'>compile</a>(r&#39;[\041-\176]+:$&#39;)
<span class='lineno'>49</span> 
<span class='lineno'>50</span> # Find a header embedded in a putative header value.  Used to check for
<span class='lineno'>51</span> # header injection attack.
<span class='lineno'>52</span> <a name='header._embeded_header', id ='1312919336', onmouseover='highlight(2045911912)', title='header._embeded_header :: ?'>_embeded_header</a> = <a href='../re.py.html#re', id ='1312919396', onmouseover='highlight(544053356)', title='re :: re'>re</a>.<a href='../re.py.html#re.compile', id ='1312919399', onmouseover='highlight(2025599818)', title='re.compile :: (str, int) -> ? | (my_unicode, int) -> ?'>compile</a>(r&#39;\n[^ \t]+:&#39;)
<span class='lineno'>53</span> 
<span class='lineno'>54</span> 
<span class='lineno'>55</span> 
<span class='lineno'>56</span> # Helpers
<span class='lineno'>57</span> <a name='header._max_append', id ='1312919520', onmouseover='highlight(2045851405)', title='header._max_append :: ([?], str, int, str) -> None'>_max_append</a> = <a href='__init__.py.html#__init__.py', id ='1312919555', onmouseover='highlight(544053356)', title='__init__.py :: email'>email</a>.<a href='quoprimime.py.html#quoprimime', id ='1312920233', onmouseover='highlight("314215013","1794655924")', title='quoprimime :: quoprimime'>quoprimime</a>.<a href='quoprimime.py.html#quoprimime._max_append', id ='1312920265', onmouseover='highlight(1156388188)', title='quoprimime._max_append :: ([?], str, int, str) -> None'>_max_append</a>
<span class='lineno'>58</span> 
<span class='lineno'>59</span> 
<span class='lineno'>60</span> 
<span class='lineno'>61</span> def <a name='header.decode_header', id ='1312920327', title='header.decode_header :: ? -> {[{(str, str) | (str, ?)}] | [(?, ?)]}'><span class='function'>decode_header</span></a>(<a name='header.decode_header@header', id ='1312920362', onmouseover='highlight("1312947173","1312946335","1312945501","1312946246")', title='header.decode_header@header :: ?'>header</a>):
<span class='lineno'>62</span>     <span class='doc-string'>&quot;&quot;&quot;</span>Decode a message header value without converting charset.
<span class='lineno'>63</span> 
<span class='lineno'>64</span>     Returns a list of (decoded_string, charset) pairs containing each of the
<span class='lineno'>65</span>     decoded parts of the header.  Charset is None for non-encoded parts of the
<span class='lineno'>66</span>     header, otherwise a lower-case string containing the name of the character
<span class='lineno'>67</span>     set specified in the encoded string.
<span class='lineno'>68</span> 
<span class='lineno'>69</span>     An email.errors.HeaderParseError may be raised when certain decoding error
<span class='lineno'>70</span>     occurs (e.g. a base64 decoding exception).
<span class='lineno'>71</span>     &quot;&quot;&quot;</span>
<span class='lineno'>72</span>     # If no encoding, just return the header
<span class='lineno'>73</span>     <a name='header.decode_header@header', id ='1312945467', onmouseover='highlight("1312947173","1312946335","1312945501","1312946246")', title='header.decode_header@header :: ?'><span class='parameter'>header</span></a> = <a href='http://docs.python.org/library/functions.html#str', id ='1312945497', onmouseover='highlight(141507136)', title='__builtin__.str :: str'>str</a>(<a href='#header.decode_header@header', id ='1312945501', onmouseover='highlight("1312945467","1312920362")', title='header.decode_header@header :: ?'>header</a>)
<span class='lineno'>74</span>     if not <a href='#header.ecre', id ='1312946213', onmouseover='highlight(1150735606)', title='header.ecre :: ?'>ecre</a>.search(<a href='#header.decode_header@header', id ='1312946246', onmouseover='highlight("1312945467","1312920362")', title='header.decode_header@header :: ?'>header</a>):
<span class='lineno'>75</span>         return [(<a href='#header.decode_header@header', id ='1312946335', onmouseover='highlight("1312945467","1312920362")', title='header.decode_header@header :: ?'>header</a>, <a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='1312946364', onmouseover='highlight(2016665419)', title='__builtin__.None :: ?'><span class='builtin'>None</a></span>)]
<span class='lineno'>76</span>     <span class='identifier'><a name='header.decode_header&decoded', id ='1312946396', onmouseover='highlight("1312981797","1312948196","1312950217","1312981928","1312981743","1312951050","1312950271","1312951107","1312981985","1312982700","1312982884","1312952006","1312983751")', title='header.decode_header&decoded :: [{(str, str) | (str, ?)}]'>decoded</span></a> = []
<span class='lineno'>77</span>     <a name='header.decode_header&dec', id ='1312946434', onmouseover='highlight("1312982023","1312980899","1312982921")', title='header.decode_header&dec :: str'>dec</a> = &#39;&#39;
<span class='lineno'>78</span>     for <a name='header.decode_header&line', id ='1312947144', onmouseover='highlight("1312948233","1312949092","1312948135")', title='header.decode_header&line :: ?'>line</a> in <a href='#header.decode_header@header', id ='1312947173', onmouseover='highlight("1312945467","1312920362")', title='header.decode_header@header :: ?'>header</a>.splitlines():
<span class='lineno'>79</span>         # This line might not have an encoding in it
<span class='lineno'>80</span>         if not <a href='#header.ecre', id ='1312948102', onmouseover='highlight(1150735606)', title='header.ecre :: ?'>ecre</a>.search(<a href='#header.decode_header&line', id ='1312948135', onmouseover='highlight(1312947144)', title='header.decode_header&line :: ?'>line</a>):
<span class='lineno'>81</span>             <a href='#header.decode_header&decoded', id ='1312948196', onmouseover='highlight(1312946396)', title='header.decode_header&decoded :: [{(str, str) | (str, ?)}]'>decoded</a>.<a href='http://docs.python.org/library/stdtypes.html', id ='1312948225', onmouseover='highlight(592677897)', title='__builtin__.list.append :: ? -> None'>append</a>((<a href='#header.decode_header&line', id ='1312948233', onmouseover='highlight(1312947144)', title='header.decode_header&line :: ?'>line</a>, <a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='1312948260', onmouseover='highlight(2016665419)', title='__builtin__.None :: ?'><span class='builtin'>None</span></a>))
<span class='lineno'>82</span>             continue
<span class='lineno'>83</span>         <span class='identifier'><a name='header.decode_header&parts', id ='1312948380', onmouseover='highlight("1312983666","1312952975","1312952135","1312949154","1312953097","1312949223")', title='header.decode_header&parts :: ?'>parts</a></span> = <a href='#header.ecre', id ='1312948388', onmouseover='highlight(1150735606)', title='header.ecre :: ?'>ecre</a>.split(<a href='#header.decode_header&line', id ='1312949092', onmouseover='highlight(1312947144)', title='header.decode_header&line :: ?'>line</a>)
<span class='lineno'>84</span>         while <a href='#header.decode_header&parts', id ='1312949154', onmouseover='highlight(1312948380)', title='header.decode_header&parts :: ?'>parts</a>:
<span class='lineno'>85</span>             <span class='identifier'><a name='header.decode_header&unenc', id ='1312949194', onmouseover='highlight("1312951174","1312952043","1312949343")', title='header.decode_header&unenc :: ?'>unenc</a></span> = <a href='#header.decode_header&parts', id ='1312949223', onmouseover='highlight(1312948380)', title='header.decode_header&parts :: ?'>parts</a>.pop(<span class='number'>0</span>).strip()
<span class='lineno'>86</span>             if <a href='#header.decode_header&unenc', id ='1312949343', onmouseover='highlight(1312949194)', title='header.decode_header&unenc :: ?'>unenc</a>:
<span class='lineno'>87</span>                 # Should we continue a long line?
<span class='lineno'>88</span>                 if <a href='#header.decode_header&decoded', id ='1312950217', onmouseover='highlight(1312946396)', title='header.decode_header&decoded :: [{(str, str) | (str, ?)}]'>decoded</a> and <a href='#header.decode_header&decoded', id ='1312950271', onmouseover='highlight(1312946396)', title='header.decode_header&decoded :: [{(str, str) | (str, ?)}]'>decoded</a>[<span class='number'>-1</span>][<span class='number'>1</span>] is <span class='builtin'><a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='1312950310', onmouseover='highlight(2016665419)', title='__builtin__.None :: ?'>None</span></a>:
<span class='lineno'>89</span>                     <a href='#header.decode_header&decoded', id ='1312951050', onmouseover='highlight(1312946396)', title='header.decode_header&decoded :: [{(str, str) | (str, ?)}]'>decoded</a>[<span class='number'>-1</span>] = (<a href='#header.decode_header&decoded', id ='1312951107', onmouseover='highlight(1312946396)', title='header.decode_header&decoded :: [{(str, str) | (str, ?)}]'>decoded</a>[<span class='number'>-1</span>][<span class='number'>0</span>] + <a href='#header.SPACE', id ='1312951145', onmouseover='highlight(1150733682)', title='header.SPACE :: str'>SPACE</a> + <a href='#header.decode_header&unenc', id ='1312951174', onmouseover='highlight(1312949194)', title='header.decode_header&unenc :: ?'>unenc</a>, <span class='builtin'><a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='1312951202', onmouseover='highlight(2016665419)', title='__builtin__.None :: ?'>None</span></a>)
<span class='lineno'>90</span>                 else:
<span class='lineno'>91</span>                     <a href='#header.decode_header&decoded', id ='1312952006', onmouseover='highlight(1312946396)', title='header.decode_header&decoded :: [{(str, str) | (str, ?)}]'>decoded</a>.<a href='http://docs.python.org/library/stdtypes.html', id ='1312952014', onmouseover='highlight(592677897)', title='__builtin__.list.append :: ? -> None'>append</a>((<a href='#header.decode_header&unenc', id ='1312952043', onmouseover='highlight(1312949194)', title='header.decode_header&unenc :: ?'>unenc</a>, <span class='builtin'><a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='1312952071', onmouseover='highlight(2016665419)', title='__builtin__.None :: ?'>None</a></span>))
<span class='lineno'>92</span>             if <a href='#header.decode_header&parts', id ='1312952135', onmouseover='highlight(1312948380)', title='header.decode_header&parts :: ?'>parts</a>:
<span class='lineno'>93</span>                 <span class='identifier'><a name='header.decode_header&charset', id ='1312952200', onmouseover='highlight("1312982947","1312981836")', title='header.decode_header&charset :: ?'>charset</a></span>, <span class='identifier'><a name='header.decode_header&encoding', id ='1312952230', onmouseover='highlight("1312975075","1312953929")', title='header.decode_header&encoding :: ?'>encoding</span></a> = [<a href='#header.decode_header&s', id ='1312952914', onmouseover='highlight(1312952970)', title='header.decode_header&s :: ?'>s</a>.lower() for <a href='#header.decode_header&s', id ='1312952970', onmouseover='highlight(1312952970)', title='header.decode_header&s :: ?'><a name='header.decode_header&s', id ='1312952970', onmouseover='highlight("1312952914","1312952970")', title='header.decode_header&s :: ?'>s</a></a> in <a href='#header.decode_header&parts', id ='1312952975', onmouseover='highlight(1312948380)', title='header.decode_header&parts :: ?'>parts</a>[<span class='number'>0</span>:<span class='number'>2</span>]]
<span class='lineno'>94</span>                 <span class='identifier'><a name='header.decode_header&encoded', id ='1312953066', onmouseover='highlight("1312954150","1312976218","1312975230","1312981022","1312977209")', title='header.decode_header&encoded :: ?'>encoded</a></span> = <a href='#header.decode_header&parts', id ='1312953097', onmouseover='highlight(1312948380)', title='header.decode_header&parts :: ?'>parts</a>[<span class='number'>2</span>]
<span class='lineno'>95</span>                 <a name='header.decode_header&dec', id ='1312953185', onmouseover='highlight("1312982023","1312980899","1312982921")', title='header.decode_header&dec :: str'><span class='identifier'>dec</a></span> = <span class='builtin'><a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='1312953191', onmouseover='highlight(2016665419)', title='__builtin__.None :: ?'>None</a></span>
<span class='lineno'>96</span>                 if <a href='#header.decode_header&encoding', id ='1312953929', onmouseover='highlight(1312952230)', title='header.decode_header&encoding :: ?'>encoding</a> == &#39;q&#39;:
<span class='lineno'>97</span>                     <a name='header.decode_header&dec', id ='1312954029', onmouseover='highlight("1312982023","1312980899","1312982921")', title='header.decode_header&dec :: str'>dec</a> = <a href='__init__.py.html#__init__.py', id ='1312954056', onmouseover='highlight(544053356)', title='__init__.py :: email'>email</a>.<a href='quoprimime.py.html#quoprimime', id ='1312954083', onmouseover='highlight("314215013","1794655924")', title='quoprimime :: quoprimime'>quoprimime</a>.<a href='quoprimime.py.html#quoprimime.header_decode', id ='1312954115', onmouseover='highlight(1489341072)', title='quoprimime.header_decode :: ? -> ?'>header_decode</a>(<a href='#header.decode_header&encoded', id ='1312954150', onmouseover='highlight(1312953066)', title='header.decode_header&encoded :: ?'>encoded</a>)
<span class='lineno'>98</span>                 elif <a href='#header.decode_header&encoding', id ='1312975075', onmouseover='highlight(1312952230)', title='header.decode_header&encoding :: ?'>encoding</a> == &#39;b&#39;:
<span class='lineno'>99</span>                     <a name='header.decode_header&paderr', id ='1312975196', onmouseover='highlight("1312976102","1312976933")', title='header.decode_header&paderr :: int'><span class='identifier'>paderr</span></a> = <a href='http://docs.python.org/library/functions.html#len', id ='1312975226', onmouseover='highlight(134591780)', title='__builtin__.len :: ? -> int'>len</a>(<a href='#header.decode_header&encoded', id ='1312975230', onmouseover='highlight(1312953066)', title='header.decode_header&encoded :: ?'>encoded</a>) % <span class='number'>4</span>   # Postel&#39;s law: add missing padding
<span class='lineno'>100</span>                     if <a href='#header.decode_header&paderr', id ='1312976102', onmouseover='highlight(1312975196)', title='header.decode_header&paderr :: int'>paderr</a>:
<span class='lineno'>101</span>                         <a href='#header.decode_header&encoded', id ='1312976218', onmouseover='highlight(1312953066)', title='header.decode_header&encoded :: ?'>encoded</a> += &#39;===&#39;[:<span class='number'>4</span> - <a href='#header.decode_header&paderr', id ='1312976933', onmouseover='highlight(1312975196)', title='header.decode_header&paderr :: int'>paderr</a>]
<span class='lineno'>102</span>                     try:
<span class='lineno'>103</span>                         <a name='header.decode_header&dec', id ='1312977116', onmouseover='highlight("1312982023","1312980899","1312982921")', title='header.decode_header&dec :: str'>dec</a> = <a href='__init__.py.html#__init__.py', id ='1312977122', onmouseover='highlight(544053356)', title='__init__.py :: email'>email</a>.<a href='base64mime.py.html#base64mime', id ='1312977149', onmouseover='highlight("314215013","1794655924")', title='base64mime :: base64mime'>base64mime</a>.<a href='base64mime.py.html#base64mime.decode', id ='1312977181', onmouseover='highlight(1776018232)', title='base64mime.decode :: (?, ?) -> ?'>decode</a>(<a href='#header.decode_header&encoded', id ='1312977209', onmouseover='highlight(1312953066)', title='header.decode_header&encoded :: ?'>encoded</a>)
<span class='lineno'>104</span>                     except <a href='http://docs.python.org/library/binascii.html', id ='1312977959', onmouseover='highlight(1286652675)', title='header.binascii :: binascii'>binascii</a>.<a href='http://docs.python.org/library/binascii.html', id ='1312977989', onmouseover='highlight(1286652675)', title='binascii.Error :: <Error>'>Error</a>:
<span class='lineno'>105</span>                         # Turn this into a higher level exception.  BAW: Right
<span class='lineno'>106</span>                         # now we throw the lower level exception away but
<span class='lineno'>107</span>                         # when/if we get exception chaining, we&#39;ll preserve it.
<span class='lineno'>108</span>                         raise HeaderParseError
<span class='lineno'>109</span>                 if <a href='#header.decode_header&dec', id ='1312980899', onmouseover='highlight("1312953185","1312980995","1312954029","1312946434","1312977116")', title='header.decode_header&dec :: str'>dec</a> is <a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='1312980906', onmouseover='highlight(2016665419)', title='__builtin__.None :: ?'><span class='builtin'>None</a></span>:
<span class='lineno'>110</span>                     <a name='header.decode_header&dec', id ='1312980995', onmouseover='highlight("1312982023","1312980899","1312982921")', title='header.decode_header&dec :: str'>dec</a> = <a href='#header.decode_header&encoded', id ='1312981022', onmouseover='highlight(1312953066)', title='header.decode_header&encoded :: ?'>encoded</a>
<span class='lineno'>111</span> 
<span class='lineno'>112</span>                 if <a href='#header.decode_header&decoded', id ='1312981743', onmouseover='highlight(1312946396)', title='header.decode_header&decoded :: [{(str, str) | (str, ?)}]'>decoded</a> and <a href='#header.decode_header&decoded', id ='1312981797', onmouseover='highlight(1312946396)', title='header.decode_header&decoded :: [{(str, str) | (str, ?)}]'>decoded</a>[<span class='number'>-1</span>][<span class='number'>1</span>] == <a href='#header.decode_header&charset', id ='1312981836', onmouseover='highlight(1312952200)', title='header.decode_header&charset :: ?'>charset</a>:
<span class='lineno'>113</span>                     <a href='#header.decode_header&decoded', id ='1312981928', onmouseover='highlight(1312946396)', title='header.decode_header&decoded :: [{(str, str) | (str, ?)}]'>decoded</a>[<span class='number'>-1</span>] = (<a href='#header.decode_header&decoded', id ='1312981985', onmouseover='highlight(1312946396)', title='header.decode_header&decoded :: [{(str, str) | (str, ?)}]'>decoded</a>[<span class='number'>-1</span>][<span class='number'>0</span>] + <a href='#header.decode_header&dec', id ='1312982023', onmouseover='highlight("1312953185","1312980995","1312954029","1312946434","1312977116")', title='header.decode_header&dec :: str'>dec</a>, <a href='#header.decode_header&decoded', id ='1312982700', onmouseover='highlight(1312946396)', title='header.decode_header&decoded :: [{(str, str) | (str, ?)}]'>decoded</a>[<span class='number'>-1</span>][<span class='number'>1</span>])
<span class='lineno'>114</span>                 else:
<span class='lineno'>115</span>                     <a href='#header.decode_header&decoded', id ='1312982884', onmouseover='highlight(1312946396)', title='header.decode_header&decoded :: [{(str, str) | (str, ?)}]'>decoded</a>.<a href='http://docs.python.org/library/stdtypes.html', id ='1312982913', onmouseover='highlight(592677897)', title='__builtin__.list.append :: ? -> None'>append</a>((<a href='#header.decode_header&dec', id ='1312982921', onmouseover='highlight("1312953185","1312980995","1312954029","1312946434","1312977116")', title='header.decode_header&dec :: str'>dec</a>, <a href='#header.decode_header&charset', id ='1312982947', onmouseover='highlight(1312952200)', title='header.decode_header&charset :: ?'>charset</a>))
<span class='lineno'>116</span>             del <a href='#header.decode_header&parts', id ='1312983666', onmouseover='highlight(1312948380)', title='header.decode_header&parts :: ?'>parts</a>[<span class='number'>0</span>:<span class='number'>3</span>]
<span class='lineno'>117</span>     return <a href='#header.decode_header&decoded', id ='1312983751', onmouseover='highlight(1312946396)', title='header.decode_header&decoded :: [{(str, str) | (str, ?)}]'>decoded</a>
<span class='lineno'>118</span> 
<span class='lineno'>119</span> 
<span class='lineno'>120</span> 
<span class='lineno'>121</span> def <span class='function'><a name='header.make_header', id ='1312983788', title='header.make_header :: (?, ?, ?, str) -> Header'>make_header</a></span>(<a name='header.make_header@decoded_seq', id ='1312983821', onmouseover='highlight(1313010661)', title='header.make_header@decoded_seq :: ?'><span class='parameter'>decoded_seq</span></a>, <a name='header.make_header@maxlinelen', id ='1312983876', title='header.make_header@maxlinelen :: ?'><span class='parameter'>maxlinelen</span></a>=<a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='1312983908', onmouseover='highlight(2016665419)', title='__builtin__.None :: ?'>None</a>, <a name='header.make_header@header_name', id ='1312983914', title='header.make_header@header_name :: ?'><span class='parameter'>header_name</span></a>=<a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='1313004800', onmouseover='highlight(2016665419)', title='__builtin__.None :: ?'>None</a>,
<span class='lineno'>122</span>                 <a name='header.make_header@continuation_ws', id ='1313004864', title='header.make_header@continuation_ws :: str'><span class='parameter'>continuation_ws</a></span>=&#39; &#39;):
<span class='lineno'>123</span>     <span class='doc-string'>&quot;&quot;&quot;Create a Header from a sequence of pairs as returned by decode_header()
<span class='lineno'>124</span> 
<span class='lineno'>125</span>     decode_header() takes a header value string and returns a sequence of
<span class='lineno'>126</span>     pairs of the format (decoded_string, charset) where charset is the string
<span class='lineno'>127</span>     name of the character set.
<span class='lineno'>128</span> 
<span class='lineno'>129</span>     This function takes one of those sequence of pairs and returns a Header
<span class='lineno'>130</span>     instance.  Optional maxlinelen, header_name, and continuation_ws are as in
<span class='lineno'>131</span>     the Header constructor.
<span class='lineno'>132</span>     &quot;&quot;&quot;</span>
<span class='lineno'>133</span>     <a name='header.make_header&h', id ='1313009608', onmouseover='highlight("1313012680","1313012585")', title='header.make_header&h :: Header'><span class='identifier'>h</span></a> = <a href='#header.Header', id ='1313009612', onmouseover='highlight(1313012713)', title='header.Header :: <Header>'>Header</a>(maxlinelen=maxlinelen, header_name=header_name,
<span class='lineno'>134</span>                continuation_ws=continuation_ws)
<span class='lineno'>135</span>     for <a name='header.make_header&s', id ='1313010605', onmouseover='highlight(1313012615)', title='header.make_header&s :: ?'>s</a>, <a name='header.make_header&charset', id ='1313010629', onmouseover='highlight("1313011619","1313012618","1313012526","1313011721")', title='header.make_header&charset :: ?'>charset</a> in <a href='#header.make_header@decoded_seq', id ='1313010661', onmouseover='highlight(1312983821)', title='header.make_header@decoded_seq :: ?'>decoded_seq</a>:
<span class='lineno'>136</span>         # None means us-ascii but we can simply pass it on to h.append()
<span class='lineno'>137</span>         if <a href='#header.make_header&charset', id ='1313011619', onmouseover='highlight("1313010629","1313012487")', title='header.make_header&charset :: ?'>charset</a> is not <a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='1313011655', onmouseover='highlight(2016665419)', title='__builtin__.None :: ?'><span class='builtin'>None</span></a> and not <a href='http://docs.python.org/library/functions.html#isinstance', id ='1313011689', onmouseover='highlight(37741720)', title='__builtin__.isinstance :: ? -> int'>isinstance</a>(<a href='#header.make_header&charset', id ='1313011721', onmouseover='highlight("1313010629","1313012487")', title='header.make_header&charset :: ?'>charset</a>, Charset):
<span class='lineno'>138</span>             <a name='header.make_header&charset', id ='1313012487', onmouseover='highlight("1313011619","1313012618","1313012526","1313011721")', title='header.make_header&charset :: ?'>charset</a> = Charset(<a href='#header.make_header&charset', id ='1313012526', onmouseover='highlight("1313010629","1313012487")', title='header.make_header&charset :: ?'>charset</a>)
<span class='lineno'>139</span>         <a href='#header.make_header&h', id ='1313012585', onmouseover='highlight(1313009608)', title='header.make_header&h :: Header'>h</a>.<a href='#header.Header.append', id ='1313012587', onmouseover='highlight(1313132832)', title='header.Header.append :: (Header, ?, ?, str) -> None'>append</a>(<a href='#header.make_header&s', id ='1313012615', onmouseover='highlight(1313010605)', title='header.make_header&s :: ?'>s</a>, <a href='#header.make_header&charset', id ='1313012618', onmouseover='highlight("1313010629","1313012487")', title='header.make_header&charset :: ?'>charset</a>)
<span class='lineno'>140</span>     return <a href='#header.make_header&h', id ='1313012680', onmouseover='highlight(1313009608)', title='header.make_header&h :: Header'>h</a>
<span class='lineno'>141</span> 
<span class='lineno'>142</span> 
<span class='lineno'>143</span> 
<span class='lineno'>144</span> class <a name='header.Header', id ='1313012713', onmouseover='highlight(1313009612)', title='header.Header :: <Header>'><span class='type-name'>Header</span></a>:
<span class='lineno'>145</span>     def <a name='header.Header.__init__', id ='1313012771', title='header.Header.__init__ :: (Header, ?, ?, ?, ?, str, str) -> None'><span class='function'>__init__</span></a>(<span class='parameter'><a name='header.Header.__init__@self', id ='1313013452', onmouseover='highlight("1313096343","1313094390","1313069319","1313098236","1313069224","1313071232","1313071393")', title='header.Header.__init__@self :: Header'>self</span></a>, <span class='parameter'><a name='header.Header.__init__@s', id ='1313013479', onmouseover='highlight("1313072077","1313071303")', title='header.Header.__init__@s :: ?'>s</a></span>=<a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='1313013481', onmouseover='highlight(2016665419)', title='__builtin__.None :: ?'>None</a>, <a name='header.Header.__init__@charset', id ='1313013487', onmouseover='highlight("1313069282","1313067489","1313072101","1313069186","1313068381")', title='header.Header.__init__@charset :: ?'><a name='header.Header.__init__@charset', id ='1313013487', title='header.Header.__init__@charset :: ?'><span class='parameter'>charset</span></a></a>=<a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='1313013516', onmouseover='highlight(2016665419)', title='__builtin__.None :: ?'>None</a>,
<span class='lineno'>146</span>                  <span class='parameter'><a name='header.Header.__init__@maxlinelen', id ='1313013581', onmouseover='highlight("1313094453","1313098297","1313097057","1313072171")', title='header.Header.__init__@maxlinelen :: int'><a name='header.Header.__init__@maxlinelen', id ='1313013581', title='header.Header.__init__@maxlinelen :: ?'>maxlinelen</a></span></a>=<a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='1313013634', onmouseover='highlight(2016665419)', title='__builtin__.None :: ?'>None</a>, <a name='header.Header.__init__@header_name', id ='1313013640', onmouseover='highlight("1313097095","1313073036")', title='header.Header.__init__@header_name :: ?'><span class='parameter'>header_name</a></span>=<a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='1313013673', onmouseover='highlight(2016665419)', title='__builtin__.None :: ?'>None</a>,
<span class='lineno'>147</span>                  <span class='parameter'><a name='header.Header.__init__@continuation_ws', id ='1313034591', onmouseover='highlight("1313069406","1313070209")', title='header.Header.__init__@continuation_ws :: str'>continuation_ws</a></span>=&#39; &#39;, <a name='header.Header.__init__@errors', id ='1313034654', onmouseover='highlight(1313072131)', title='header.Header.__init__@errors :: str'><span class='parameter'>errors</a></span>=&#39;strict&#39;):
<span class='lineno'>148</span>         <span class='doc-string'>&quot;&quot;&quot;Create a MIME-compliant header that can contain many character sets.
<span class='lineno'>149</span> 
<span class='lineno'>150</span>         Optional s is the initial header value.  If None, the initial header
<span class='lineno'>151</span>         value is not set.  You can later append to the header with .append()
<span class='lineno'>152</span>         method calls.  s may be a byte string or a Unicode string, but see the
<span class='lineno'>153</span>         .append() documentation for semantics.
<span class='lineno'>154</span> 
<span class='lineno'>155</span>         Optional charset serves two purposes: it has the same meaning as the
<span class='lineno'>156</span>         charset argument to the .append() method.  It also sets the default
<span class='lineno'>157</span>         character set for all subsequent .append() calls that omit the charset
<span class='lineno'>158</span>         argument.  If charset is not provided in the constructor, the us-ascii
<span class='lineno'>159</span>         charset is used both as s&#39;s initial charset and as the default for
<span class='lineno'>160</span>         subsequent .append() calls.
<span class='lineno'>161</span> 
<span class='lineno'>162</span>         The maximum line length can be specified explicit via maxlinelen.  For
<span class='lineno'>163</span>         splitting the first line to a shorter value (to account for the field
<span class='lineno'>164</span>         header which isn&#39;t included in s, e.g. `Subject&#39;) pass in the name of
<span class='lineno'>165</span>         the field in header_name.  The default maxlinelen is 76.
<span class='lineno'>166</span> 
<span class='lineno'>167</span>         continuation_ws must be RFC 2822 compliant folding whitespace (usually
<span class='lineno'>168</span>         either a space or a hard tab) which will be prepended to continuation
<span class='lineno'>169</span>         lines.
<span class='lineno'>170</span> 
<span class='lineno'>171</span>         errors is passed through to the .append() call.
<span class='lineno'>172</span>         &quot;&quot;&quot;</span>
<span class='lineno'>173</span>         if <a href='#header.Header.__init__@charset', id ='1313067489', onmouseover='highlight("1313068232","1313068475","1313013487")', title='header.Header.__init__@charset :: ?'>charset</a> is <a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='1313067521', onmouseover='highlight(2016665419)', title='__builtin__.None :: ?'><span class='builtin'>None</span></a>:
<span class='lineno'>174</span>             <span class='parameter'><a name='header.Header.__init__@charset', id ='1313068232', onmouseover='highlight("1313069282","1313067489","1313072101","1313069186","1313068381")', title='header.Header.__init__@charset :: ?'>charset</span></a> = <a href='#header.USASCII', id ='1313068263', onmouseover='highlight(1150733930)', title='header.USASCII :: ?'>USASCII</a>
<span class='lineno'>175</span>         if not <a href='http://docs.python.org/library/functions.html#isinstance', id ='1313068349', onmouseover='highlight(37741720)', title='__builtin__.isinstance :: ? -> int'>isinstance</a>(<a href='#header.Header.__init__@charset', id ='1313068381', onmouseover='highlight("1313068232","1313068475","1313013487")', title='header.Header.__init__@charset :: ?'>charset</a>, Charset):
<span class='lineno'>176</span>             <a name='header.Header.__init__@charset', id ='1313068475', onmouseover='highlight("1313069282","1313067489","1313072101","1313069186","1313068381")', title='header.Header.__init__@charset :: ?'>charset</a> = Charset(<a href='#header.Header.__init__@charset', id ='1313069186', onmouseover='highlight("1313068232","1313068475","1313013487")', title='header.Header.__init__@charset :: ?'>charset</a>)
<span class='lineno'>177</span>         <a href='#header.Header.__init__@self', id ='1313069224', onmouseover='highlight(1313013452)', title='header.Header.__init__@self :: Header'>self</a>.<a name='header.Header._charset', id ='1313069250', onmouseover='highlight(2045673775)', title='header.Header._charset :: ?'>_charset</a> = <a href='#header.Header.__init__@charset', id ='1313069282', onmouseover='highlight("1313068232","1313068475","1313013487")', title='header.Header.__init__@charset :: ?'>charset</a>
<span class='lineno'>178</span>         <a href='#header.Header.__init__@self', id ='1313069319', onmouseover='highlight(1313013452)', title='header.Header.__init__@self :: Header'>self</a>.<a name='header.Header._continuation_ws', id ='1313069345', onmouseover='highlight("2045851621","2045796749")', title='header.Header._continuation_ws :: str'>_continuation_ws</a> = <a href='#header.Header.__init__@continuation_ws', id ='1313069406', onmouseover='highlight(1313034591)', title='header.Header.__init__@continuation_ws :: str'>continuation_ws</a>
<span class='lineno'>179</span>         <span class='identifier'><a name='header.Header.__init__&cws_expanded_len', id ='1313069472', onmouseover='highlight(1313098982)', title='header.Header.__init__&cws_expanded_len :: ?'>cws_expanded_len</span></a> = <a href='http://docs.python.org/library/functions.html#len', id ='1313070184', onmouseover='highlight(134591780)', title='__builtin__.len :: ? -> int'>len</a>(<a href='#header.Header.__init__@continuation_ws', id ='1313070209', onmouseover='highlight(1313034591)', title='header.Header.__init__@continuation_ws :: str'>continuation_ws</a>.<a href='http://docs.python.org/library/stdtypes.html#str.replace', id ='1313070246', onmouseover='highlight(1988410987)', title='__builtin__.str.replace :: ? -> str'>replace</a>(&#39;\t&#39;, <a href='#header.SPACE8', id ='1313070302', onmouseover='highlight(1150733750)', title='header.SPACE8 :: str'>SPACE8</a>))
<span class='lineno'>180</span>         # BAW: I believe `chunks&#39; and `maxlinelen&#39; should be non-public.
<span class='lineno'>181</span>         <a href='#header.Header.__init__@self', id ='1313071232', onmouseover='highlight(1313013452)', title='header.Header.__init__@self :: Header'>self</a>.<a name='header.Header._chunks', id ='1313071237', onmouseover='highlight("2045885195","2045710198","1313101122")', title='header.Header._chunks :: [?]'>_chunks</a> = []
<span class='lineno'>182</span>         if <a href='#header.Header.__init__@s', id ='1313071303', onmouseover='highlight(1313013479)', title='header.Header.__init__@s :: ?'>s</a> is not <a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='1313071333', onmouseover='highlight(2016665419)', title='__builtin__.None :: ?'><span class='builtin'>None</span></a>:
<span class='lineno'>183</span>             <a href='#header.Header.__init__@self', id ='1313071393', onmouseover='highlight(1313013452)', title='header.Header.__init__@self :: Header'>self</a>.<a href='#header.Header.append', id ='1313072070', onmouseover='highlight(1313132832)', title='header.Header.append :: (Header, ?, ?, str) -> None'>append</a>(<a href='#header.Header.__init__@s', id ='1313072077', onmouseover='highlight(1313013479)', title='header.Header.__init__@s :: ?'>s</a>, <a href='#header.Header.__init__@charset', id ='1313072101', onmouseover='highlight("1313068232","1313068475","1313013487")', title='header.Header.__init__@charset :: ?'>charset</a>, <a href='#header.Header.__init__@errors', id ='1313072131', onmouseover='highlight(1313034654)', title='header.Header.__init__@errors :: str'>errors</a>)
<span class='lineno'>184</span>         if <a href='#header.Header.__init__@maxlinelen', id ='1313072171', onmouseover='highlight("1313072287","1313013581")', title='header.Header.__init__@maxlinelen :: int'>maxlinelen</a> is <a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='1313072227', onmouseover='highlight(2016665419)', title='__builtin__.None :: ?'><span class='builtin'>None</span></a>:
<span class='lineno'>185</span>             <a name='header.Header.__init__@maxlinelen', id ='1313072287', onmouseover='highlight("1313094453","1313098297","1313097057","1313072171")', title='header.Header.__init__@maxlinelen :: int'><span class='parameter'>maxlinelen</a></span> = <a href='#header.MAXLINELEN', id ='1313072321', onmouseover='highlight(1150733871)', title='header.MAXLINELEN :: int'>MAXLINELEN</a>
<span class='lineno'>186</span>         if <a href='#header.Header.__init__@header_name', id ='1313073036', onmouseover='highlight(1313013640)', title='header.Header.__init__@header_name :: ?'>header_name</a> is <span class='builtin'><a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='1313073093', onmouseover='highlight(2016665419)', title='__builtin__.None :: ?'>None</span></a>:
<span class='lineno'>187</span>             # We don&#39;t know anything about the field header so the first line
<span class='lineno'>188</span>             # is the same length as subsequent lines.
<span class='lineno'>189</span>             <a href='#header.Header.__init__@self', id ='1313094390', onmouseover='highlight(1313013452)', title='header.Header.__init__@self :: Header'>self</a>.<a name='header.Header._firstlinelen', id ='1313094395', onmouseover='highlight(2045885004)', title='header.Header._firstlinelen :: int'>_firstlinelen</a> = <a href='#header.Header.__init__@maxlinelen', id ='1313094453', onmouseover='highlight("1313072287","1313013581")', title='header.Header.__init__@maxlinelen :: int'>maxlinelen</a>
<span class='lineno'>190</span>         else:
<span class='lineno'>191</span>             # The first line should be shorter to take into account the field
<span class='lineno'>192</span>             # header.  Also subtract off 2 extra for the colon and space.
<span class='lineno'>193</span>             <a href='#header.Header.__init__@self', id ='1313096343', onmouseover='highlight(1313013452)', title='header.Header.__init__@self :: Header'>self</a>.<a name='header.Header._firstlinelen', id ='1313096348', onmouseover='highlight(2045885004)', title='header.Header._firstlinelen :: int'>_firstlinelen</a> = <a href='#header.Header.__init__@maxlinelen', id ='1313097057', onmouseover='highlight("1313072287","1313013581")', title='header.Header.__init__@maxlinelen :: int'>maxlinelen</a> - <a href='http://docs.python.org/library/functions.html#len', id ='1313097091', onmouseover='highlight(134591780)', title='__builtin__.len :: ? -> int'>len</a>(<a href='#header.Header.__init__@header_name', id ='1313097095', onmouseover='highlight(1313013640)', title='header.Header.__init__@header_name :: ?'>header_name</a>) - <span class='number'>2</span>
<span class='lineno'>194</span>         # Second and subsequent lines should subtract off the length in
<span class='lineno'>195</span>         # columns of the continuation whitespace prefix.
<span class='lineno'>196</span>         <a href='#header.Header.__init__@self', id ='1313098236', onmouseover='highlight(1313013452)', title='header.Header.__init__@self :: Header'>self</a>.<a name='header.Header._maxlinelen', id ='1313098241', onmouseover='highlight("2045794885","2045796596")', title='header.Header._maxlinelen :: int'>_maxlinelen</a> = <a href='#header.Header.__init__@maxlinelen', id ='1313098297', onmouseover='highlight("1313072287","1313013581")', title='header.Header.__init__@maxlinelen :: int'>maxlinelen</a> - <a href='#header.Header.__init__&cws_expanded_len', id ='1313098982', onmouseover='highlight(1313069472)', title='header.Header.__init__&cws_expanded_len :: ?'>cws_expanded_len</a>
<span class='lineno'>197</span> 
<span class='lineno'>198</span>     def <a name='header.Header.__str__', id ='1313099071', title='header.Header.__str__ :: Header -> ?'><span class='function'>__str__</a></span>(<span class='parameter'><a name='header.Header.__str__@self', id ='1313099079', onmouseover='highlight(1313099942)', title='header.Header.__str__@self :: Header'>self</a></span>):
<span class='lineno'>199</span>         <span class='doc-string'>&quot;&quot;&quot;A synonym for self.encode().&quot;&quot;&quot;</span>
<span class='lineno'>200</span>         return <a href='#header.Header.__str__@self', id ='1313099942', onmouseover='highlight(1313099079)', title='header.Header.__str__@self :: Header'>self</a>.<a href='#header.Header.encode', id ='1313099947', onmouseover='highlight(2045852459)', title='header.Header.encode :: (Header, str) -> ?'>encode</a>()
<span class='lineno'>201</span> 
<span class='lineno'>202</span>     def <a name='header.Header.__unicode__', id ='1313100007', title='header.Header.__unicode__ :: Header -> ?'><span class='function'>__unicode__</a></span>(<span class='parameter'><a name='header.Header.__unicode__@self', id ='1313100040', onmouseover='highlight(1313101117)', title='header.Header.__unicode__@self :: Header'>self</span></a>):
<span class='lineno'>203</span>         <span class='doc-string'>&quot;&quot;&quot;Helper for the built-in unicode function.&quot;&quot;&quot;</span>
<span class='lineno'>204</span>         <span class='identifier'><a name='header.Header.__unicode__&uchunks', id ='1313100930', onmouseover='highlight("1313127814","1313126103","1313125019","1313128896","1313128024")', title='header.Header.__unicode__&uchunks :: [?]'>uchunks</a></span> = []
<span class='lineno'>205</span>         <span class='identifier'><a name='header.Header.__unicode__&lastcs', id ='1313100993', onmouseover='highlight(1313125110)', title='header.Header.__unicode__&lastcs :: ?'>lastcs</span></a> = <a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='1313101023', onmouseover='highlight(2016665419)', title='__builtin__.None :: ?'><span class='builtin'>None</a></span>
<span class='lineno'>206</span>         for <a name='header.Header.__unicode__&s', id ='1313101061', onmouseover='highlight(1313128089)', title='header.Header.__unicode__&s :: ?'>s</a>, <a name='header.Header.__unicode__&charset', id ='1313101085', onmouseover='highlight("1313128768","1313124933")', title='header.Header.__unicode__&charset :: ?'>charset</a> in <a href='#header.Header.__unicode__@self', id ='1313101117', onmouseover='highlight(1313100040)', title='header.Header.__unicode__@self :: Header'>self</a>.<a href='#header.Header._chunks', id ='1313101122', onmouseover='highlight(1313071237)', title='header.Header._chunks :: [?]'>_chunks</a>:
<span class='lineno'>207</span>             # We must preserve spaces between encoded and non-encoded word
<span class='lineno'>208</span>             # boundaries, which means for us we need to add a space when we go
<span class='lineno'>209</span>             # from a charset to None/us-ascii, or from None/us-ascii to a
<span class='lineno'>210</span>             # charset.  Only do this for the second and subsequent chunks.
<span class='lineno'>211</span>             <a name='header.Header.__unicode__&nextcs', id ='1313124924', onmouseover='highlight("1313127963","1313127004","1313125923")', title='header.Header.__unicode__&nextcs :: ?'>nextcs</a> = <a href='#header.Header.__unicode__&charset', id ='1313124933', onmouseover='highlight(1313101085)', title='header.Header.__unicode__&charset :: ?'>charset</a>
<span class='lineno'>212</span>             if <a href='#header.Header.__unicode__&uchunks', id ='1313125019', onmouseover='highlight(1313100930)', title='header.Header.__unicode__&uchunks :: [?]'>uchunks</a>:
<span class='lineno'>213</span>                 if <a href='#header.Header.__unicode__&lastcs', id ='1313125110', onmouseover='highlight("1313100993","1313127933")', title='header.Header.__unicode__&lastcs :: ?'>lastcs</a> not in (<a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='1313125146', onmouseover='highlight(2016665419)', title='__builtin__.None :: ?'><span class='builtin'>None</a></span>, &#39;us-ascii&#39;):
<span class='lineno'>214</span>                     if <a href='#header.Header.__unicode__&nextcs', id ='1313125923', onmouseover='highlight("1313126885","1313124924")', title='header.Header.__unicode__&nextcs :: ?'>nextcs</a> in (<a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='1313125955', onmouseover='highlight(2016665419)', title='__builtin__.None :: ?'><span class='builtin'>None</a></span>, &#39;us-ascii&#39;):
<span class='lineno'>215</span>                         <a href='#header.Header.__unicode__&uchunks', id ='1313126103', onmouseover='highlight(1313100930)', title='header.Header.__unicode__&uchunks :: [?]'>uchunks</a>.<a href='http://docs.python.org/library/stdtypes.html', id ='1313126111', onmouseover='highlight(592677897)', title='__builtin__.list.append :: ? -> None'>append</a>(<a href='#header.USPACE', id ='1313126139', onmouseover='highlight(1150733715)', title='header.USPACE :: str'>USPACE</a>)
<span class='lineno'>216</span>                         <span class='identifier'><a name='header.Header.__unicode__&nextcs', id ='1313126885', onmouseover='highlight("1313127963","1313127004","1313125923")', title='header.Header.__unicode__&nextcs :: ?'>nextcs</span></a> = <span class='builtin'><a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='1313126915', onmouseover='highlight(2016665419)', title='__builtin__.None :: ?'>None</span></a>
<span class='lineno'>217</span>                 elif <a href='#header.Header.__unicode__&nextcs', id ='1313127004', onmouseover='highlight("1313126885","1313124924")', title='header.Header.__unicode__&nextcs :: ?'>nextcs</a> not in (<a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='1313127040', onmouseover='highlight(2016665419)', title='__builtin__.None :: ?'><span class='builtin'>None</span></a>, &#39;us-ascii&#39;):
<span class='lineno'>218</span>                     <a href='#header.Header.__unicode__&uchunks', id ='1313127814', onmouseover='highlight(1313100930)', title='header.Header.__unicode__&uchunks :: [?]'>uchunks</a>.<a href='http://docs.python.org/library/stdtypes.html', id ='1313127843', onmouseover='highlight(592677897)', title='__builtin__.list.append :: ? -> None'>append</a>(<a href='#header.USPACE', id ='1313127871', onmouseover='highlight(1150733715)', title='header.USPACE :: str'>USPACE</a>)
<span class='lineno'>219</span>             <a name='header.Header.__unicode__&lastcs', id ='1313127933', onmouseover='highlight(1313125110)', title='header.Header.__unicode__&lastcs :: ?'>lastcs</a> = <a href='#header.Header.__unicode__&nextcs', id ='1313127963', onmouseover='highlight("1313126885","1313124924")', title='header.Header.__unicode__&nextcs :: ?'>nextcs</a>
<span class='lineno'>220</span>             <a href='#header.Header.__unicode__&uchunks', id ='1313128024', onmouseover='highlight(1313100930)', title='header.Header.__unicode__&uchunks :: [?]'>uchunks</a>.<a href='http://docs.python.org/library/stdtypes.html', id ='1313128032', onmouseover='highlight(592677897)', title='__builtin__.list.append :: ? -> None'>append</a>(<a href='http://docs.python.org/library/functions.html#unicode', id ='1313128060', onmouseover='highlight(1431294356)', title='__builtin__.unicode :: ? -> ?'>unicode</a>(<a href='#header.Header.__unicode__&s', id ='1313128089', onmouseover='highlight(1313101061)', title='header.Header.__unicode__&s :: ?'>s</a>, <a href='http://docs.python.org/library/functions.html#str', id ='1313128092', onmouseover='highlight(141507136)', title='__builtin__.str :: str'>str</a>(<a href='#header.Header.__unicode__&charset', id ='1313128768', onmouseover='highlight(1313101085)', title='header.Header.__unicode__&charset :: ?'>charset</a>)))
<span class='lineno'>221</span>         return <a href='#header.UEMPTYSTRING', id ='1313128836', onmouseover='highlight(1150733809)', title='header.UEMPTYSTRING :: str'>UEMPTYSTRING</a>.<a href='http://docs.python.org/library/stdtypes.html#str.join', id ='1313128870', onmouseover='highlight(760704539)', title='__builtin__.str.join :: ? -> str'>join</a>(<a href='#header.Header.__unicode__&uchunks', id ='1313128896', onmouseover='highlight(1313100930)', title='header.Header.__unicode__&uchunks :: [?]'>uchunks</a>)
<span class='lineno'>222</span> 
<span class='lineno'>223</span>     # Rich comparison operators for equality only.  BAW: does it make sense to
<span class='lineno'>224</span>     # have or explicitly disable &lt;, &lt;=, &gt;, &gt;= operators?
<span class='lineno'>225</span>     def <a name='header.Header.__eq__', id ='1313130016', title='header.Header.__eq__ :: (Header, ?) -> int'><span class='function'>__eq__</span></a>(<span class='parameter'><a name='header.Header.__eq__@self', id ='1313130695', onmouseover='highlight(1313131906)', title='header.Header.__eq__@self :: Header'>self</a></span>, <span class='parameter'><a name='header.Header.__eq__@other', id ='1313130722', onmouseover='highlight(1313131876)', title='header.Header.__eq__@other :: ?'>other</span></a>):
<span class='lineno'>226</span>         # other may be a Header or a string.  Both are fine so coerce
<span class='lineno'>227</span>         # ourselves to a string, swap the args and do another comparison.
<span class='lineno'>228</span>         return <a href='#header.Header.__eq__@other', id ='1313131876', onmouseover='highlight(1313130722)', title='header.Header.__eq__@other :: ?'>other</a> == <a href='#header.Header.__eq__@self', id ='1313131906', onmouseover='highlight(1313130695)', title='header.Header.__eq__@self :: Header'>self</a>.<a href='#header.Header.encode', id ='1313131932', onmouseover='highlight(2045852459)', title='header.Header.encode :: (Header, str) -> ?'>encode</a>()
<span class='lineno'>229</span> 
<span class='lineno'>230</span>     def <a name='header.Header.__ne__', id ='1313132643', title='header.Header.__ne__ :: (Header, ?) -> int'><span class='function'>__ne__</span></a>(<span class='parameter'><a name='header.Header.__ne__@self', id ='1313132650', onmouseover='highlight(1313132767)', title='header.Header.__ne__@self :: Header'>self</a></span>, <span class='parameter'><a name='header.Header.__ne__@other', id ='1313132677', onmouseover='highlight(1313132775)', title='header.Header.__ne__@other :: ?'>other</span></a>):
<span class='lineno'>231</span>         return not <a href='#header.Header.__ne__@self', id ='1313132767', onmouseover='highlight(1313132650)', title='header.Header.__ne__@self :: Header'>self</a> == <a href='#header.Header.__ne__@other', id ='1313132775', onmouseover='highlight(1313132677)', title='header.Header.__ne__@other :: ?'>other</a>
<span class='lineno'>232</span> 
<span class='lineno'>233</span>     def <span class='function'><a name='header.Header.append', id ='1313132832', onmouseover='highlight("1313012587","1313072070")', title='header.Header.append :: (Header, ?, ?, str) -> None'>append</span></a>(<span class='parameter'><a name='header.Header.append@self', id ='1313132860', onmouseover='highlight("2045710193","2045673770")', title='header.Header.append@self :: Header'>self</a></span>, <a name='header.Header.append@s', id ='1313132866', onmouseover='highlight("2045708212","2045680378","2045710256","2045677648","2045704369")', title='header.Header.append@s :: ?'><span class='parameter'>s</span></a>, <a name='header.Header.append@charset', id ='1313132869', onmouseover='highlight("2045703378","2045675660","2045679536","2045673647","2045707372","2045706478","2045674701","2045674547","2045710259")', title='header.Header.append@charset :: ?'><span class='parameter'><a name='header.Header.append@charset', id ='1313132869', title='header.Header.append@charset :: ?'>charset</span></a></a>=<a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='1313132898', onmouseover='highlight(2016665419)', title='__builtin__.None :: ?'>None</a>, <a name='header.Header.append@errors', id ='1313153757', onmouseover='highlight("2045680411","2045708273","2045703598")', title='header.Header.append@errors :: str'><span class='parameter'>errors</a></span>=&#39;strict&#39;):
<span class='lineno'>234</span>         <span class='doc-string'>&quot;&quot;&quot;Append a string to the MIME header.
<span class='lineno'>235</span> 
<span class='lineno'>236</span>         Optional charset, if given, should be a Charset instance or the name
<span class='lineno'>237</span>         of a character set (which will be converted to a Charset instance).  A
<span class='lineno'>238</span>         value of None (the default) means that the charset given in the
<span class='lineno'>239</span>         constructor is used.
<span class='lineno'>240</span> 
<span class='lineno'>241</span>         s may be a byte string or a Unicode string.  If it is a byte string
<span class='lineno'>242</span>         (i.e. isinstance(s, str) is true), then charset is the encoding of
<span class='lineno'>243</span>         that byte string, and a UnicodeError will be raised if the string
<span class='lineno'>244</span>         cannot be decoded with that charset.  If s is a Unicode string, then
<span class='lineno'>245</span>         charset is a hint specifying the character set of the characters in
<span class='lineno'>246</span>         the string.  In this case, when producing an RFC 2822 compliant header
<span class='lineno'>247</span>         using RFC 2047 rules, the Unicode string will be encoded using the
<span class='lineno'>248</span>         following charsets in order: us-ascii, the charset hint, utf-8.  The
<span class='lineno'>249</span>         first character set not to provoke a UnicodeError is used.
<span class='lineno'>250</span> 
<span class='lineno'>251</span>         Optional `errors&#39; is passed as the third argument to any unicode() or
<span class='lineno'>252</span>         ustr.encode() call.
<span class='lineno'>253</span>         &quot;&quot;&quot;</span>
<span class='lineno'>254</span>         if <a href='#header.Header.append@charset', id ='2045673647', onmouseover='highlight("2045706416","1313132869","2045674641","2045673739")', title='header.Header.append@charset :: ?'>charset</a> is <span class='builtin'><a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='2045673679', onmouseover='highlight(2016665419)', title='__builtin__.None :: ?'>None</span></a>:
<span class='lineno'>255</span>             <a name='header.Header.append@charset', id ='2045673739', onmouseover='highlight("2045703378","2045675660","2045679536","2045673647","2045707372","2045706478","2045674701","2045674547","2045710259")', title='header.Header.append@charset :: ?'>charset</a> = <a href='#header.Header.append@self', id ='2045673770', onmouseover='highlight(1313132860)', title='header.Header.append@self :: Header'>self</a>.<a href='#header.Header._charset', id ='2045673775', onmouseover='highlight(1313069250)', title='header.Header._charset :: ?'>_charset</a>
<span class='lineno'>256</span>         elif not <a href='http://docs.python.org/library/functions.html#isinstance', id ='2045674515', onmouseover='highlight(37741720)', title='__builtin__.isinstance :: ? -> int'>isinstance</a>(<a href='#header.Header.append@charset', id ='2045674547', onmouseover='highlight("2045706416","1313132869","2045674641","2045673739")', title='header.Header.append@charset :: ?'>charset</a>, Charset):
<span class='lineno'>257</span>             <a name='header.Header.append@charset', id ='2045674641', onmouseover='highlight("2045703378","2045675660","2045679536","2045673647","2045707372","2045706478","2045674701","2045674547","2045710259")', title='header.Header.append@charset :: ?'>charset</a> = Charset(<a href='#header.Header.append@charset', id ='2045674701', onmouseover='highlight("2045706416","1313132869","2045674641","2045673739")', title='header.Header.append@charset :: ?'>charset</a>)
<span class='lineno'>258</span>         # If the charset is our faux 8bit charset, leave the string unchanged
<span class='lineno'>259</span>         if <a href='#header.Header.append@charset', id ='2045675660', onmouseover='highlight("2045706416","1313132869","2045674641","2045673739")', title='header.Header.append@charset :: ?'>charset</a> != &#39;8bit&#39;:
<span class='lineno'>260</span>             # We need to test that the string can be converted to unicode and
<span class='lineno'>261</span>             # back to a byte string, given the input and output codecs of the
<span class='lineno'>262</span>             # charset.
<span class='lineno'>263</span>             if <a href='http://docs.python.org/library/functions.html#isinstance', id ='2045677616', onmouseover='highlight(37741720)', title='__builtin__.isinstance :: ? -> int'>isinstance</a>(<a href='#header.Header.append@s', id ='2045677648', onmouseover='highlight("1313132866","2045708187")', title='header.Header.append@s :: ?'>s</a>, <a href='http://docs.python.org/library/functions.html#str', id ='2045677651', onmouseover='highlight(141507136)', title='__builtin__.str :: str'>str</a>):
<span class='lineno'>264</span>                 # Possibly raise UnicodeError if the byte string can&#39;t be
<span class='lineno'>265</span>                 # converted to a unicode with the input codec of the charset.
<span class='lineno'>266</span>                 <a name='header.Header.append&incodec', id ='2045679505', onmouseover='highlight(2045680402)', title='header.Header.append&incodec :: str'><span class='identifier'>incodec</span></a> = <a href='#header.Header.append@charset', id ='2045679536', onmouseover='highlight("2045706416","1313132869","2045674641","2045673739")', title='header.Header.append@charset :: ?'>charset</a>.input_codec or &#39;us-ascii&#39;
<span class='lineno'>267</span>                 <span class='identifier'><a name='header.Header.append&ustr', id ='2045680342', onmouseover='highlight(2045703534)', title='header.Header.append&ustr :: ?'>ustr</a></span> = <a href='http://docs.python.org/library/functions.html#unicode', id ='2045680349', onmouseover='highlight(1431294356)', title='__builtin__.unicode :: ? -> ?'>unicode</a>(<a href='#header.Header.append@s', id ='2045680378', onmouseover='highlight("1313132866","2045708187")', title='header.Header.append@s :: ?'>s</a>, <a href='#header.Header.append&incodec', id ='2045680402', onmouseover='highlight(2045679505)', title='header.Header.append&incodec :: str'>incodec</a>, <a href='#header.Header.append@errors', id ='2045680411', onmouseover='highlight(1313153757)', title='header.Header.append@errors :: str'>errors</a>)
<span class='lineno'>268</span>                 # Now make sure that the unicode could be converted back to a
<span class='lineno'>269</span>                 # byte string with the output codec, which may be different
<span class='lineno'>270</span>                 # than the iput coded.  Still, use the original byte string.
<span class='lineno'>271</span>                 <a name='header.Header.append&outcodec', id ='2045703346', onmouseover='highlight("2045708242","2045703567")', title='header.Header.append&outcodec :: str'>outcodec</a> = <a href='#header.Header.append@charset', id ='2045703378', onmouseover='highlight("2045706416","1313132869","2045674641","2045673739")', title='header.Header.append@charset :: ?'>charset</a>.output_codec or &#39;us-ascii&#39;
<span class='lineno'>272</span>                 <a href='#header.Header.append&ustr', id ='2045703534', onmouseover='highlight(2045680342)', title='header.Header.append&ustr :: ?'>ustr</a>.encode(<a href='#header.Header.append&outcodec', id ='2045703567', onmouseover='highlight("2045707319","2045703346")', title='header.Header.append&outcodec :: str'>outcodec</a>, <a href='#header.Header.append@errors', id ='2045703598', onmouseover='highlight(1313153757)', title='header.Header.append@errors :: str'>errors</a>)
<span class='lineno'>273</span>             elif <a href='http://docs.python.org/library/functions.html#isinstance', id ='2045704337', onmouseover='highlight(37741720)', title='__builtin__.isinstance :: ? -> int'>isinstance</a>(<a href='#header.Header.append@s', id ='2045704369', onmouseover='highlight("1313132866","2045708187")', title='header.Header.append@s :: ?'>s</a>, <a href='http://docs.python.org/library/functions.html#unicode', id ='2045704372', onmouseover='highlight(1431294356)', title='__builtin__.unicode :: ? -> ?'>unicode</a>):
<span class='lineno'>274</span>                 # Now we have to be sure the unicode string can be converted
<span class='lineno'>275</span>                 # to a byte string with a reasonable output codec.  We want to
<span class='lineno'>276</span>                 # use the byte string in the chunk.
<span class='lineno'>277</span>                 for <a name='header.Header.append@charset', id ='2045706416', onmouseover='highlight("2045703378","2045675660","2045679536","2045673647","2045707372","2045706478","2045674701","2045674547","2045710259")', title='header.Header.append@charset :: ?'><span class='parameter'>charset</span></a> in <a href='#header.USASCII', id ='2045706448', onmouseover='highlight(1150733930)', title='header.USASCII :: ?'>USASCII</a>, <a href='#header.Header.append@charset', id ='2045706478', onmouseover='highlight("2045706416","1313132869","2045674641","2045673739")', title='header.Header.append@charset :: ?'>charset</a>, <a href='#header.UTF8', id ='2045706508', onmouseover='highlight(1150734674)', title='header.UTF8 :: ?'>UTF8</a>:
<span class='lineno'>278</span>                     try:
<span class='lineno'>279</span>                         <span class='identifier'><a name='header.Header.append&outcodec', id ='2045707319', onmouseover='highlight("2045708242","2045703567")', title='header.Header.append&outcodec :: str'>outcodec</a></span> = <a href='#header.Header.append@charset', id ='2045707372', onmouseover='highlight("2045706416","1313132869","2045674641","2045673739")', title='header.Header.append@charset :: ?'>charset</a>.output_codec or &#39;us-ascii&#39;
<span class='lineno'>280</span>                         <a name='header.Header.append@s', id ='2045708187', onmouseover='highlight("2045708212","2045680378","2045710256","2045677648","2045704369")', title='header.Header.append@s :: ?'>s</a> = <a href='#header.Header.append@s', id ='2045708212', onmouseover='highlight("1313132866","2045708187")', title='header.Header.append@s :: ?'>s</a>.encode(<a href='#header.Header.append&outcodec', id ='2045708242', onmouseover='highlight("2045707319","2045703346")', title='header.Header.append&outcodec :: str'>outcodec</a>, <a href='#header.Header.append@errors', id ='2045708273', onmouseover='highlight(1313153757)', title='header.Header.append@errors :: str'>errors</a>)
<span class='lineno'>281</span>                         break
<span class='lineno'>282</span>                     except <a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='2045709115', onmouseover='highlight(2016665419)', title='__builtin__.UnicodeError :: <UnicodeError>'>UnicodeError</a>:
<span class='lineno'>283</span>                         pass
<span class='lineno'>284</span>                 else:
<span class='lineno'>285</span>                     assert <span class='builtin'><a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='2045709396', onmouseover='highlight(2016665419)', title='__builtin__.False :: ?'>False</a></span>, &#39;utf-8 conversion failed&#39;
<span class='lineno'>286</span>         <a href='#header.Header.append@self', id ='2045710193', onmouseover='highlight(1313132860)', title='header.Header.append@self :: Header'>self</a>.<a href='#header.Header._chunks', id ='2045710198', onmouseover='highlight(1313071237)', title='header.Header._chunks :: [?]'>_chunks</a>.<a href='http://docs.python.org/library/stdtypes.html', id ='2045710227', onmouseover='highlight(592677897)', title='__builtin__.list.append :: ? -> None'>append</a>((<a href='#header.Header.append@s', id ='2045710256', onmouseover='highlight("1313132866","2045708187")', title='header.Header.append@s :: ?'>s</a>, <a href='#header.Header.append@charset', id ='2045710259', onmouseover='highlight("2045706416","1313132869","2045674641","2045673739")', title='header.Header.append@charset :: ?'>charset</a>))
<span class='lineno'>287</span> 
<span class='lineno'>288</span>     def <a name='header.Header._split', id ='2045710320', onmouseover='highlight("2045794795","2045889068")', title='header.Header._split :: (Header, ?, ?, int, str) -> [(?, ?)]'><span class='function'>_split</a></span>(<span class='parameter'><a name='header.Header._split@self', id ='2045710348', onmouseover='highlight("2045766057","2045794769","2045794859")', title='header.Header._split@self :: Header'>self</span></a>, <span class='parameter'><a name='header.Header._split@s', id ='2045710354', onmouseover='highlight("2045766768","2045739030","2045767056","2045732274")', title='header.Header._split@s :: ?'>s</span></a>, <span class='parameter'><a name='header.Header._split@charset', id ='2045710357', onmouseover='highlight("2045734316","2045793000","2045793804","2045732210","2045732358","2045769844","2045766771","2045739054","2045765931","2045738906","2045768973","2045791823","2045794673","2045794829","2045733171")', title='header.Header._split@charset :: ?'>charset</a></span>, <span class='parameter'><a name='header.Header._split@maxlinelen', id ='2045711038', onmouseover='highlight("2045791853","2045768879","2045766801","2045734190")', title='header.Header._split@maxlinelen :: int'>maxlinelen</span></a>, <span class='parameter'><a name='header.Header._split@splitchars', id ='2045711092', onmouseover='highlight("2045766834","2045794919")', title='header.Header._split@splitchars :: str'>splitchars</span></a>):
<span class='lineno'>289</span>         # Split up a header safely for use with encode_chunks.
<span class='lineno'>290</span>         <span class='identifier'><a name='header.Header._split&splittable', id ='2045732176', onmouseover='highlight("2045791790","2045769931","2045732424","2045769690")', title='header.Header._split&splittable :: ?'>splittable</a></span> = <a href='#header.Header._split@charset', id ='2045732210', onmouseover='highlight(2045710357)', title='header.Header._split@charset :: ?'>charset</a>.to_splittable(<a href='#header.Header._split@s', id ='2045732274', onmouseover='highlight(2045710354)', title='header.Header._split@s :: ?'>s</a>)
<span class='lineno'>291</span>         <a name='header.Header._split&encoded', id ='2045732327', onmouseover='highlight("2045733261","2045734286")', title='header.Header._split&encoded :: ?'><span class='identifier'>encoded</span></a> = <a href='#header.Header._split@charset', id ='2045732358', onmouseover='highlight(2045710357)', title='header.Header._split@charset :: ?'>charset</a>.from_splittable(<a href='#header.Header._split&splittable', id ='2045732424', onmouseover='highlight(2045732176)', title='header.Header._split&splittable :: ?'>splittable</a>, <a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='2045732457', onmouseover='highlight(2016665419)', title='__builtin__.True :: ?'><span class='builtin'>True</a></span>)
<span class='lineno'>292</span>         <a name='header.Header._split&elen', id ='2045733164', onmouseover='highlight("2045734161","2045767023")', title='header.Header._split&elen :: ?'><span class='identifier'>elen</a></span> = <a href='#header.Header._split@charset', id ='2045733171', onmouseover='highlight(2045710357)', title='header.Header._split@charset :: ?'>charset</a>.encoded_header_len(<a href='#header.Header._split&encoded', id ='2045733261', onmouseover='highlight(2045732327)', title='header.Header._split&encoded :: ?'>encoded</a>)
<span class='lineno'>293</span>         # If the line&#39;s encoded length first, just return it
<span class='lineno'>294</span>         if <a href='#header.Header._split&elen', id ='2045734161', onmouseover='highlight(2045733164)', title='header.Header._split&elen :: ?'>elen</a> &lt;= <a href='#header.Header._split@maxlinelen', id ='2045734190', onmouseover='highlight(2045711038)', title='header.Header._split@maxlinelen :: int'>maxlinelen</a>:
<span class='lineno'>295</span>             return [(<a href='#header.Header._split&encoded', id ='2045734286', onmouseover='highlight(2045732327)', title='header.Header._split&encoded :: ?'>encoded</a>, <a href='#header.Header._split@charset', id ='2045734316', onmouseover='highlight(2045710357)', title='header.Header._split@charset :: ?'>charset</a>)]
<span class='lineno'>296</span>         # If we have undetermined raw 8bit characters sitting in a byte
<span class='lineno'>297</span>         # string, we really don&#39;t know what the right thing to do is.  We
<span class='lineno'>298</span>         # can&#39;t really split it because it might be multibyte data which we
<span class='lineno'>299</span>         # could break if we split it between pairs.  The least harm seems to
<span class='lineno'>300</span>         # be to not split the header at all, but that means they could go out
<span class='lineno'>301</span>         # longer than maxlinelen.
<span class='lineno'>302</span>         if <a href='#header.Header._split@charset', id ='2045738906', onmouseover='highlight(2045710357)', title='header.Header._split@charset :: ?'>charset</a> == &#39;8bit&#39;:
<span class='lineno'>303</span>             return [(<a href='#header.Header._split@s', id ='2045739030', onmouseover='highlight(2045710354)', title='header.Header._split@s :: ?'>s</a>, <a href='#header.Header._split@charset', id ='2045739054', onmouseover='highlight(2045710357)', title='header.Header._split@charset :: ?'>charset</a>)]
<span class='lineno'>304</span>         # BAW: I&#39;m not sure what the right test here is.  What we&#39;re trying to
<span class='lineno'>305</span>         # do is be faithful to RFC 2822&#39;s recommendation that ($2.2.3):
<span class='lineno'>306</span>         #
<span class='lineno'>307</span>         # &quot;Note: Though structured field bodies are defined in such a way that
<span class='lineno'>308</span>         #  folding can take place between many of the lexical tokens (and even
<span class='lineno'>309</span>         #  within some of the lexical tokens), folding SHOULD be limited to
<span class='lineno'>310</span>         #  placing the CRLF at higher-level syntactic breaks.&quot;
<span class='lineno'>311</span>         #
<span class='lineno'>312</span>         # For now, I can only imagine doing this when the charset is us-ascii,
<span class='lineno'>313</span>         # although it&#39;s possible that other charsets may also benefit from the
<span class='lineno'>314</span>         # higher-level syntactic breaks.
<span class='lineno'>315</span>         elif <a href='#header.Header._split@charset', id ='2045765931', onmouseover='highlight(2045710357)', title='header.Header._split@charset :: ?'>charset</a> == &#39;us-ascii&#39;:
<span class='lineno'>316</span>             return <a href='#header.Header._split@self', id ='2045766057', onmouseover='highlight(2045710348)', title='header.Header._split@self :: Header'>self</a>.<a href='#header.Header._split_ascii', id ='2045766062', onmouseover='highlight(2045795633)', title='header.Header._split_ascii :: (Header, ?, ?, int, str) -> ?'>_split_ascii</a>(<a href='#header.Header._split@s', id ='2045766768', onmouseover='highlight(2045710354)', title='header.Header._split@s :: ?'>s</a>, <a href='#header.Header._split@charset', id ='2045766771', onmouseover='highlight(2045710357)', title='header.Header._split@charset :: ?'>charset</a>, <a href='#header.Header._split@maxlinelen', id ='2045766801', onmouseover='highlight(2045711038)', title='header.Header._split@maxlinelen :: int'>maxlinelen</a>, <a href='#header.Header._split@splitchars', id ='2045766834', onmouseover='highlight(2045711092)', title='header.Header._split@splitchars :: str'>splitchars</a>)
<span class='lineno'>317</span>         # BAW: should we use encoded?
<span class='lineno'>318</span>         elif <a href='#header.Header._split&elen', id ='2045767023', onmouseover='highlight(2045733164)', title='header.Header._split&elen :: ?'>elen</a> == <a href='http://docs.python.org/library/functions.html#len', id ='2045767052', onmouseover='highlight(134591780)', title='__builtin__.len :: ? -> int'>len</a>(<a href='#header.Header._split@s', id ='2045767056', onmouseover='highlight(2045710354)', title='header.Header._split@s :: ?'>s</a>):
<span class='lineno'>319</span>             # We can split on _maxlinelen boundaries because we know that the
<span class='lineno'>320</span>             # encoding won&#39;t change the size of the string
<span class='lineno'>321</span>             <span class='identifier'><a name='header.Header._split&splitpnt', id ='2045768847', onmouseover='highlight("2045770614","2045769744")', title='header.Header._split&splitpnt :: int'>splitpnt</a></span> = <a href='#header.Header._split@maxlinelen', id ='2045768879', onmouseover='highlight(2045711038)', title='header.Header._split@maxlinelen :: int'>maxlinelen</a>
<span class='lineno'>322</span>             <a name='header.Header._split&first', id ='2045768944', title='header.Header._split&first :: ?'><a name='header.Header._split&first', id ='2045768944', title='header.Header._split&first :: ?'><a name='header.Header._split&first', id ='2045768944', title='header.Header._split&first :: ?'>first</a></a></a> = <a href='#header.Header._split@charset', id ='2045768973', onmouseover='highlight(2045710357)', title='header.Header._split@charset :: ?'>charset</a>.from_splittable(<a href='#header.Header._split&splittable', id ='2045769690', onmouseover='highlight(2045732176)', title='header.Header._split&splittable :: ?'>splittable</a>[:<a href='#header.Header._split&splitpnt', id ='2045769744', onmouseover='highlight(2045768847)', title='header.Header._split&splitpnt :: int'>splitpnt</a>], <a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='2045769776', onmouseover='highlight(2016665419)', title='__builtin__.False :: ?'><span class='builtin'>False</span></a>)
<span class='lineno'>323</span>             <a name='header.Header._split&last', id ='2045769837', title='header.Header._split&last :: ?'><a name='header.Header._split&last', id ='2045769837', title='header.Header._split&last :: ?'><a name='header.Header._split&last', id ='2045769837', title='header.Header._split&last :: ?'>last</a></a></a> = <a href='#header.Header._split@charset', id ='2045769844', onmouseover='highlight(2045710357)', title='header.Header._split@charset :: ?'>charset</a>.from_splittable(<a href='#header.Header._split&splittable', id ='2045769931', onmouseover='highlight(2045732176)', title='header.Header._split&splittable :: ?'>splittable</a>[<a href='#header.Header._split&splitpnt', id ='2045770614', onmouseover='highlight(2045768847)', title='header.Header._split&splitpnt :: int'>splitpnt</a>:], <a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='2045770647', onmouseover='highlight(2016665419)', title='__builtin__.False :: ?'><span class='builtin'>False</span></a>)
<span class='lineno'>324</span>         else:
<span class='lineno'>325</span>             # Binary search for split point
<span class='lineno'>326</span>             <span class='identifier'><span class='identifier'><a name='header.Header._split&first', id ='2045770892', title='header.Header._split&first :: ?'><a name='header.Header._split&first', id ='2045770892', title='header.Header._split&first :: ?'><span class='identifier'><a name='header.Header._split&first', id ='2045770892', title='header.Header._split&first :: ?'>first</span></span></a></a></a></span>, <span class='identifier'><a name='header.Header._split&last', id ='2045770899', title='header.Header._split&last :: ?'><span class='identifier'><a name='header.Header._split&last', id ='2045770899', title='header.Header._split&last :: ?'><a name='header.Header._split&last', id ='2045770899', title='header.Header._split&last :: ?'><span class='identifier'>last</span></a></span></span></a></a> = <a href='#header._binsplit', id ='2045791759', onmouseover='highlight(2046625968)', title='header._binsplit :: (?, ?, int) -> (?, ?)'>_binsplit</a>(<a href='#header.Header._split&splittable', id ='2045791790', onmouseover='highlight(2045732176)', title='header.Header._split&splittable :: ?'>splittable</a>, <a href='#header.Header._split@charset', id ='2045791823', onmouseover='highlight(2045710357)', title='header.Header._split@charset :: ?'>charset</a>, <a href='#header.Header._split@maxlinelen', id ='2045791853', onmouseover='highlight(2045711038)', title='header.Header._split@maxlinelen :: int'>maxlinelen</a>)
<span class='lineno'>327</span>         # first is of the proper length so just wrap it in the appropriate
<span class='lineno'>328</span>         # chrome.  last must be recursively split.
<span class='lineno'>329</span>         <span class='identifier'><a name='header.Header._split&fsplittable', id ='2045792965', onmouseover='highlight(2045793870)', title='header.Header._split&fsplittable :: ?'>fsplittable</span></a> = <a href='#header.Header._split@charset', id ='2045793000', onmouseover='highlight(2045710357)', title='header.Header._split@charset :: ?'>charset</a>.to_splittable(first)
<span class='lineno'>330</span>         <span class='identifier'><a name='header.Header._split&fencoded', id ='2045793772', onmouseover='highlight(2045794642)', title='header.Header._split&fencoded :: ?'>fencoded</a></span> = <a href='#header.Header._split@charset', id ='2045793804', onmouseover='highlight(2045710357)', title='header.Header._split@charset :: ?'>charset</a>.from_splittable(<a href='#header.Header._split&fsplittable', id ='2045793870', onmouseover='highlight(2045792965)', title='header.Header._split&fsplittable :: ?'>fsplittable</a>, <span class='builtin'><a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='2045793925', onmouseover='highlight(2016665419)', title='__builtin__.True :: ?'>True</a></span>)
<span class='lineno'>331</span>         <a name='header.Header._split&chunk', id ='2045793960', onmouseover='highlight(2045794761)', title='header.Header._split&chunk :: [(?, ?)]'><span class='identifier'>chunk</a></span> = [(<a href='#header.Header._split&fencoded', id ='2045794642', onmouseover='highlight(2045793772)', title='header.Header._split&fencoded :: ?'>fencoded</a>, <a href='#header.Header._split@charset', id ='2045794673', onmouseover='highlight(2045710357)', title='header.Header._split@charset :: ?'>charset</a>)]
<span class='lineno'>332</span>         return <a href='#header.Header._split&chunk', id ='2045794761', onmouseover='highlight(2045793960)', title='header.Header._split&chunk :: [(?, ?)]'>chunk</a> + <a href='#header.Header._split@self', id ='2045794769', onmouseover='highlight(2045710348)', title='header.Header._split@self :: Header'>self</a>.<a href='#header.Header._split', id ='2045794795', onmouseover='highlight(2045710320)', title='header.Header._split :: (Header, ?, ?, int, str) -> [(?, ?)]'>_split</a>(last, <a href='#header.Header._split@charset', id ='2045794829', onmouseover='highlight(2045710357)', title='header.Header._split@charset :: ?'>charset</a>, <a href='#header.Header._split@self', id ='2045794859', onmouseover='highlight(2045710348)', title='header.Header._split@self :: Header'>self</a>.<a href='#header.Header._maxlinelen', id ='2045794885', onmouseover='highlight(1313098241)', title='header.Header._maxlinelen :: int'>_maxlinelen</a>, <a href='#header.Header._split@splitchars', id ='2045794919', onmouseover='highlight(2045711092)', title='header.Header._split@splitchars :: str'>splitchars</a>)
<span class='lineno'>333</span> 
<span class='lineno'>334</span>     def <a name='header.Header._split_ascii', id ='2045795633', onmouseover='highlight(2045766062)', title='header.Header._split_ascii :: (Header, ?, ?, int, str) -> ?'><span class='function'>_split_ascii</a></span>(<a name='header.Header._split_ascii@self', id ='2045795667', onmouseover='highlight("2045796723","2045796591")', title='header.Header._split_ascii@self :: Header'><span class='parameter'>self</span></a>, <span class='parameter'><a name='header.Header._split_ascii@s', id ='2045795694', onmouseover='highlight(2045795885)', title='header.Header._split_ascii@s :: ?'>s</a></span>, <span class='parameter'><a name='header.Header._split_ascii@charset', id ='2045795697', onmouseover='highlight(2045797584)', title='header.Header._split_ascii@charset :: ?'>charset</span></a>, <span class='parameter'><a name='header.Header._split_ascii@firstlen', id ='2045795727', onmouseover='highlight(2045796560)', title='header.Header._split_ascii@firstlen :: int'>firstlen</a></span>, <span class='parameter'><a name='header.Header._split_ascii@splitchars', id ='2045795758', onmouseover='highlight(2045796809)', title='header.Header._split_ascii@splitchars :: str'>splitchars</a></span>):
<span class='lineno'>335</span>         <a name='header.Header._split_ascii&chunks', id ='2045795821', onmouseover='highlight("2045797618","2045797554")', title='header.Header._split_ascii&chunks :: [?]'><span class='identifier'>chunks</span></a> = <a href='#header._split_ascii', id ='2045795851', onmouseover='highlight(2045913801)', title='header._split_ascii :: (?, int, int, str, str) -> [?]'>_split_ascii</a>(<a href='#header.Header._split_ascii@s', id ='2045795885', onmouseover='highlight(2045795694)', title='header.Header._split_ascii@s :: ?'>s</a>, <a href='#header.Header._split_ascii@firstlen', id ='2045796560', onmouseover='highlight(2045795727)', title='header.Header._split_ascii@firstlen :: int'>firstlen</a>, <a href='#header.Header._split_ascii@self', id ='2045796591', onmouseover='highlight(2045795667)', title='header.Header._split_ascii@self :: Header'>self</a>.<a href='#header.Header._maxlinelen', id ='2045796596', onmouseover='highlight(1313098241)', title='header.Header._maxlinelen :: int'>_maxlinelen</a>,
<span class='lineno'>336</span>                               <a href='#header.Header._split_ascii@self', id ='2045796723', onmouseover='highlight(2045795667)', title='header.Header._split_ascii@self :: Header'>self</a>.<a href='#header.Header._continuation_ws', id ='2045796749', onmouseover='highlight(1313069345)', title='header.Header._continuation_ws :: str'>_continuation_ws</a>, <a href='#header.Header._split_ascii@splitchars', id ='2045796809', onmouseover='highlight(2045795758)', title='header.Header._split_ascii@splitchars :: str'>splitchars</a>)
<span class='lineno'>337</span>         return <a href='http://docs.python.org/library/functions.html#zip', id ='2045797529', onmouseover='highlight(147642160)', title='__builtin__.zip :: ? -> [?]'>zip</a>(<a href='#header.Header._split_ascii&chunks', id ='2045797554', onmouseover='highlight(2045795821)', title='header.Header._split_ascii&chunks :: [?]'>chunks</a>, [<a href='#header.Header._split_ascii@charset', id ='2045797584', onmouseover='highlight(2045795697)', title='header.Header._split_ascii@charset :: ?'>charset</a>]*<a href='http://docs.python.org/library/functions.html#len', id ='2045797614', onmouseover='highlight(134591780)', title='__builtin__.len :: ? -> int'>len</a>(<a href='#header.Header._split_ascii&chunks', id ='2045797618', onmouseover='highlight(2045795821)', title='header.Header._split_ascii&chunks :: [?]'>chunks</a>))
<span class='lineno'>338</span> 
<span class='lineno'>339</span>     def <a name='header.Header._encode_chunks', id ='2045797678', onmouseover='highlight(2045911107)', title='header.Header._encode_chunks :: (Header, [?], int) -> ?'><span class='function'>_encode_chunks</a></span>(<a name='header.Header._encode_chunks@self', id ='2045797714', onmouseover='highlight(2045851616)', title='header.Header._encode_chunks@self :: Header'><span class='parameter'>self</a></span>, <span class='parameter'><a name='header.Header._encode_chunks@newchunks', id ='2045797741', onmouseover='highlight(2045827313)', title='header.Header._encode_chunks@newchunks :: [?]'>newchunks</a></span>, <a name='header.Header._encode_chunks@maxlinelen', id ='2045797773', onmouseover='highlight(2045851491)', title='header.Header._encode_chunks@maxlinelen :: int'><span class='parameter'>maxlinelen</span></a>):
<span class='lineno'>340</span>         # MIME-encode a header with many different charsets and/or encodings.
<span class='lineno'>341</span>         #
<span class='lineno'>342</span>         # Given a list of pairs (string, charset), return a MIME-encoded
<span class='lineno'>343</span>         # string suitable for use in a header field.  Each pair may have
<span class='lineno'>344</span>         # different charsets and/or encodings, and the resulting header will
<span class='lineno'>345</span>         # accurately reflect each setting.
<span class='lineno'>346</span>         #
<span class='lineno'>347</span>         # Each encoding can be email.utils.QP (quoted-printable, for
<span class='lineno'>348</span>         # ASCII-like character sets like iso-8859-1), email.utils.BASE64
<span class='lineno'>349</span>         # (Base64, for non-ASCII like character sets like KOI8-R and
<span class='lineno'>350</span>         # iso-2022-jp), or None (no encoding).
<span class='lineno'>351</span>         #
<span class='lineno'>352</span>         # Each pair will be represented on a separate line; the resulting
<span class='lineno'>353</span>         # string will be in the format:
<span class='lineno'>354</span>         #
<span class='lineno'>355</span>         # =?charset1?q?Mar=EDa_Gonz=E1lez_Alonso?=\n
<span class='lineno'>356</span>         #  =?charset2?b?SvxyZ2VuIEL2aW5n?=&quot;
<span class='lineno'>357</span>         <a name='header.Header._encode_chunks&chunks', id ='2045826514', onmouseover='highlight("2045830199","2045852421","2045851438","2045830231")', title='header.Header._encode_chunks&chunks :: [?]'><span class='identifier'>chunks</a></span> = []
<span class='lineno'>358</span>         for <a name='header.Header._encode_chunks&header', id ='2045826601', onmouseover='highlight("2045829273","2045828429","2045827406")', title='header.Header._encode_chunks&header :: ?'>header</a>, <a name='header.Header._encode_chunks&charset', id ='2045826630', onmouseover='highlight("2045827559","2045827599","2045828558")', title='header.Header._encode_chunks&charset :: ?'>charset</a> in <a href='#header.Header._encode_chunks@newchunks', id ='2045827313', onmouseover='highlight(2045797741)', title='header.Header._encode_chunks@newchunks :: [?]'>newchunks</a>:
<span class='lineno'>359</span>             if not <a href='#header.Header._encode_chunks&header', id ='2045827406', onmouseover='highlight(2045826601)', title='header.Header._encode_chunks&header :: ?'>header</a>:
<span class='lineno'>360</span>                 continue
<span class='lineno'>361</span>             if <a href='#header.Header._encode_chunks&charset', id ='2045827559', onmouseover='highlight(2045826630)', title='header.Header._encode_chunks&charset :: ?'>charset</a> is <a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='2045827591', onmouseover='highlight(2016665419)', title='__builtin__.None :: ?'><span class='builtin'>None</a></span> or <a href='#header.Header._encode_chunks&charset', id ='2045827599', onmouseover='highlight(2045826630)', title='header.Header._encode_chunks&charset :: ?'>charset</a>.header_encoding is <span class='builtin'><a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='2045828340', onmouseover='highlight(2016665419)', title='__builtin__.None :: ?'>None</span></a>:
<span class='lineno'>362</span>                 <a name='header.Header._encode_chunks&s', id ='2045828404', onmouseover='highlight(2045851467)', title='header.Header._encode_chunks&s :: ?'><a name='header.Header._encode_chunks&s', id ='2045828404', onmouseover='highlight(2045851467)', title='header.Header._encode_chunks&s :: ?'>s</a></a> = <a href='#header.Header._encode_chunks&header', id ='2045828429', onmouseover='highlight(2045826601)', title='header.Header._encode_chunks&header :: ?'>header</a>
<span class='lineno'>363</span>             else:
<span class='lineno'>364</span>                 <span class='identifier'><a name='header.Header._encode_chunks&s', id ='2045828554', onmouseover='highlight(2045851467)', title='header.Header._encode_chunks&s :: ?'><a name='header.Header._encode_chunks&s', id ='2045828554', onmouseover='highlight(2045851467)', title='header.Header._encode_chunks&s :: ?'><span class='identifier'>s</a></span></span></a> = <a href='#header.Header._encode_chunks&charset', id ='2045828558', onmouseover='highlight(2045826630)', title='header.Header._encode_chunks&charset :: ?'>charset</a>.header_encode(<a href='#header.Header._encode_chunks&header', id ='2045829273', onmouseover='highlight(2045826601)', title='header.Header._encode_chunks&header :: ?'>header</a>)
<span class='lineno'>365</span>             # Don&#39;t add more folding whitespace than necessary
<span class='lineno'>366</span>             if <a href='#header.Header._encode_chunks&chunks', id ='2045830199', onmouseover='highlight(2045826514)', title='header.Header._encode_chunks&chunks :: [?]'>chunks</a> and <a href='#header.Header._encode_chunks&chunks', id ='2045830231', onmouseover='highlight(2045826514)', title='header.Header._encode_chunks&chunks :: [?]'>chunks</a>[<span class='number'>-1</span>].endswith(&#39; &#39;):
<span class='lineno'>367</span>                 <a name='header.Header._encode_chunks&extra', id ='2045830357', onmouseover='highlight(2045851524)', title='header.Header._encode_chunks&extra :: str'><span class='identifier'>extra</span></a> = &#39;&#39;
<span class='lineno'>368</span>             else:
<span class='lineno'>369</span>                 <a name='header.Header._encode_chunks&extra', id ='2045851339', onmouseover='highlight(2045851524)', title='header.Header._encode_chunks&extra :: str'>extra</a> = &#39; &#39;
<span class='lineno'>370</span>             <a href='#header._max_append', id ='2045851405', onmouseover='highlight(1312919520)', title='header._max_append :: ([?], str, int, str) -> None'>_max_append</a>(<a href='#header.Header._encode_chunks&chunks', id ='2045851438', onmouseover='highlight(2045826514)', title='header.Header._encode_chunks&chunks :: [?]'>chunks</a>, <a href='#header.Header._encode_chunks&s', id ='2045851467', onmouseover='highlight("2045828554","2045828404")', title='header.Header._encode_chunks&s :: ?'>s</a>, <a href='#header.Header._encode_chunks@maxlinelen', id ='2045851491', onmouseover='highlight(2045797773)', title='header.Header._encode_chunks@maxlinelen :: int'>maxlinelen</a>, <a href='#header.Header._encode_chunks&extra', id ='2045851524', onmouseover='highlight("2045830357","2045851339")', title='header.Header._encode_chunks&extra :: str'>extra</a>)
<span class='lineno'>371</span>         <span class='identifier'><a name='header.Header._encode_chunks&joiner', id ='2045851560', onmouseover='highlight(2045852367)', title='header.Header._encode_chunks&joiner :: str'>joiner</a></span> = <a href='#header.NL', id ='2045851590', onmouseover='highlight(1150733651)', title='header.NL :: str'>NL</a> + <a href='#header.Header._encode_chunks@self', id ='2045851616', onmouseover='highlight(2045797714)', title='header.Header._encode_chunks@self :: Header'>self</a>.<a href='#header.Header._continuation_ws', id ='2045851621', onmouseover='highlight(1313069345)', title='header.Header._continuation_ws :: str'>_continuation_ws</a>
<span class='lineno'>372</span>         return <a href='#header.Header._encode_chunks&joiner', id ='2045852367', onmouseover='highlight(2045851560)', title='header.Header._encode_chunks&joiner :: str'>joiner</a>.<a href='http://docs.python.org/library/stdtypes.html#str.join', id ='2045852395', onmouseover='highlight(760704539)', title='__builtin__.str.join :: ? -> str'>join</a>(<a href='#header.Header._encode_chunks&chunks', id ='2045852421', onmouseover='highlight(2045826514)', title='header.Header._encode_chunks&chunks :: [?]'>chunks</a>)
<span class='lineno'>373</span> 
<span class='lineno'>374</span>     def <a name='header.Header.encode', id ='2045852459', onmouseover='highlight("1313099947","1313131932")', title='header.Header.encode :: (Header, str) -> ?'><span class='function'>encode</span></a>(<a name='header.Header.encode@self', id ='2045852487', onmouseover='highlight("2045884978","2045889063","2045911081","2045885190")', title='header.Header.encode@self :: Header'><span class='parameter'>self</a></span>, <a name='header.Header.encode@splitchars', id ='2045852514', onmouseover='highlight(2045889812)', title='header.Header.encode@splitchars :: str'><span class='parameter'>splitchars</span></a>=&#39;;, &#39;):
<span class='lineno'>375</span>         <span class='doc-string'>&quot;&quot;&quot;Encode a message header into an RFC-compliant format.
<span class='lineno'>376</span> 
<span class='lineno'>377</span>         There are many issues involved in converting a given string for use in
<span class='lineno'>378</span>         an email header.  Only certain character sets are readable in most
<span class='lineno'>379</span>         email clients, and as header strings can only contain a subset of
<span class='lineno'>380</span>         7-bit ASCII, care must be taken to properly convert and encode (with
<span class='lineno'>381</span>         Base64 or quoted-printable) header strings.  In addition, there is a
<span class='lineno'>382</span>         75-character length limit on any given encoded header field, so
<span class='lineno'>383</span>         line-wrapping must be performed, even with double-byte character sets.
<span class='lineno'>384</span> 
<span class='lineno'>385</span>         This method will do its best to convert the string to the correct
<span class='lineno'>386</span>         character set used in email, and encode and line wrap it safely with
<span class='lineno'>387</span>         the appropriate scheme for that character set.
<span class='lineno'>388</span> 
<span class='lineno'>389</span>         If the given charset is not known or an error occurs during
<span class='lineno'>390</span>         conversion, this function will return the header untouched.
<span class='lineno'>391</span> 
<span class='lineno'>392</span>         Optional splitchars is a string containing characters to split long
<span class='lineno'>393</span>         ASCII lines on, in rough support of RFC 2822&#39;s `highest level
<span class='lineno'>394</span>         syntactic breaks&#39;.  This doesn&#39;t affect RFC 2047 encoded lines.
<span class='lineno'>395</span>         &quot;&quot;&quot;</span>
<span class='lineno'>396</span>         <a name='header.Header.encode&newchunks', id ='2045884228', onmouseover='highlight("2045889966","2045911143","2045889008")', title='header.Header.encode&newchunks :: [?]'><span class='identifier'>newchunks</a></span> = []
<span class='lineno'>397</span>         <span class='identifier'><a name='header.Header.encode&maxlinelen', id ='2045884293', onmouseover='highlight("2045888943","2045887149","2045911175")', title='header.Header.encode&maxlinelen :: int'>maxlinelen</a></span> = <a href='#header.Header.encode@self', id ='2045884978', onmouseover='highlight(2045852487)', title='header.Header.encode@self :: Header'>self</a>.<a href='#header.Header._firstlinelen', id ='2045885004', onmouseover='highlight("1313096348","1313094395")', title='header.Header._firstlinelen :: int'>_firstlinelen</a>
<span class='lineno'>398</span>         <span class='identifier'><a name='header.Header.encode&lastlen', id ='2045885068', onmouseover='highlight(2045887855)', title='header.Header.encode&lastlen :: int'>lastlen</a></span> = <span class='number'>0</span>
<span class='lineno'>399</span>         for <a name='header.Header.encode&s', id ='2045885134', onmouseover='highlight(2045889096)', title='header.Header.encode&s :: ?'>s</a>, <a name='header.Header.encode&charset', id ='2045885158', onmouseover='highlight("2045889099","2045887978")', title='header.Header.encode&charset :: ?'>charset</a> in <a href='#header.Header.encode@self', id ='2045885190', onmouseover='highlight(2045852487)', title='header.Header.encode@self :: Header'>self</a>.<a href='#header.Header._chunks', id ='2045885195', onmouseover='highlight(1313071237)', title='header.Header._chunks :: [?]'>_chunks</a>:
<span class='lineno'>400</span>             # The first bit of the next chunk should be just long enough to
<span class='lineno'>401</span>             # fill the next line.  Don&#39;t forget the space separating the
<span class='lineno'>402</span>             # encoded words.
<span class='lineno'>403</span>             <a name='header.Header.encode&targetlen', id ='2045887116', onmouseover='highlight("2045889780","2045887924")', title='header.Header.encode&targetlen :: int'>targetlen</a> = <a href='#header.Header.encode&maxlinelen', id ='2045887149', onmouseover='highlight(2045884293)', title='header.Header.encode&maxlinelen :: int'>maxlinelen</a> - <a href='#header.Header.encode&lastlen', id ='2045887855', onmouseover='highlight(2045885068)', title='header.Header.encode&lastlen :: int'>lastlen</a> - <span class='number'>1</span>
<span class='lineno'>404</span>             if <a href='#header.Header.encode&targetlen', id ='2045887924', onmouseover='highlight("2045888910","2045887116")', title='header.Header.encode&targetlen :: int'>targetlen</a> &lt; <a href='#header.Header.encode&charset', id ='2045887978', onmouseover='highlight(2045885158)', title='header.Header.encode&charset :: ?'>charset</a>.encoded_header_len(&#39;&#39;):
<span class='lineno'>405</span>                 # Stick it on the next line
<span class='lineno'>406</span>                 <a name='header.Header.encode&targetlen', id ='2045888910', onmouseover='highlight("2045889780","2045887924")', title='header.Header.encode&targetlen :: int'><span class='identifier'>targetlen</a></span> = <a href='#header.Header.encode&maxlinelen', id ='2045888943', onmouseover='highlight(2045884293)', title='header.Header.encode&maxlinelen :: int'>maxlinelen</a>
<span class='lineno'>407</span>             <a href='#header.Header.encode&newchunks', id ='2045889008', onmouseover='highlight(2045884228)', title='header.Header.encode&newchunks :: [?]'>newchunks</a> += <a href='#header.Header.encode@self', id ='2045889063', onmouseover='highlight(2045852487)', title='header.Header.encode@self :: Header'>self</a>.<a href='#header.Header._split', id ='2045889068', onmouseover='highlight(2045710320)', title='header.Header._split :: (Header, ?, ?, int, str) -> [(?, ?)]'>_split</a>(<a href='#header.Header.encode&s', id ='2045889096', onmouseover='highlight(2045885134)', title='header.Header.encode&s :: ?'>s</a>, <a href='#header.Header.encode&charset', id ='2045889099', onmouseover='highlight(2045885158)', title='header.Header.encode&charset :: ?'>charset</a>, <a href='#header.Header.encode&targetlen', id ='2045889780', onmouseover='highlight("2045888910","2045887116")', title='header.Header.encode&targetlen :: int'>targetlen</a>, <a href='#header.Header.encode@splitchars', id ='2045889812', onmouseover='highlight(2045852514)', title='header.Header.encode@splitchars :: str'>splitchars</a>)
<span class='lineno'>408</span>             <span class='identifier'><a name='header.Header.encode&lastchunk', id ='2045889878', onmouseover='highlight(2045911012)', title='header.Header.encode&lastchunk :: ?'>lastchunk</a></span>, <a name='header.Header.encode&lastcharset', id ='2045889931', onmouseover='highlight(2045910918)', title='header.Header.encode&lastcharset :: ?'><span class='identifier'>lastcharset</a></span> = <a href='#header.Header.encode&newchunks', id ='2045889966', onmouseover='highlight(2045884228)', title='header.Header.encode&newchunks :: [?]'>newchunks</a>[<span class='number'>-1</span>]
<span class='lineno'>409</span>             <span class='identifier'><a name='header.Header.encode&lastlen', id ='2045890055', title='header.Header.encode&lastlen :: ?'>lastlen</span></a> = <a href='#header.Header.encode&lastcharset', id ='2045910918', onmouseover='highlight(2045889931)', title='header.Header.encode&lastcharset :: ?'>lastcharset</a>.encoded_header_len(<a href='#header.Header.encode&lastchunk', id ='2045911012', onmouseover='highlight(2045889878)', title='header.Header.encode&lastchunk :: ?'>lastchunk</a>)
<span class='lineno'>410</span>         <a name='header.Header.encode&value', id ='2045911073', onmouseover='highlight("2045913094","2045913029","2045911977")', title='header.Header.encode&value :: ?'><span class='identifier'>value</span></a> = <a href='#header.Header.encode@self', id ='2045911081', onmouseover='highlight(2045852487)', title='header.Header.encode@self :: Header'>self</a>.<a href='#header.Header._encode_chunks', id ='2045911107', onmouseover='highlight(2045797678)', title='header.Header._encode_chunks :: (Header, [?], int) -> ?'>_encode_chunks</a>(<a href='#header.Header.encode&newchunks', id ='2045911143', onmouseover='highlight(2045884228)', title='header.Header.encode&newchunks :: [?]'>newchunks</a>, <a href='#header.Header.encode&maxlinelen', id ='2045911175', onmouseover='highlight(2045884293)', title='header.Header.encode&maxlinelen :: int'>maxlinelen</a>)
<span class='lineno'>411</span>         if <a href='#header._embeded_header', id ='2045911912', onmouseover='highlight(1312919336)', title='header._embeded_header :: ?'>_embeded_header</a>.search(<a href='#header.Header.encode&value', id ='2045911977', onmouseover='highlight(2045911073)', title='header.Header.encode&value :: ?'>value</a>):
<span class='lineno'>412</span>             raise HeaderParseError(&quot;header value appears to contain &quot;
<span class='lineno'>413</span>                 &quot;an embedded header: {!r}&quot;.format(<a href='#header.Header.encode&value', id ='2045913029', onmouseover='highlight(2045911073)', title='header.Header.encode&value :: ?'>value</a>))
<span class='lineno'>414</span>         return <a href='#header.Header.encode&value', id ='2045913094', onmouseover='highlight(2045911073)', title='header.Header.encode&value :: ?'>value</a>
<span class='lineno'>415</span> 
<span class='lineno'>416</span> 
<span class='lineno'>417</span> 
<span class='lineno'>418</span> def <span class='function'><a name='header._split_ascii', id ='2045913801', onmouseover='highlight("2046600178","2045795851")', title='header._split_ascii :: (?, int, int, str, str) -> [?]'>_split_ascii</span></a>(<a name='header._split_ascii@s', id ='2045913835', onmouseover='highlight(2045914801)', title='header._split_ascii@s :: ?'><span class='parameter'>s</span></a>, <span class='parameter'><a name='header._split_ascii@firstlen', id ='2045913838', onmouseover='highlight(2045914083)', title='header._split_ascii@firstlen :: int'>firstlen</a></span>, <span class='parameter'><a name='header._split_ascii@restlen', id ='2045913869', onmouseover='highlight("2046603091","2045916910","2045942671","2046600919")', title='header._split_ascii@restlen :: int'>restlen</a></span>, <a name='header._split_ascii@continuation_ws', id ='2045913899', onmouseover='highlight("2046601073","2045945550")', title='header._split_ascii@continuation_ws :: str'><span class='parameter'>continuation_ws</span></a>, <span class='parameter'><a name='header._split_ascii@splitchars', id ='2045913958', onmouseover='highlight(2045919760)', title='header._split_ascii@splitchars :: str'>splitchars</a></span>):
<span class='lineno'>419</span>     <a name='header._split_ascii&lines', id ='2045913996', onmouseover='highlight("2046597293","2045947593","2046604953","2045941896","2046601199","2046625933","2045916786")', title='header._split_ascii&lines :: [?]'><span class='identifier'>lines</span></a> = []
<span class='lineno'>420</span>     <a name='header._split_ascii&maxlen', id ='2045914053', onmouseover='highlight("2046600024","2046597135","2046600239","2045916724")', title='header._split_ascii&maxlen :: int'><a name='header._split_ascii&maxlen', id ='2045914053', onmouseover='highlight("2046600024","2046597135","2046600239","2045916724")', title='header._split_ascii&maxlen :: ?'><a name='header._split_ascii&maxlen', id ='2045914053', onmouseover='highlight("2046600024","2046597135","2046600239","2045916724")', title='header._split_ascii&maxlen :: ?'>maxlen</a></a></a> = <a href='#header._split_ascii@firstlen', id ='2045914083', onmouseover='highlight(2045913838)', title='header._split_ascii@firstlen :: int'>firstlen</a>
<span class='lineno'>421</span>     for <a name='header._split_ascii&line', id ='2045914793', onmouseover='highlight("2045940709","2045916841","2045941951","2045915973","2045946539","2045916716")', title='header._split_ascii&line :: ?'><a name='header._split_ascii&line', id ='2045914793', onmouseover='highlight("2045940709","2045916841","2045941951","2045915973","2045946539","2045916716")', title='header._split_ascii&line :: ?'><a name='header._split_ascii&line', id ='2045914793', onmouseover='highlight("2045940709","2045916841","2045941951","2045915973","2045946539","2045916716")', title='header._split_ascii&line :: ?'>line</a></a></a> in <a href='#header._split_ascii@s', id ='2045914801', onmouseover='highlight(2045913835)', title='header._split_ascii@s :: ?'>s</a>.splitlines():
<span class='lineno'>422</span>         # Ignore any leading whitespace (i.e. continuation whitespace) already
<span class='lineno'>423</span>         # on the line, since we&#39;ll be adding our own.
<span class='lineno'>424</span>         <a name='header._split_ascii&line', id ='2045915945', onmouseover='highlight("2045940709","2045916841","2045941951","2045915973","2045946539","2045916716")', title='header._split_ascii&line :: ?'><a name='header._split_ascii&line', id ='2045915945', onmouseover='highlight("2045940709","2045916841","2045941951","2045915973","2045946539","2045916716")', title='header._split_ascii&line :: ?'><a name='header._split_ascii&line', id ='2045915945', onmouseover='highlight("2045940709","2045916841","2045941951","2045915973","2045946539","2045916716")', title='header._split_ascii&line :: ?'>line</a></a></a> = <a href='#header._split_ascii&line', id ='2045915973', onmouseover='highlight("2045915945","2045914793","2045915945","2045914793","2045915945","2045914793")', title='{header._split_ascii&line :: ? | header._split_ascii&line :: ? | header._split_ascii&line :: ?}'>line</a>.lstrip()
<span class='lineno'>425</span>         if <a href='http://docs.python.org/library/functions.html#len', id ='2045916691', onmouseover='highlight(134591780)', title='__builtin__.len :: ? -> int'>len</a>(<a href='#header._split_ascii&line', id ='2045916716', onmouseover='highlight("2045915945","2045914793")', title='header._split_ascii&line :: ?'>line</a>) &lt; <a href='#header._split_ascii&maxlen', id ='2045916724', onmouseover='highlight("2046603061","2045916901","2045914053","2045942662","2046603061","2045916901","2045914053","2045942662","2046603061","2045916901","2045914053","2045942662")', title='{header._split_ascii&maxlen :: ? | header._split_ascii&maxlen :: ? | header._split_ascii&maxlen :: int}'>maxlen</a>:
<span class='lineno'>426</span>             <a href='#header._split_ascii&lines', id ='2045916786', onmouseover='highlight(2045913996)', title='header._split_ascii&lines :: [?]'>lines</a>.<a href='http://docs.python.org/library/stdtypes.html', id ='2045916813', onmouseover='highlight(592677897)', title='__builtin__.list.append :: ? -> None'>append</a>(<a href='#header._split_ascii&line', id ='2045916841', onmouseover='highlight("2045915945","2045914793")', title='header._split_ascii&line :: ?'>line</a>)
<span class='lineno'>427</span>             <a name='header._split_ascii&maxlen', id ='2045916901', onmouseover='highlight("2046600024","2046597135","2046600239","2045916724")', title='header._split_ascii&maxlen :: ?'><a name='header._split_ascii&maxlen', id ='2045916901', onmouseover='highlight("2046600024","2046597135","2046600239","2045916724")', title='header._split_ascii&maxlen :: ?'><a name='header._split_ascii&maxlen', id ='2045916901', onmouseover='highlight("2046600024","2046597135","2046600239","2045916724")', title='header._split_ascii&maxlen :: int'>maxlen</a></a></a> = <a href='#header._split_ascii@restlen', id ='2045916910', onmouseover='highlight(2045913869)', title='header._split_ascii@restlen :: int'>restlen</a>
<span class='lineno'>428</span>             continue
<span class='lineno'>429</span>         # Attempt to split the line at the highest-level syntactic break
<span class='lineno'>430</span>         # possible.  Note that we don&#39;t have a lot of smarts about field
<span class='lineno'>431</span>         # syntax; we just try to break on semi-colons, then commas, then
<span class='lineno'>432</span>         # whitespace.
<span class='lineno'>433</span>         for <a name='header._split_ascii&ch', id ='2045919754', onmouseover='highlight("2046600056","2045919850","2045949425","2045944553","2045943809","2045943752")', title='header._split_ascii&ch :: str'>ch</a> in <a href='#header._split_ascii@splitchars', id ='2045919760', onmouseover='highlight(2045913958)', title='header._split_ascii@splitchars :: str'>splitchars</a>:
<span class='lineno'>434</span>             if <a href='#header._split_ascii&ch', id ='2045919850', onmouseover='highlight(2045919754)', title='header._split_ascii&ch :: str'>ch</a> in <a href='#header._split_ascii&line', id ='2045940709', onmouseover='highlight("2045915945","2045914793")', title='header._split_ascii&line :: ?'>line</a>:
<span class='lineno'>435</span>                 break
<span class='lineno'>436</span>         else:
<span class='lineno'>437</span>             # There&#39;s nothing useful to split the line on, not even spaces, so
<span class='lineno'>438</span>             # just append this line unchanged
<span class='lineno'>439</span>             <a href='#header._split_ascii&lines', id ='2045941896', onmouseover='highlight(2045913996)', title='header._split_ascii&lines :: [?]'>lines</a>.<a href='http://docs.python.org/library/stdtypes.html', id ='2045941923', onmouseover='highlight(592677897)', title='__builtin__.list.append :: ? -> None'>append</a>(<a href='#header._split_ascii&line', id ='2045941951', onmouseover='highlight("2045915945","2045914793")', title='header._split_ascii&line :: ?'>line</a>)
<span class='lineno'>440</span>             <a name='header._split_ascii&maxlen', id ='2045942662', onmouseover='highlight("2046600024","2046597135","2046600239","2045916724")', title='header._split_ascii&maxlen :: int'><a name='header._split_ascii&maxlen', id ='2045942662', onmouseover='highlight("2046600024","2046597135","2046600239","2045916724")', title='header._split_ascii&maxlen :: ?'><a name='header._split_ascii&maxlen', id ='2045942662', onmouseover='highlight("2046600024","2046597135","2046600239","2045916724")', title='header._split_ascii&maxlen :: ?'>maxlen</a></a></a> = <a href='#header._split_ascii@restlen', id ='2045942671', onmouseover='highlight(2045913869)', title='header._split_ascii@restlen :: int'>restlen</a>
<span class='lineno'>441</span>             continue
<span class='lineno'>442</span>         # Now split the line on the character plus trailing whitespace
<span class='lineno'>443</span>         <a name='header._split_ascii&cre', id ='2045943661', onmouseover='highlight(2045946508)', title='header._split_ascii&cre :: ?'><span class='identifier'>cre</a></span> = <a href='../re.py.html#re', id ='2045943688', onmouseover='highlight(544053356)', title='re :: re'>re</a>.<a href='../re.py.html#re.compile', id ='2045943691', onmouseover='highlight(2025599818)', title='re.compile :: (str, int) -> ? | (my_unicode, int) -> ?'>compile</a>(r&#39;%s\s*&#39; % <a href='#header._split_ascii&ch', id ='2045943752', onmouseover='highlight(2045919754)', title='header._split_ascii&ch :: str'>ch</a>)
<span class='lineno'>444</span>         if <a href='#header._split_ascii&ch', id ='2045943809', onmouseover='highlight(2045919754)', title='header._split_ascii&ch :: str'>ch</a> in &#39;;,&#39;:
<span class='lineno'>445</span>             <a name='header._split_ascii&eol', id ='2045943875', onmouseover='highlight("2046598040","2045944713")', title='header._split_ascii&eol :: str'><a name='header._split_ascii&eol', id ='2045943875', onmouseover='highlight("2046598040","2045944713")', title='header._split_ascii&eol :: str'><a name='header._split_ascii&eol', id ='2045943875', onmouseover='highlight("2046598040","2045944713")', title='header._split_ascii&eol :: str'>eol</a></a></a> = <a href='#header._split_ascii&ch', id ='2045944553', onmouseover='highlight(2045919754)', title='header._split_ascii&ch :: str'>ch</a>
<span class='lineno'>446</span>         else:
<span class='lineno'>447</span>             <a name='header._split_ascii&eol', id ='2045944624', onmouseover='highlight("2046598040","2045944713")', title='header._split_ascii&eol :: str'><span class='identifier'><a name='header._split_ascii&eol', id ='2045944624', onmouseover='highlight("2046598040","2045944713")', title='header._split_ascii&eol :: str'><a name='header._split_ascii&eol', id ='2045944624', onmouseover='highlight("2046598040","2045944713")', title='header._split_ascii&eol :: str'><span class='identifier'><span class='identifier'>eol</span></a></a></span></span></a> = &#39;&#39;
<span class='lineno'>448</span>         <span class='identifier'><a name='header._split_ascii&joiner', id ='2045944683', onmouseover='highlight("2046605008","2046597327","2045944808")', title='header._split_ascii&joiner :: str'>joiner</a></span> = <a href='#header._split_ascii&eol', id ='2045944713', onmouseover='highlight("2045944624","2045943875")', title='header._split_ascii&eol :: str'>eol</a> + &#39; &#39;
<span class='lineno'>449</span>         <a name='header._split_ascii&joinlen', id ='2045944773', onmouseover='highlight(2045946725)', title='header._split_ascii&joinlen :: ?'><span class='identifier'>joinlen</span></a> = <a href='http://docs.python.org/library/functions.html#len', id ='2045944804', onmouseover='highlight(134591780)', title='__builtin__.len :: ? -> int'>len</a>(<a href='#header._split_ascii&joiner', id ='2045944808', onmouseover='highlight(2045944683)', title='header._split_ascii&joiner :: str'>joiner</a>)
<span class='lineno'>450</span>         <span class='identifier'><a name='header._split_ascii&wslen', id ='2045945517', onmouseover='highlight(2046602939)', title='header._split_ascii&wslen :: ?'>wslen</a></span> = <a href='http://docs.python.org/library/functions.html#len', id ='2045945546', onmouseover='highlight(134591780)', title='__builtin__.len :: ? -> int'>len</a>(<a href='#header._split_ascii@continuation_ws', id ='2045945550', onmouseover='highlight(2045913899)', title='header._split_ascii@continuation_ws :: str'>continuation_ws</a>.<a href='http://docs.python.org/library/stdtypes.html#str.replace', id ='2045945608', onmouseover='highlight(1988410987)', title='__builtin__.str.replace :: ? -> str'>replace</a>(&#39;\t&#39;, <a href='#header.SPACE8', id ='2045945643', onmouseover='highlight(1150733750)', title='header.SPACE8 :: str'>SPACE8</a>))
<span class='lineno'>451</span>         <a name='header._split_ascii&this', id ='2045945702', onmouseover='highlight("2046605041","2046597204","2046602993","2046596206","2046604893","2045946693","2046603868","2046597360","2046596117","2045949606")', title='header._split_ascii&this :: [?]'><a name='header._split_ascii&this', id ='2045945702', onmouseover='highlight("2046605041","2046597204","2046602993","2046596206","2046604893","2045946693","2046603868","2046597360","2046596117","2045949606")', title='header._split_ascii&this :: [?]'>this</a></a> = []
<span class='lineno'>452</span>         <a name='header._split_ascii&linelen', id ='2045945762', onmouseover='highlight("2046596303","2046603986","2045946630")', title='header._split_ascii&linelen :: int'><a name='header._split_ascii&linelen', id ='2045945762', onmouseover='highlight("2046596303","2046603986","2045946630")', title='header._split_ascii&linelen :: int'>linelen</a></a> = <span class='number'>0</span>
<span class='lineno'>453</span>         for <a name='header._split_ascii&part', id ='2045946479', onmouseover='highlight("2046602844","2046596239","2046600212","2046603901","2045947473")', title='header._split_ascii&part :: ?'>part</a> in <a href='#header._split_ascii&cre', id ='2045946508', onmouseover='highlight(2045943661)', title='header._split_ascii&cre :: ?'>cre</a>.split(<a href='#header._split_ascii&line', id ='2045946539', onmouseover='highlight("2045915945","2045914793")', title='header._split_ascii&line :: ?'>line</a>):
<span class='lineno'>454</span>             <a name='header._split_ascii&curlen', id ='2045946600', onmouseover='highlight(2046597074)', title='header._split_ascii&curlen :: int'><span class='identifier'>curlen</a></span> = <a href='#header._split_ascii&linelen', id ='2045946630', onmouseover='highlight("2046602908","2045945762","2046602908","2045945762")', title='{header._split_ascii&linelen :: int | header._split_ascii&linelen :: int}'>linelen</a> + <a href='http://docs.python.org/library/functions.html#max', id ='2045946661', onmouseover='highlight(135405747)', title='__builtin__.max :: ? -> int'>max</a>(<span class='number'>0</span>, <a href='http://docs.python.org/library/functions.html#len', id ='2045946668', onmouseover='highlight(134591780)', title='__builtin__.len :: ? -> int'>len</a>(<a href='#header._split_ascii&this', id ='2045946693', onmouseover='highlight("2046602164","2046601978","2045945702","2046602164","2046601978","2045945702")', title='{header._split_ascii&this :: [?] | header._split_ascii&this :: [?]}'>this</a>)-<span class='number'>1</span>) * <a href='#header._split_ascii&joinlen', id ='2045946725', onmouseover='highlight(2045944773)', title='header._split_ascii&joinlen :: ?'>joinlen</a>
<span class='lineno'>455</span>             <a name='header._split_ascii&partlen', id ='2045947438', onmouseover='highlight("2046599993","2046604018","2046596335","2046597104")', title='header._split_ascii&partlen :: ?'><span class='identifier'>partlen</span></a> = <a href='http://docs.python.org/library/functions.html#len', id ='2045947469', onmouseover='highlight(134591780)', title='__builtin__.len :: ? -> int'>len</a>(<a href='#header._split_ascii&part', id ='2045947473', onmouseover='highlight(2045946479)', title='header._split_ascii&part :: ?'>part</a>)
<span class='lineno'>456</span>             <span class='identifier'><a name='header._split_ascii&onfirstline', id ='2045947533', onmouseover='highlight(2045949460)', title='header._split_ascii&onfirstline :: [?]'>onfirstline</span></a> = not <a href='#header._split_ascii&lines', id ='2045947593', onmouseover='highlight(2045913996)', title='header._split_ascii&lines :: [?]'>lines</a>
<span class='lineno'>457</span>             # We don&#39;t want to split after the field name, if we&#39;re on the
<span class='lineno'>458</span>             # first line and the field name is present in the header string.
<span class='lineno'>459</span>             if <a href='#header._split_ascii&ch', id ='2045949425', onmouseover='highlight(2045919754)', title='header._split_ascii&ch :: str'>ch</a> == &#39; &#39; and <a href='#header._split_ascii&onfirstline', id ='2045949460', onmouseover='highlight(2045947533)', title='header._split_ascii&onfirstline :: [?]'>onfirstline</a> and \
<span class='lineno'>460</span>                    <a href='http://docs.python.org/library/functions.html#len', id ='2045949581', onmouseover='highlight(134591780)', title='__builtin__.len :: ? -> int'>len</a>(<a href='#header._split_ascii&this', id ='2045949606', onmouseover='highlight("2046602164","2046601978","2045945702","2046602164","2046601978","2045945702")', title='{header._split_ascii&this :: [?] | header._split_ascii&this :: [?]}'>this</a>) == <span class='number'>1</span> and <a href='#header.fcre', id ='2045949642', onmouseover='highlight(1312917603)', title='header.fcre :: ?'>fcre</a>.match(<a href='#header._split_ascii&this', id ='2046596117', onmouseover='highlight("2046602164","2046601978","2045945702","2046602164","2046601978","2045945702")', title='{header._split_ascii&this :: [?] | header._split_ascii&this :: [?]}'>this</a>[<span class='number'>0</span>]):
<span class='lineno'>461</span>                 <a href='#header._split_ascii&this', id ='2046596206', onmouseover='highlight("2046602164","2046601978","2045945702","2046602164","2046601978","2045945702")', title='{header._split_ascii&this :: [?] | header._split_ascii&this :: [?]}'>this</a>.<a href='http://docs.python.org/library/stdtypes.html', id ='2046596211', onmouseover='highlight(592677897)', title='__builtin__.list.append :: ? -> None'>append</a>(<a href='#header._split_ascii&part', id ='2046596239', onmouseover='highlight(2045946479)', title='header._split_ascii&part :: ?'>part</a>)
<span class='lineno'>462</span>                 <a href='#header._split_ascii&linelen', id ='2046596303', onmouseover='highlight("2046602908","2045945762","2046602908","2045945762")', title='{header._split_ascii&linelen :: int | header._split_ascii&linelen :: int}'>linelen</a> += <a href='#header._split_ascii&partlen', id ='2046596335', onmouseover='highlight(2045947438)', title='header._split_ascii&partlen :: ?'>partlen</a>
<span class='lineno'>463</span>             elif <a href='#header._split_ascii&curlen', id ='2046597074', onmouseover='highlight(2045946600)', title='header._split_ascii&curlen :: int'>curlen</a> + <a href='#header._split_ascii&partlen', id ='2046597104', onmouseover='highlight(2045947438)', title='header._split_ascii&partlen :: ?'>partlen</a> &gt; <a href='#header._split_ascii&maxlen', id ='2046597135', onmouseover='highlight("2046603061","2045916901","2045914053","2045942662","2046603061","2045916901","2045914053","2045942662")', title='{header._split_ascii&maxlen :: ? | header._split_ascii&maxlen :: int}'>maxlen</a>:
<span class='lineno'>464</span>                 if <a href='#header._split_ascii&this', id ='2046597204', onmouseover='highlight("2046602164","2046601978","2045945702","2046602164","2046601978","2045945702")', title='{header._split_ascii&this :: [?] | header._split_ascii&this :: [?]}'>this</a>:
<span class='lineno'>465</span>                     <a href='#header._split_ascii&lines', id ='2046597293', onmouseover='highlight(2045913996)', title='header._split_ascii&lines :: [?]'>lines</a>.<a href='http://docs.python.org/library/stdtypes.html', id ='2046597320', onmouseover='highlight(592677897)', title='__builtin__.list.append :: ? -> None'>append</a>(<a href='#header._split_ascii&joiner', id ='2046597327', onmouseover='highlight(2045944683)', title='header._split_ascii&joiner :: str'>joiner</a>.<a href='http://docs.python.org/library/stdtypes.html#str.join', id ='2046597355', onmouseover='highlight(760704539)', title='__builtin__.str.join :: ? -> str'>join</a>(<a href='#header._split_ascii&this', id ='2046597360', onmouseover='highlight("2046602164","2046601978","2045945702","2046602164","2046601978","2045945702")', title='{header._split_ascii&this :: [?] | header._split_ascii&this :: [?]}'>this</a>) + <a href='#header._split_ascii&eol', id ='2046598040', onmouseover='highlight("2045944624","2045943875")', title='header._split_ascii&eol :: str'>eol</a>)
<span class='lineno'>466</span>                 # If this part is longer than maxlen and we aren&#39;t already
<span class='lineno'>467</span>                 # splitting on whitespace, try to recursively split this line
<span class='lineno'>468</span>                 # on whitespace.
<span class='lineno'>469</span>                 if <a href='#header._split_ascii&partlen', id ='2046599993', onmouseover='highlight(2045947438)', title='header._split_ascii&partlen :: ?'>partlen</a> &gt; <a href='#header._split_ascii&maxlen', id ='2046600024', onmouseover='highlight("2046603061","2045916901","2045914053","2045942662","2046603061","2045916901","2045914053","2045942662")', title='{header._split_ascii&maxlen :: ? | header._split_ascii&maxlen :: int}'>maxlen</a> and <a href='#header._split_ascii&ch', id ='2046600056', onmouseover='highlight(2045919754)', title='header._split_ascii&ch :: str'>ch</a> != &#39; &#39;:
<span class='lineno'>470</span>                     <a name='header._split_ascii&subl', id ='2046600150', onmouseover='highlight("2046602007","2046601884")', title='header._split_ascii&subl :: [?]'><span class='identifier'>subl</a></span> = <a href='#header._split_ascii', id ='2046600178', onmouseover='highlight(2045913801)', title='header._split_ascii :: (?, int, int, str, str) -> [?]'>_split_ascii</a>(<a href='#header._split_ascii&part', id ='2046600212', onmouseover='highlight(2045946479)', title='header._split_ascii&part :: ?'>part</a>, <a href='#header._split_ascii&maxlen', id ='2046600239', onmouseover='highlight("2046603061","2045916901","2045914053","2045942662","2046603061","2045916901","2045914053","2045942662")', title='{header._split_ascii&maxlen :: ? | header._split_ascii&maxlen :: int}'>maxlen</a>, <a href='#header._split_ascii@restlen', id ='2046600919', onmouseover='highlight(2045913869)', title='header._split_ascii@restlen :: int'>restlen</a>,
<span class='lineno'>471</span>                                         <a href='#header._split_ascii@continuation_ws', id ='2046601073', onmouseover='highlight(2045913899)', title='header._split_ascii@continuation_ws :: str'>continuation_ws</a>, &#39; &#39;)
<span class='lineno'>472</span>                     <a href='#header._split_ascii&lines', id ='2046601199', onmouseover='highlight(2045913996)', title='header._split_ascii&lines :: [?]'>lines</a>.<a href='http://docs.python.org/library/stdtypes.html', id ='2046601877', onmouseover='highlight(592677897)', title='__builtin__.list.extend :: ? -> None'>extend</a>(<a href='#header._split_ascii&subl', id ='2046601884', onmouseover='highlight(2046600150)', title='header._split_ascii&subl :: [?]'>subl</a>[:<span class='number'>-1</span>])
<span class='lineno'>473</span>                     <a name='header._split_ascii&this', id ='2046601978', onmouseover='highlight("2046605041","2046597204","2046602993","2046596206","2046604893","2045946693","2046603868","2046597360","2046596117","2045949606")', title='header._split_ascii&this :: [?]'><a name='header._split_ascii&this', id ='2046601978', onmouseover='highlight("2046605041","2046597204","2046602993","2046596206","2046604893","2045946693","2046603868","2046597360","2046596117","2045949606")', title='header._split_ascii&this :: [?]'>this</a></a> = [<a href='#header._split_ascii&subl', id ='2046602007', onmouseover='highlight(2046600150)', title='header._split_ascii&subl :: [?]'>subl</a>[<span class='number'>-1</span>]]
<span class='lineno'>474</span>                 else:
<span class='lineno'>475</span>                     <a name='header._split_ascii&this', id ='2046602164', onmouseover='highlight("2046605041","2046597204","2046602993","2046596206","2046604893","2045946693","2046603868","2046597360","2046596117","2045949606")', title='header._split_ascii&this :: [?]'><span class='identifier'><a name='header._split_ascii&this', id ='2046602164', onmouseover='highlight("2046605041","2046597204","2046602993","2046596206","2046604893","2045946693","2046603868","2046597360","2046596117","2045949606")', title='header._split_ascii&this :: [?]'><span class='identifier'>this</span></a></a></span> = [<a href='#header._split_ascii&part', id ='2046602844', onmouseover='highlight(2045946479)', title='header._split_ascii&part :: ?'>part</a>]
<span class='lineno'>476</span>                 <span class='identifier'><a name='header._split_ascii&linelen', id ='2046602908', onmouseover='highlight("2046596303","2046603986","2045946630")', title='header._split_ascii&linelen :: int'><span class='identifier'><a name='header._split_ascii&linelen', id ='2046602908', onmouseover='highlight("2046596303","2046603986","2045946630")', title='header._split_ascii&linelen :: int'>linelen</a></span></a></span> = <a href='#header._split_ascii&wslen', id ='2046602939', onmouseover='highlight(2045945517)', title='header._split_ascii&wslen :: ?'>wslen</a> + <a href='http://docs.python.org/library/functions.html#len', id ='2046602968', onmouseover='highlight(134591780)', title='__builtin__.len :: ? -> int'>len</a>(<a href='#header._split_ascii&this', id ='2046602993', onmouseover='highlight("2046602164","2046601978","2045945702")', title='header._split_ascii&this :: [?]'>this</a>[<span class='number'>-1</span>])
<span class='lineno'>477</span>                 <span class='identifier'><a name='header._split_ascii&maxlen', id ='2046603061', onmouseover='highlight("2046600024","2046597135","2046600239","2045916724")', title='header._split_ascii&maxlen :: ?'><span class='identifier'><a name='header._split_ascii&maxlen', id ='2046603061', onmouseover='highlight("2046600024","2046597135","2046600239","2045916724")', title='header._split_ascii&maxlen :: int'><a name='header._split_ascii&maxlen', id ='2046603061', onmouseover='highlight("2046600024","2046597135","2046600239","2045916724")', title='header._split_ascii&maxlen :: ?'><span class='identifier'>maxlen</span></span></a></span></a></a> = <a href='#header._split_ascii@restlen', id ='2046603091', onmouseover='highlight(2045913869)', title='header._split_ascii@restlen :: ?'>restlen</a>
<span class='lineno'>478</span>             else:
<span class='lineno'>479</span>                 <a href='#header._split_ascii&this', id ='2046603868', onmouseover='highlight("2046602164","2046601978","2045945702")', title='header._split_ascii&this :: [?]'>this</a>.<a href='http://docs.python.org/library/stdtypes.html', id ='2046603894', onmouseover='highlight(592677897)', title='__builtin__.list.append :: ? -> None'>append</a>(<a href='#header._split_ascii&part', id ='2046603901', onmouseover='highlight(2045946479)', title='header._split_ascii&part :: ?'>part</a>)
<span class='lineno'>480</span>                 <a href='#header._split_ascii&linelen', id ='2046603986', onmouseover='highlight("2046602908","2045945762")', title='header._split_ascii&linelen :: int'>linelen</a> += <a href='#header._split_ascii&partlen', id ='2046604018', onmouseover='highlight(2045947438)', title='header._split_ascii&partlen :: ?'>partlen</a>
<span class='lineno'>481</span>         # Put any left over parts on a line by themselves
<span class='lineno'>482</span>         if <a href='#header._split_ascii&this', id ='2046604893', onmouseover='highlight("2046602164","2046601978","2045945702")', title='header._split_ascii&this :: [?]'>this</a>:
<span class='lineno'>483</span>             <a href='#header._split_ascii&lines', id ='2046604953', onmouseover='highlight(2045913996)', title='header._split_ascii&lines :: [?]'>lines</a>.<a href='http://docs.python.org/library/stdtypes.html', id ='2046604980', onmouseover='highlight(592677897)', title='__builtin__.list.append :: ? -> None'>append</a>(<a href='#header._split_ascii&joiner', id ='2046605008', onmouseover='highlight(2045944683)', title='header._split_ascii&joiner :: str'>joiner</a>.<a href='http://docs.python.org/library/stdtypes.html#str.join', id ='2046605015', onmouseover='highlight(760704539)', title='__builtin__.str.join :: ? -> str'>join</a>(<a href='#header._split_ascii&this', id ='2046605041', onmouseover='highlight("2046602164","2046601978","2045945702")', title='header._split_ascii&this :: [?]'>this</a>))
<span class='lineno'>484</span>     return <a href='#header._split_ascii&lines', id ='2046625933', onmouseover='highlight(2045913996)', title='header._split_ascii&lines :: [?]'>lines</a>
<span class='lineno'>485</span> 
<span class='lineno'>486</span> 
<span class='lineno'>487</span> 
<span class='lineno'>488</span> def <span class='function'><a name='header._binsplit', id ='2046625968', onmouseover='highlight(2045791759)', title='header._binsplit :: (?, ?, int) -> (?, ?)'>_binsplit</span></a>(<span class='parameter'><a name='header._binsplit@splittable', id ='2046625999', onmouseover='highlight("2046626181","2046631829","2046656940","2046656755")', title='header._binsplit@splittable :: ?'>splittable</a></span>, <a name='header._binsplit@charset', id ='2046626032', onmouseover='highlight("2046656689","2046656874","2046631763","2046631954")', title='header._binsplit@charset :: ?'><span class='parameter'>charset</a></span>, <a name='header._binsplit@maxlinelen', id ='2046626062', onmouseover='highlight(2046632788)', title='header._binsplit@maxlinelen :: int'><span class='parameter'>maxlinelen</span></a>):
<span class='lineno'>489</span>     <a name='header._binsplit&i', id ='2046626121', onmouseover='highlight("2046630926","2046657623","2046656809","2046626896")', title='header._binsplit&i :: int'><a name='header._binsplit&i', id ='2046626121', onmouseover='highlight("2046630926","2046657623","2046656809","2046626896")', title='header._binsplit&i :: int'>i</a></a> = <span class='number'>0</span>
<span class='lineno'>490</span>     <a name='header._binsplit&j', id ='2046626152', onmouseover='highlight("2046626900","2046630928")', title='header._binsplit&j :: int'><a name='header._binsplit&j', id ='2046626152', onmouseover='highlight("2046626900","2046630928")', title='header._binsplit&j :: int'>j</a></a> = <a href='http://docs.python.org/library/functions.html#len', id ='2046626156', onmouseover='highlight(134591780)', title='__builtin__.len :: ? -> int'>len</a>(<a href='#header._binsplit@splittable', id ='2046626181', onmouseover='highlight(2046625999)', title='header._binsplit@splittable :: ?'>splittable</a>)
<span class='lineno'>491</span>     while <a href='#header._binsplit&i', id ='2046626896', onmouseover='highlight("2046633687","2046626121","2046633687","2046626121")', title='{header._binsplit&i :: int | header._binsplit&i :: int}'>i</a> &lt; <a href='#header._binsplit&j', id ='2046626900', onmouseover='highlight("2046634618","2046626152","2046634618","2046626152")', title='{header._binsplit&j :: int | header._binsplit&j :: int}'>j</a>:
<span class='lineno'>492</span>         # Invariants:
<span class='lineno'>493</span>         # 1. splittable[:k] fits for all k &lt;= i (note that we *assume*,
<span class='lineno'>494</span>         #    at the start, that splittable[:0] fits).
<span class='lineno'>495</span>         # 2. splittable[:k] does not fit for any k &gt; j (at the start,
<span class='lineno'>496</span>         #    this means we shouldn&#39;t look at any k &gt; len(splittable)).
<span class='lineno'>497</span>         # 3. We don&#39;t know about splittable[:k] for k in i+1..j.
<span class='lineno'>498</span>         # 4. We want to set i to the largest k that fits, with i &lt;= k &lt;= j.
<span class='lineno'>499</span>         #
<span class='lineno'>500</span>         <span class='identifier'><a name='header._binsplit&m', id ='2046630900', onmouseover='highlight("2046634622","2046631862","2046633691")', title='header._binsplit&m :: int'>m</a></span> = (<a href='#header._binsplit&i', id ='2046630926', onmouseover='highlight("2046633687","2046626121","2046633687","2046626121")', title='{header._binsplit&i :: int | header._binsplit&i :: int}'>i</a>+<a href='#header._binsplit&j', id ='2046630928', onmouseover='highlight("2046634618","2046626152","2046634618","2046626152")', title='{header._binsplit&j :: int | header._binsplit&j :: int}'>j</a>+<span class='number'>1</span>) &gt;&gt; <span class='number'>1</span>  # ceiling((i+j)/2); i &lt; m &lt;= j
<span class='lineno'>501</span>         <a name='header._binsplit&chunk', id ='2046631734', onmouseover='highlight(2046632695)', title='header._binsplit&chunk :: ?'><span class='identifier'>chunk</a></span> = <a href='#header._binsplit@charset', id ='2046631763', onmouseover='highlight(2046626032)', title='header._binsplit@charset :: ?'>charset</a>.from_splittable(<a href='#header._binsplit@splittable', id ='2046631829', onmouseover='highlight(2046625999)', title='header._binsplit@splittable :: ?'>splittable</a>[:<a href='#header._binsplit&m', id ='2046631862', onmouseover='highlight(2046630900)', title='header._binsplit&m :: int'>m</a>], <span class='builtin'><a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='2046631887', onmouseover='highlight(2016665419)', title='__builtin__.True :: ?'>True</a></span>)
<span class='lineno'>502</span>         <span class='identifier'><a name='header._binsplit&chunklen', id ='2046631922', onmouseover='highlight(2046632755)', title='header._binsplit&chunklen :: ?'>chunklen</a></span> = <a href='#header._binsplit@charset', id ='2046631954', onmouseover='highlight(2046626032)', title='header._binsplit@charset :: ?'>charset</a>.encoded_header_len(<a href='#header._binsplit&chunk', id ='2046632695', onmouseover='highlight(2046631734)', title='header._binsplit&chunk :: ?'>chunk</a>)
<span class='lineno'>503</span>         if <a href='#header._binsplit&chunklen', id ='2046632755', onmouseover='highlight(2046631922)', title='header._binsplit&chunklen :: ?'>chunklen</a> &lt;= <a href='#header._binsplit@maxlinelen', id ='2046632788', onmouseover='highlight(2046626062)', title='header._binsplit@maxlinelen :: int'>maxlinelen</a>:
<span class='lineno'>504</span>             # m is acceptable, so is a new lower bound.
<span class='lineno'>505</span>             <a name='header._binsplit&i', id ='2046633687', onmouseover='highlight("2046630926","2046657623","2046656809","2046626896")', title='header._binsplit&i :: int'><span class='identifier'><a name='header._binsplit&i', id ='2046633687', onmouseover='highlight("2046630926","2046657623","2046656809","2046626896")', title='header._binsplit&i :: int'><span class='identifier'>i</span></a></a></span> = <a href='#header._binsplit&m', id ='2046633691', onmouseover='highlight(2046630900)', title='header._binsplit&m :: int'>m</a>
<span class='lineno'>506</span>         else:
<span class='lineno'>507</span>             # m is not acceptable, so final i must be &lt; m.
<span class='lineno'>508</span>             <span class='identifier'><a name='header._binsplit&j', id ='2046634618', onmouseover='highlight("2046626900","2046630928")', title='header._binsplit&j :: int'><span class='identifier'><a name='header._binsplit&j', id ='2046634618', onmouseover='highlight("2046626900","2046630928")', title='header._binsplit&j :: int'>j</a></span></a></span> = <a href='#header._binsplit&m', id ='2046634622', onmouseover='highlight(2046630900)', title='header._binsplit&m :: int'>m</a> - <span class='number'>1</span>
<span class='lineno'>509</span>     # i == j.  Invariant #1 implies that splittable[:i] fits, and
<span class='lineno'>510</span>     # invariant #2 implies that splittable[:i+1] does not fit, so i
<span class='lineno'>511</span>     # is what we&#39;re looking for.
<span class='lineno'>512</span>     <span class='identifier'><a name='header._binsplit&first', id ='2046656660', onmouseover='highlight(2046657709)', title='header._binsplit&first :: ?'>first</span></a> = <a href='#header._binsplit@charset', id ='2046656689', onmouseover='highlight(2046626032)', title='header._binsplit@charset :: ?'>charset</a>.from_splittable(<a href='#header._binsplit@splittable', id ='2046656755', onmouseover='highlight(2046625999)', title='header._binsplit@splittable :: ?'>splittable</a>[:<a href='#header._binsplit&i', id ='2046656809', onmouseover='highlight("2046633687","2046626121")', title='header._binsplit&i :: int'>i</a>], <span class='builtin'><a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='2046656813', onmouseover='highlight(2016665419)', title='__builtin__.False :: ?'>False</span></a>)
<span class='lineno'>513</span>     <span class='identifier'><a name='header._binsplit&last', id ='2046656845', onmouseover='highlight(2046657716)', title='header._binsplit&last :: ?'>last</a></span>  = <a href='#header._binsplit@charset', id ='2046656874', onmouseover='highlight(2046626032)', title='header._binsplit@charset :: ?'>charset</a>.from_splittable(<a href='#header._binsplit@splittable', id ='2046656940', onmouseover='highlight(2046625999)', title='header._binsplit@splittable :: ?'>splittable</a>[<a href='#header._binsplit&i', id ='2046657623', onmouseover='highlight("2046633687","2046626121")', title='header._binsplit&i :: int'>i</a>:], <span class='builtin'><a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='2046657649', onmouseover='highlight(2016665419)', title='__builtin__.False :: ?'>False</a></span>)
<span class='lineno'>514</span>     return <a href='#header._binsplit&first', id ='2046657709', onmouseover='highlight(2046656660)', title='header._binsplit&first :: ?'>first</a>, <a href='#header._binsplit&last', id ='2046657716', onmouseover='highlight(2046656845)', title='header._binsplit&last :: ?'>last</a>
</pre></td></tr></table></body></html>