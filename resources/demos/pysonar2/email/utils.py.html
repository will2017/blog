<html><head title="/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/email/utils.py"><style type='text/css'>
body { color: #666666; } 
a {text-decoration: none; color: #5A82F7}
table, th, td { border: 1px solid lightgrey; padding: 5px; corner: rounded; }
.builtin {color: #B17E41;}
.comment, .block-comment {color: #aaaaaa; font-style: italic;}
.constant {color: #888888;}
.decorator {color: #778899;}
.doc-string {color: #aaaaaa;}
.error {border-bottom: 1px solid red;}
.field-name {color: #2e8b57;}
.function {color: #4682b4;}
.identifier {color: #8b7765;}
.info {border-bottom: 1px dotted RoyalBlue;}
.keyword {color: #0000cd;}
.lineno {color: #aaaaaa;}
.number {color: #483d8b;}
.parameter {color: #777777;}
.string {color: #999999;}
.type-name {color: #4682b4;}
.warning {border-bottom: 1px dotted orange;}
</style>
<script language="JavaScript" type="text/javascript">
var highlighted = new Array();
function highlight()
{
    // clear existing highlights
    for (var i = 0; i < highlighted.length; i++) {
        var elm = document.getElementById(highlighted[i]);
        if (elm != null) {
            elm.style.backgroundColor = 'white';
        }
    }
    highlighted = new Array();
    for (var i = 0; i < arguments.length; i++) {
        var elm = document.getElementById(arguments[i]);
        if (elm != null) {
            elm.style.backgroundColor='gold';
        }
        highlighted.push(arguments[i]);
    }
} </script>
</head>
<body>
<table width=100% border='1px solid gray'><tr><td valign='top'><ul>
<li><a href='#re', onmouseover='highlight("re")'>re</a></li><li><a href='#utils.__all__', onmouseover='highlight("utils___all__")'><span class='identifier'>__all__</span></a></li><li><a href='#utils.COMMASPACE', onmouseover='highlight("utils_COMMASPACE")'><span class='identifier'>COMMASPACE</span></a></li><li><a href='#utils.EMPTYSTRING', onmouseover='highlight("utils_EMPTYSTRING")'><span class='identifier'>EMPTYSTRING</span></a></li><li><a href='#utils.UEMPTYSTRING', onmouseover='highlight("utils_UEMPTYSTRING")'><span class='identifier'>UEMPTYSTRING</span></a></li><li><a href='#utils.CRLF', onmouseover='highlight("utils_CRLF")'><span class='identifier'>CRLF</span></a></li><li><a href='#utils.TICK', onmouseover='highlight("utils_TICK")'><span class='identifier'>TICK</span></a></li><li><a href='#utils.specialsre', onmouseover='highlight("utils_specialsre")'><span class='identifier'>specialsre</span></a></li><li><a href='#utils.escapesre', onmouseover='highlight("utils_escapesre")'><span class='identifier'>escapesre</span></a></li><li><a href='#utils._identity', onmouseover='highlight("utils__identity")'><span class='function'>_identity</span></a></li><li><a href='#utils._bdecode', onmouseover='highlight("utils__bdecode")'><span class='function'>_bdecode</span></a></li><li><a href='#utils.fix_eols', onmouseover='highlight("utils_fix_eols")'><span class='function'>fix_eols</span></a></li><li><a href='#utils.formataddr', onmouseover='highlight("utils_formataddr")'><span class='function'>formataddr</span></a></li><li><a href='#utils.getaddresses', onmouseover='highlight("utils_getaddresses")'><span class='function'>getaddresses</span></a></li><li><a href='#utils.ecre', onmouseover='highlight("utils_ecre")'><span class='identifier'>ecre</span></a></li><li><a href='#utils.formatdate', onmouseover='highlight("utils_formatdate")'><span class='function'>formatdate</span></a></li><li><a href='#utils.make_msgid', onmouseover='highlight("utils_make_msgid")'><span class='function'>make_msgid</span></a></li><li><a href='#utils.parsedate', onmouseover='highlight("utils_parsedate")'><span class='function'>parsedate</span></a></li><li><a href='#utils.parsedate_tz', onmouseover='highlight("utils_parsedate_tz")'><span class='function'>parsedate_tz</span></a></li><li><a href='#utils.parseaddr', onmouseover='highlight("utils_parseaddr")'><span class='function'>parseaddr</span></a></li><li><a href='#utils.unquote', onmouseover='highlight("utils_unquote")'><span class='function'>unquote</span></a></li><li><a href='#utils.decode_rfc2231', onmouseover='highlight("utils_decode_rfc2231")'><span class='function'>decode_rfc2231</span></a></li><li><a href='#utils.encode_rfc2231', onmouseover='highlight("utils_encode_rfc2231")'><span class='function'>encode_rfc2231</span></a></li><li><a href='#utils.rfc2231_continuation', onmouseover='highlight("utils_rfc2231_continuation")'><span class='identifier'>rfc2231_continuation</span></a></li><li><a href='#utils.decode_params', onmouseover='highlight("utils_decode_params")'><span class='function'>decode_params</span></a></li><li><a href='#utils.collapse_rfc2231_value', onmouseover='highlight("utils_collapse_rfc2231_value")'><span class='function'>collapse_rfc2231_value</span></a></li></ul>
</td><td><pre><span class='lineno'>1</span> # Copyr<a name='base64', id ='1808796534', onmouseover='highlight("1808796534","1197975823")', title='base64 :: base64'><a name='urllib', id ='1808796534', onmouseover='highlight("1808796534","1197762387")', title='urllib :: urllib'><a name='random', id ='1808796534', onmouseover='highlight("1197857626","1808796534")', title='random :: random'><a name='re', id ='1808796534', onmouseover='highlight("1197799130","1197973070","1197942099","1808796534","1197979577","1197974001","1197941414","1197945200","1197979705")', title='re :: re'><a name='warnings', id ='1808796534', onmouseover='highlight(1808796534)', title='warnings :: warnings'><a name='socket', id ='1808796534', onmouseover='highlight("1808796534","1197856573")', title='socket :: socket'><a href='../re.py.html#re', id ='1808796534', onmouseover='highlight("1808796534","1808796534","1808796534")', title='{re :: re | base64 :: base64 | warnings :: warnings}'>i</a>g</a>ht </a></a></a></a>(C</a>) 2001-2010 Python Software Foundation
<span class='lineno'>2</span> # Author: Barry Warsaw
<span class='lineno'>3</span> # Contact: email-sig@python.org
<span class='lineno'>4</span> 
<span class='lineno'>5</span> <span class='doc-string'>&quot;&quot;&quot;Miscellaneous utilities.&quot;&quot;&quot;</span>
<span class='lineno'>6</span> 
<span class='lineno'>7</span> <a name='utils.__all__', id ='1208281601', title='utils.__all__ :: [str]'>__all__</a> = [
<span class='lineno'>8</span>     &#39;collapse_rfc2231_value&#39;,
<span class='lineno'>9</span>     &#39;decode_params&#39;,
<span class='lineno'>10</span>     &#39;decode_rfc2231&#39;,
<span class='lineno'>11</span>     &#39;encode_rfc2231&#39;,
<span class='lineno'>12</span>     &#39;formataddr&#39;,
<span class='lineno'>13</span>     &#39;formatdate&#39;,
<span class='lineno'>14</span>     &#39;getaddresses&#39;,
<span class='lineno'>15</span>     &#39;make_msgid&#39;,
<span class='lineno'>16</span>     &#39;mktime_tz&#39;,
<span class='lineno'>17</span>     &#39;parseaddr&#39;,
<span class='lineno'>18</span>     &#39;parsedate&#39;,
<span class='lineno'>19</span>     &#39;parsedate_tz&#39;,
<span class='lineno'>20</span>     &#39;unquote&#39;,
<span class='lineno'>21</span>     ]
<span class='lineno'>22</span> 
<span class='lineno'>23</span> import os
<span class='lineno'>24</span> import re
<span class='lineno'>25</span> import time
<span class='lineno'>26</span> import base64
<span class='lineno'>27</span> import random
<span class='lineno'>28</span> import socket
<span class='lineno'>29</span> import urllib
<span class='lineno'>30</span> import warnings
<span class='lineno'>31</span> 
<span class='lineno'>32</span> from email._parseaddr import quote
<span class='lineno'>33</span> from email._parseaddr import AddressList as _AddressList
<span class='lineno'>34</span> from email._parseaddr import mktime_tz
<span class='lineno'>35</span> 
<span class='lineno'>36</span> # We need wormarounds for bugs in these methods in older Pythons (see below)
<span class='lineno'>37</span> from email._parseaddr import parsedate as _parsedate
<span class='lineno'>38</span> from email._parseaddr import parsedate_tz as _parsedate_tz
<span class='lineno'>39</span> 
<span class='lineno'>40</span> from quopri import decodestring as _qdecode
<span class='lineno'>41</span> 
<span class='lineno'>42</span> # Intrapackage imports
<span class='lineno'>43</span> from email.encoders import _bencode, _qencode
<span class='lineno'>44</span> 
<span class='lineno'>45</span> <span class='constant'><a name='utils.COMMASPACE', id ='1208289326', onmouseover='highlight(1197946131)', title='utils.COMMASPACE :: str'>COMMASPACE</span></a> = &#39;, &#39;
<span class='lineno'>46</span> <a name='utils.EMPTYSTRING', id ='1208289386', onmouseover='highlight(1197740540)', title='utils.EMPTYSTRING :: str'><span class='constant'>EMPTYSTRING</span></a> = &#39;&#39;
<span class='lineno'>47</span> <span class='constant'><a name='utils.UEMPTYSTRING', id ='1208289445', title='utils.UEMPTYSTRING :: str'>UEMPTYSTRING</span></a> = u&#39;&#39;
<span class='lineno'>48</span> <a name='utils.CRLF', id ='1197979828', onmouseover='highlight("1197973938","1197973008")', title='utils.CRLF :: str'><span class='constant'>CRLF</a></span> = &#39;\r\n&#39;
<span class='lineno'>49</span> <span class='constant'><a name='utils.TICK', id ='1197979793', onmouseover='highlight(1197825073)', title='utils.TICK :: str'>TICK</a></span> = <span class='doc-string'>&quot;&#39;&quot;</span>
<span class='lineno'>50</span> 
<span class='lineno'>51</span> <a name='utils.specialsre', id ='1197979760', onmouseover='highlight(1197948983)', title='utils.specialsre :: ?'>specialsre</a> = <a href='../re.py.html#re', id ='1197979705', onmouseover='highlight(1808796534)', title='re :: re'>re</a>.<a href='../re.py.html#re.compile', id ='1197979702', onmouseover='highlight(2025599818)', title='re.compile :: (str, int) -> ? | (my_unicode, int) -> ?'>compile</a>(r&#39;[][\\()&lt;&gt;@,:;&quot;.]&#39;)
<span class='lineno'>52</span> <a name='utils.escapesre', id ='1197979610', onmouseover='highlight(1197948141)', title='utils.escapesre :: ?'>escapesre</a> = <a href='../re.py.html#re', id ='1197979577', onmouseover='highlight(1808796534)', title='re :: re'>re</a>.<a href='../re.py.html#re.compile', id ='1197979574', onmouseover='highlight(2025599818)', title='re.compile :: (str, int) -> ? | (my_unicode, int) -> ?'>compile</a>(r&#39;[][\\()&quot;]&#39;)
<span class='lineno'>53</span> 
<span class='lineno'>54</span> 
<span class='lineno'>55</span> 
<span class='lineno'>56</span> # Helpers
<span class='lineno'>57</span> 
<span class='lineno'>58</span> def <a name='utils._identity', id ='1197978798', title='utils._identity :: ? -> ?'><span class='function'>_identity</span></a>(<a name='utils._identity@s', id ='1197978767', onmouseover='highlight(1197978710)', title='utils._identity@s :: ?'><span class='parameter'>s</span></a>):
<span class='lineno'>59</span>     return <a href='#utils._identity@s', id ='1197978710', onmouseover='highlight(1197978767)', title='utils._identity@s :: ?'>s</a>
<span class='lineno'>60</span> 
<span class='lineno'>61</span> 
<span class='lineno'>62</span> def <a name='utils._bdecode', id ='1197978681', title='utils._bdecode :: ? -> ?'><span class='function'>_bdecode</a></span>(<a name='utils._bdecode@s', id ='1197978651', onmouseover='highlight("1197975857","1197975761","1197975917")', title='utils._bdecode@s :: ?'><span class='parameter'>s</a></span>):
<span class='lineno'>63</span>     <span class='doc-string'>&quot;&quot;&quot;Decodes a base64 string.
<span class='lineno'>64</span> 
<span class='lineno'>65</span>     This function is equivalent to base64.decodestring and it&#39;s retained only
<span class='lineno'>66</span>     for backward compatibility. It used to remove the last \\n of the decoded
<span class='lineno'>67</span>     string, if it had any (see issue 7143).
<span class='lineno'>68</span>     &quot;&quot;&quot;</span>
<span class='lineno'>69</span>     if not <a href='#utils._bdecode@s', id ='1197975917', onmouseover='highlight(1197978651)', title='utils._bdecode@s :: ?'>s</a>:
<span class='lineno'>70</span>         return <a href='#utils._bdecode@s', id ='1197975857', onmouseover='highlight(1197978651)', title='utils._bdecode@s :: ?'>s</a>
<span class='lineno'>71</span>     return <a href='../base64.py.html#base64', id ='1197975823', onmouseover='highlight(1808796534)', title='base64 :: base64'>base64</a>.<a href='../base64.py.html#base64.decodestring', id ='1197975795', onmouseover='highlight(1232108224)', title='base64.decodestring :: str -> ?'>decodestring</a>(<a href='#utils._bdecode@s', id ='1197975761', onmouseover='highlight(1197978651)', title='utils._bdecode@s :: ?'>s</a>)
<span class='lineno'>72</span> 
<span class='lineno'>73</span> 
<span class='lineno'>74</span> 
<span class='lineno'>75</span> def <a name='utils.fix_eols', id ='1197975729', title='utils.fix_eols :: ? -> ?'><span class='function'>fix_eols</span></a>(<a name='utils.fix_eols@s', id ='1197975048', onmouseover='highlight("1197973932","1197973002","1197972946")', title='utils.fix_eols@s :: ?'>s</a>):
<span class='lineno'>76</span>     <span class='doc-string'>&quot;&quot;&quot;Replace all line-ending characters with \\r\\n.&quot;&quot;&quot;</span>
<span class='lineno'>77</span>     # Fix newlines with no preceding carriage return
<span class='lineno'>78</span>     <a name='utils.fix_eols@s', id ='1197974026', onmouseover='highlight("1197973932","1197973002","1197972946")', title='utils.fix_eols@s :: ?'>s</a> = <a href='../re.py.html#re', id ='1197974001', onmouseover='highlight(1808796534)', title='re :: re'>re</a>.<a href='../re.py.html#re.sub', id ='1197973998', onmouseover='highlight(2025540119)', title='re.sub :: (str, str, str, int, int) -> ? | (str, ? -> ?, ?, int, int) -> ? | (str, ? -> ?, ?, int, int) -> ? | (str, ? -> ?, ?, int, int) -> ? | (str, (ReTests, ?) -> ?, str, int, int) -> ? | (str, ? -> str, str, int, int) -> ? | (str, ? -> str, str, int, int) -> ? | (str, ? -> {str | None}, ?, int, int) -> ? | (str, ? -> ?, ?, int, int) -> ? | (str, (?, ?) -> ?, ?, int, int) -> ?'>sub</a>(r&#39;(?&lt;!\r)\n&#39;, <a href='#utils.CRLF', id ='1197973938', onmouseover='highlight(1197979828)', title='utils.CRLF :: str'>CRLF</a>, <a href='#utils.fix_eols@s', id ='1197973932', onmouseover='highlight("1197973095","1197975048","1197974026")', title='utils.fix_eols@s :: ?'>s</a>)
<span class='lineno'>79</span>     # Fix carriage returns with no following newline
<span class='lineno'>80</span>     <a name='utils.fix_eols@s', id ='1197973095', onmouseover='highlight("1197973932","1197973002","1197972946")', title='utils.fix_eols@s :: ?'><span class='parameter'>s</a></span> = <a href='../re.py.html#re', id ='1197973070', onmouseover='highlight(1808796534)', title='re :: re'>re</a>.<a href='../re.py.html#re.sub', id ='1197973067', onmouseover='highlight(2025540119)', title='re.sub :: (str, str, str, int, int) -> ? | (str, ? -> ?, ?, int, int) -> ? | (str, ? -> ?, ?, int, int) -> ? | (str, ? -> ?, ?, int, int) -> ? | (str, (ReTests, ?) -> ?, str, int, int) -> ? | (str, ? -> str, str, int, int) -> ? | (str, ? -> str, str, int, int) -> ? | (str, ? -> {str | None}, ?, int, int) -> ? | (str, ? -> ?, ?, int, int) -> ? | (str, (?, ?) -> ?, ?, int, int) -> ?'>sub</a>(r&#39;\r(?!\n)&#39;, <a href='#utils.CRLF', id ='1197973008', onmouseover='highlight(1197979828)', title='utils.CRLF :: str'>CRLF</a>, <a href='#utils.fix_eols@s', id ='1197973002', onmouseover='highlight("1197973095","1197975048","1197974026")', title='utils.fix_eols@s :: ?'>s</a>)
<span class='lineno'>81</span>     return <a href='#utils.fix_eols@s', id ='1197972946', onmouseover='highlight("1197973095","1197975048","1197974026")', title='utils.fix_eols@s :: ?'>s</a>
<span class='lineno'>82</span> 
<span class='lineno'>83</span> 
<span class='lineno'>84</span> 
<span class='lineno'>85</span> def <span class='function'><a name='utils.formataddr', id ='1197972915', title='utils.formataddr :: ? -> str'>formataddr</a></span>(<span class='parameter'><a name='utils.formataddr@pair', id ='1197972883', onmouseover='highlight(1197949788)', title='utils.formataddr@pair :: ?'>pair</span></a>):
<span class='lineno'>86</span>     <span class='doc-string'>&quot;&quot;&quot;The inverse of parseaddr(), this takes a 2-tuple of the form
<span class='lineno'>87</span>     (realname, email_address) and returns the string value suitable
<span class='lineno'>88</span>     for an RFC 2822 From, To or Cc header.
<span class='lineno'>89</span> 
<span class='lineno'>90</span>     If the first element of pair is false, then the second element is
<span class='lineno'>91</span>     returned unmodified.
<span class='lineno'>92</span>     &quot;&quot;&quot;</span>
<span class='lineno'>93</span>     <span class='identifier'><a name='utils.formataddr&name', id ='1197949846', onmouseover='highlight("1197949104","1197948052","1197947922","1197948944")', title='utils.formataddr&name :: ?'>name</a></span>, <a name='utils.formataddr&address', id ='1197949819', onmouseover='highlight("1197947153","1197947866")', title='utils.formataddr&address :: ?'><span class='identifier'>address</a></span> = <a href='#utils.formataddr@pair', id ='1197949788', onmouseover='highlight(1197972883)', title='utils.formataddr@pair :: ?'>pair</a>
<span class='lineno'>94</span>     if <a href='#utils.formataddr&name', id ='1197949104', onmouseover='highlight("1197949846","1197948820")', title='utils.formataddr&name :: ?'>name</a>:
<span class='lineno'>95</span>         <a name='utils.formataddr&quotes', id ='1197949069', onmouseover='highlight("1197947895","1197947930")', title='utils.formataddr&quotes :: str'>quotes</a> = &#39;&#39;
<span class='lineno'>96</span>         if <a href='#utils.specialsre', id ='1197948983', onmouseover='highlight(1197979760)', title='utils.specialsre :: ?'>specialsre</a>.search(<a href='#utils.formataddr&name', id ='1197948944', onmouseover='highlight("1197949846","1197948820")', title='utils.formataddr&name :: ?'>name</a>):
<span class='lineno'>97</span>             <a name='utils.formataddr&quotes', id ='1197948883', onmouseover='highlight("1197947895","1197947930")', title='utils.formataddr&quotes :: str'><span class='identifier'>quotes</span></a> = <span class='doc-string'>&#39;&quot;&#39;</span>
<span class='lineno'>98</span>         <a name='utils.formataddr&name', id ='1197948820', onmouseover='highlight("1197949104","1197948052","1197947922","1197948944")', title='utils.formataddr&name :: ?'>name</a> = <a href='#utils.escapesre', id ='1197948141', onmouseover='highlight(1197979610)', title='utils.escapesre :: ?'>escapesre</a>.sub(r&#39;\\\g&lt;0&gt;&#39;, <a href='#utils.formataddr&name', id ='1197948052', onmouseover='highlight("1197949846","1197948820")', title='utils.formataddr&name :: ?'>name</a>)
<span class='lineno'>99</span>         return &#39;%s%s%s &lt;%s&gt;&#39; % (<a href='#utils.formataddr&quotes', id ='1197947930', onmouseover='highlight("1197948883","1197949069")', title='utils.formataddr&quotes :: str'>quotes</a>, <a href='#utils.formataddr&name', id ='1197947922', onmouseover='highlight("1197949846","1197948820")', title='utils.formataddr&name :: ?'>name</a>, <a href='#utils.formataddr&quotes', id ='1197947895', onmouseover='highlight("1197948883","1197949069")', title='utils.formataddr&quotes :: str'>quotes</a>, <a href='#utils.formataddr&address', id ='1197947866', onmouseover='highlight(1197949819)', title='utils.formataddr&address :: ?'>address</a>)
<span class='lineno'>100</span>     return <a href='#utils.formataddr&address', id ='1197947153', onmouseover='highlight(1197949819)', title='utils.formataddr&address :: ?'>address</a>
<span class='lineno'>101</span> 
<span class='lineno'>102</span> 
<span class='lineno'>103</span> 
<span class='lineno'>104</span> def <span class='function'><a name='utils.getaddresses', id ='1197947116', title='utils.getaddresses :: ? -> ?'>getaddresses</span></a>(<span class='parameter'><a name='utils.getaddresses@fieldvalues', id ='1197947061', onmouseover='highlight(1197946094)', title='utils.getaddresses@fieldvalues :: ?'>fieldvalues</a></span>):
<span class='lineno'>105</span>     <span class='doc-string'>&quot;&quot;&quot;Return a list of (REALNAME, EMAIL) for each fieldvalue.<span class='doc-string'>&quot;&quot;&quot;</span>
<span class='lineno'>106</span>     <a name='utils.getaddresses&all', id ='1197946158', onmouseover='highlight(1197945976)', title='utils.getaddresses&all :: ?'><span class='identifier'>all</span></a> = <a href='#utils.COMMASPACE', id ='1197946131', onmouseover='highlight(1208289326)', title='utils.COMMASPACE :: str'>COMMASPACE</a>.<a href='http://docs.python.org/library/stdtypes.html#str.join', id ='1197946099', onmouseover='highlight(760704539)', title='__builtin__.str.join :: ? -> str'>join</a>(<a href='#utils.getaddresses@fieldvalues', id ='1197946094', onmouseover='highlight(1197947061)', title='utils.getaddresses@fieldvalues :: ?'>fieldvalues</a>)
<span class='lineno'>107</span>     <a name='utils.getaddresses&a', id ='1197946035', onmouseover='highlight(1197945939)', title='utils.getaddresses&a :: ?'><span class='identifier'>a</span></a> = _AddressList(<a href='#utils.getaddresses&all', id ='1197945976', onmouseover='highlight(1197946158)', title='utils.getaddresses&all :: ?'>all</a>)
<span class='lineno'>108</span>     return <a href='#utils.getaddresses&a', id ='1197945939', onmouseover='highlight(1197946035)', title='utils.getaddresses&a :: ?'>a</a>.addresslist
<span class='lineno'>109</span> 
<span class='lineno'>110</span> 
<span class='lineno'>111</span> 
<span class='lineno'>112</span> <a name='utils.ecre', id ='1197945228', title='utils.ecre :: ?'>ecre</a> = <a href='../re.py.html#re', id ='1197945200', onmouseover='highlight(1808796534)', title='re :: re'>re</a>.<a href='../re.py.html#re.compile', id ='1197945197', onmouseover='highlight(2025599818)', title='re.compile :: (str, int) -> ? | (my_unicode, int) -> ?'>compile</a>(r&#39;&#39;&#39;
<span class='lineno'>113</span>   =\?                   # literal =?
<span class='lineno'>114</span>   (?P&lt;charset&gt;[^?]*?)   # non-greedy up to the next ? is the charset
<span class='lineno'>115</span>   \?                    # literal ?
<span class='lineno'>116</span>   (?P&lt;encoding&gt;[qb])    # either a &quot;q&quot; or a &quot;b&quot;, case insensitive
<span class='lineno'>117</span>   \?                    # literal ?
<span class='lineno'>118</span>   (?P&lt;atom&gt;.*?)         # non-greedy up to the next ?= is the atom
<span class='lineno'>119</span>   \?=                   # literal ?=
<span class='lineno'>120</span>   &#39;&#39;&#39;, <a href='../re.py.html#re', id ='1197942099', onmouseover='highlight(1808796534)', title='re :: re'>re</a>.<a href='../re.py.html#re.VERBOSE', id ='1197942096', onmouseover='highlight(2025532338)', title='re.VERBOSE :: ?'>VERBOSE</a> | <a href='../re.py.html#re', id ='1197941414', onmouseover='highlight(1808796534)', title='re :: re'>re</a>.<a href='../re.py.html#re.IGNORECASE', id ='1197941411', onmouseover='highlight(2025508493)', title='re.IGNORECASE :: ?'>IGNORECASE</a>)
<span class='lineno'>121</span> 
<span class='lineno'>122</span> 
<span class='lineno'>123</span> 
<span class='lineno'>124</span> def <a name='utils.formatdate', id ='1197941349', onmouseover='highlight("762304358","2081386115")', title='utils.formatdate :: (?, ?, ?) -> str'><span class='function'>formatdate</span></a>(<span class='parameter'><a name='utils.formatdate@timeval', id ='1197941296', title='utils.formatdate@timeval :: ?'><a name='utils.formatdate@timeval', id ='1197941296', onmouseover='highlight("1197885646","1197912309","1197913264")', title='utils.formatdate@timeval :: ?'>timeval</a></span></a>=<a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='1197941288', onmouseover='highlight(2016665419)', title='__builtin__.None :: ?'>None</a>, <a name='utils.formatdate@localtime', id ='1197941261', onmouseover='highlight(1197912433)', title='utils.formatdate@localtime :: ?'><span class='parameter'>localtime</a></span>=<a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='1197941230', onmouseover='highlight(2016665419)', title='__builtin__.False :: ?'>False</a>, <a name='utils.formatdate@usegmt', id ='1197941202', onmouseover='highlight(1197885458)', title='utils.formatdate@usegmt :: ?'><span class='parameter'>usegmt</span></a>=<a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='1197941195', onmouseover='highlight(2016665419)', title='__builtin__.False :: ?'>False</a>):
<span class='lineno'>125</span>     <span class='doc-string'>&quot;&quot;&quot;</span>Returns a date string as specified by RFC 2822, e.g.:
<span class='lineno'>126</span> 
<span class='lineno'>127</span>     Fri, 09 Nov 2001 01:08:47 -0000
<span class='lineno'>128</span> 
<span class='lineno'>129</span>     Optional timeval if given is a floating point time value as accepted by
<span class='lineno'>130</span>     gmtime() and localtime(), otherwise the current time is used.
<span class='lineno'>131</span> 
<span class='lineno'>132</span>     Optional localtime is a flag that when True, interprets timeval, and
<span class='lineno'>133</span>     returns a date relative to the local timezone instead of UTC, properly
<span class='lineno'>134</span>     taking daylight savings time into account.
<span class='lineno'>135</span> 
<span class='lineno'>136</span>     Optional argument usegmt means that the timezone is written out as
<span class='lineno'>137</span>     an ascii string, not numeric one (so &quot;GMT&quot; instead of &quot;+0000&quot;). This
<span class='lineno'>138</span>     is needed for HTTP, and is only used when localtime==False.
<span class='lineno'>139</span>     &quot;&quot;&quot;</span>
<span class='lineno'>140</span>     # Note: we cannot use strftime() because that honors the locale and RFC
<span class='lineno'>141</span>     # 2822 requires that day and month names be the English abbreviations.
<span class='lineno'>142</span>     if <a href='#utils.formatdate@timeval', id ='1197913264', onmouseover='highlight("1197912525","1197941296")', title='utils.formatdate@timeval :: ?'>timeval</a> is <a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='1197912581', onmouseover='highlight(2016665419)', title='__builtin__.None :: ?'><span class='builtin'>None</a></span>:
<span class='lineno'>143</span>         <span class='parameter'><a name='utils.formatdate@timeval', id ='1197912525', onmouseover='highlight("1197885646","1197912309","1197913264")', title='utils.formatdate@timeval :: ?'>timeval</a></span> = <a href='http://docs.python.org/library/time.html', id ='1197912494', onmouseover='highlight(1325127296)', title='utils.time :: time'>time</a>.<a href='http://docs.python.org/library/time.html', id ='1197912489', onmouseover='highlight(1325127296)', title='time.time :: ? -> int'>time</a>()
<span class='lineno'>144</span>     if <a href='#utils.formatdate@localtime', id ='1197912433', onmouseover='highlight(1197941261)', title='utils.formatdate@localtime :: ?'>localtime</a>:
<span class='lineno'>145</span>         <a name='utils.formatdate&now', id ='1197912372', onmouseover='highlight("1197881742","1197882543","1197881771","1197890295","1197881829","1197883573","1197881800","1197883535")', title='utils.formatdate&now :: ?'>now</a> = <a href='http://docs.python.org/library/time.html', id ='1197912366', onmouseover='highlight(1325127296)', title='utils.time :: time'>time</a>.<a href='http://docs.python.org/library/time.html', id ='1197912340', onmouseover='highlight(1325127296)', title='time.localtime :: ? -> <datetime>'>localtime</a>(<a href='#utils.formatdate@timeval', id ='1197912309', onmouseover='highlight("1197912525","1197941296")', title='utils.formatdate@timeval :: ?'>timeval</a>)
<span class='lineno'>146</span>         # Calculate timezone offset, based on whether the local zone has
<span class='lineno'>147</span>         # daylight savings time, and whether DST is in effect.
<span class='lineno'>148</span>         if <a href='http://docs.python.org/library/time.html', id ='1197890355', onmouseover='highlight(1325127296)', title='utils.time :: time'>time</a>.daylight and <a href='#utils.formatdate&now', id ='1197890295', onmouseover='highlight("1197886357","1197912372")', title='utils.formatdate&now :: ?'>now</a>[<span class='number'>-1</span>]:
<span class='lineno'>149</span>             <a name='utils.formatdate&offset', id ='1197890232', onmouseover='highlight("1197887472","1197889243")', title='utils.formatdate&offset :: int'>offset</a> = <a href='http://docs.python.org/library/time.html', id ='1197890202', onmouseover='highlight(1325127296)', title='utils.time :: time'>time</a>.<a href='http://docs.python.org/library/time.html', id ='1197889525', onmouseover='highlight(1325127296)', title='time.altzone :: int'>altzone</a>
<span class='lineno'>150</span>         else:
<span class='lineno'>151</span>             <span class='identifier'><a name='utils.formatdate&offset', id ='1197889428', onmouseover='highlight("1197887472","1197889243")', title='utils.formatdate&offset :: int'>offset</a></span> = <a href='http://docs.python.org/library/time.html', id ='1197889398', onmouseover='highlight(1325127296)', title='utils.time :: time'>time</a>.<a href='http://docs.python.org/library/time.html', id ='1197889393', onmouseover='highlight(1325127296)', title='time.timezone :: int'>timezone</a>
<span class='lineno'>152</span>         <span class='identifier'><a name='utils.formatdate&hours', id ='1197889334', onmouseover='highlight(1197886481)', title='utils.formatdate&hours :: ?'>hours</span></a>, <a name='utils.formatdate&minutes', id ='1197889306', onmouseover='highlight(1197886453)', title='utils.formatdate&minutes :: ?'><span class='identifier'>minutes</span></a> = <a href='http://docs.python.org/library/functions.html#divmod', id ='1197889275', onmouseover='highlight(906780586)', title='__builtin__.divmod :: ? -> int'>divmod</a>(<a href='http://docs.python.org/library/functions.html#abs', id ='1197889247', onmouseover='highlight(124348481)', title='__builtin__.abs :: ? -> int'>abs</a>(<a href='#utils.formatdate&offset', id ='1197889243', onmouseover='highlight("1197889428","1197890232")', title='utils.formatdate&offset :: int'>offset</a>), <span class='number'>3600</span>)
<span class='lineno'>153</span>         # Remember offset is in seconds west of UTC, but the timezone is in
<span class='lineno'>154</span>         # minutes east of UTC, so the signs differ.
<span class='lineno'>155</span>         if <a href='#utils.formatdate&offset', id ='1197887472', onmouseover='highlight("1197889428","1197890232")', title='utils.formatdate&offset :: int'>offset</a> &gt; <span class='number'>0</span>:
<span class='lineno'>156</span>             <a name='utils.formatdate&sign', id ='1197887385', onmouseover='highlight(1197886487)', title='utils.formatdate&sign :: str'>sign</a> = &#39;-&#39;
<span class='lineno'>157</span>         else:
<span class='lineno'>158</span>             <a name='utils.formatdate&sign', id ='1197886634', onmouseover='highlight(1197886487)', title='utils.formatdate&sign :: str'><span class='identifier'>sign</a></span> = &#39;+&#39;
<span class='lineno'>159</span>         <a name='utils.formatdate&zone', id ='1197886573', onmouseover='highlight(1197881705)', title='utils.formatdate&zone :: str'>zone</a> = &#39;%s%02d%02d&#39; % (<a href='#utils.formatdate&sign', id ='1197886487', onmouseover='highlight("1197886634","1197887385")', title='utils.formatdate&sign :: str'>sign</a>, <a href='#utils.formatdate&hours', id ='1197886481', onmouseover='highlight(1197889334)', title='utils.formatdate&hours :: ?'>hours</a>, <a href='#utils.formatdate&minutes', id ='1197886453', onmouseover='highlight(1197889306)', title='utils.formatdate&minutes :: ?'>minutes</a> // <span class='number'>60</span>)
<span class='lineno'>160</span>     else:
<span class='lineno'>161</span>         <a name='utils.formatdate&now', id ='1197886357', onmouseover='highlight("1197881742","1197882543","1197881771","1197890295","1197881829","1197883573","1197881800","1197883535")', title='utils.formatdate&now :: ?'><span class='identifier'>now</a></span> = <a href='http://docs.python.org/library/time.html', id ='1197885679', onmouseover='highlight(1325127296)', title='utils.time :: time'>time</a>.<a href='http://docs.python.org/library/time.html', id ='1197885674', onmouseover='highlight(1325127296)', title='time.gmtime :: ? -> <datetime>'>gmtime</a>(<a href='#utils.formatdate@timeval', id ='1197885646', onmouseover='highlight("1197912525","1197941296")', title='utils.formatdate@timeval :: ?'>timeval</a>)
<span class='lineno'>162</span>         # Timezone offset is always -0000
<span class='lineno'>163</span>         if <a href='#utils.formatdate@usegmt', id ='1197885458', onmouseover='highlight(1197941202)', title='utils.formatdate@usegmt :: ?'>usegmt</a>:
<span class='lineno'>164</span>             <a name='utils.formatdate&zone', id ='1197885396', onmouseover='highlight(1197881705)', title='utils.formatdate&zone :: str'>zone</a> = &#39;GMT&#39;
<span class='lineno'>165</span>         else:
<span class='lineno'>166</span>             <span class='identifier'><a name='utils.formatdate&zone', id ='1197884622', onmouseover='highlight(1197881705)', title='utils.formatdate&zone :: str'>zone</span></a> = &#39;-0000&#39;
<span class='lineno'>167</span>     return &#39;%s, %02d %s %04d %02d:%02d:%02d %s&#39; % (
<span class='lineno'>168</span>         [&#39;Mon&#39;, &#39;Tue&#39;, &#39;Wed&#39;, &#39;Thu&#39;, &#39;Fri&#39;, &#39;Sat&#39;, &#39;Sun&#39;][<a href='#utils.formatdate&now', id ='1197883573', onmouseover='highlight("1197886357","1197912372")', title='utils.formatdate&now :: ?'>now</a>[<span class='number'>6</span>]],
<span class='lineno'>169</span>         <a href='#utils.formatdate&now', id ='1197883535', onmouseover='highlight("1197886357","1197912372")', title='utils.formatdate&now :: ?'>now</a>[<span class='number'>2</span>],
<span class='lineno'>170</span>         [&#39;Jan&#39;, &#39;Feb&#39;, &#39;Mar&#39;, &#39;Apr&#39;, &#39;May&#39;, &#39;Jun&#39;,
<span class='lineno'>171</span>          &#39;Jul&#39;, &#39;Aug&#39;, &#39;Sep&#39;, &#39;Oct&#39;, &#39;Nov&#39;, &#39;Dec&#39;][<a href='#utils.formatdate&now', id ='1197882543', onmouseover='highlight("1197886357","1197912372")', title='utils.formatdate&now :: ?'>now</a>[<span class='number'>1</span>] - <span class='number'>1</span>],
<span class='lineno'>172</span>         <a href='#utils.formatdate&now', id ='1197881829', onmouseover='highlight("1197886357","1197912372")', title='utils.formatdate&now :: ?'>now</a>[<span class='number'>0</span>], <a href='#utils.formatdate&now', id ='1197881800', onmouseover='highlight("1197886357","1197912372")', title='utils.formatdate&now :: ?'>now</a>[<span class='number'>3</span>], <a href='#utils.formatdate&now', id ='1197881771', onmouseover='highlight("1197886357","1197912372")', title='utils.formatdate&now :: ?'>now</a>[<span class='number'>4</span>], <a href='#utils.formatdate&now', id ='1197881742', onmouseover='highlight("1197886357","1197912372")', title='utils.formatdate&now :: ?'>now</a>[<span class='number'>5</span>],
<span class='lineno'>173</span>         <a href='#utils.formatdate&zone', id ='1197881705', onmouseover='highlight("1197884622","1197885396","1197886573")', title='utils.formatdate&zone :: str'>zone</a>)
<span class='lineno'>174</span> 
<span class='lineno'>175</span> 
<span class='lineno'>176</span> 
<span class='lineno'>177</span> def <span class='function'><a name='utils.make_msgid', id ='1197881649', title='utils.make_msgid :: ? -> str'>make_msgid</a></span>(<span class='parameter'><a name='utils.make_msgid@idstring', id ='1197881617', onmouseover='highlight("1197855702","1197856658","1197857531")', title='utils.make_msgid@idstring :: str'>idstring</span></a>=<a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='1197881587', onmouseover='highlight(2016665419)', title='__builtin__.None :: ?'>None</a>):
<span class='lineno'>178</span>     <span class='doc-string'>&quot;&quot;&quot;Returns a string suitable for RFC 2822 compliant Message-ID, e.g:
<span class='lineno'>179</span> 
<span class='lineno'>180</span>     &lt;20020201195627.33539.96671@nightshade.la.mastaler.com&gt;
<span class='lineno'>181</span> 
<span class='lineno'>182</span>     Optional idstring if given is a string used to strengthen the
<span class='lineno'>183</span>     uniqueness of the message id.
<span class='lineno'>184</span>     &quot;&quot;&quot;</span>
<span class='lineno'>185</span>     <a name='utils.make_msgid&timeval', id ='1197858674', onmouseover='highlight(1197857777)', title='utils.make_msgid&timeval :: ?'><span class='identifier'>timeval</a></span> = <a href='http://docs.python.org/library/time.html', id ='1197858643', onmouseover='highlight(1325127296)', title='utils.time :: time'>time</a>.<a href='http://docs.python.org/library/time.html', id ='1197858617', onmouseover='highlight(1325127296)', title='time.time :: ? -> int'>time</a>()
<span class='lineno'>186</span>     <span class='identifier'><a name='utils.make_msgid&utcdate', id ='1197858585', onmouseover='highlight(1197855767)', title='utils.make_msgid&utcdate :: ?'>utcdate</span></a> = <a href='http://docs.python.org/library/time.html', id ='1197858554', onmouseover='highlight(1325127296)', title='utils.time :: time'>time</a>.<a href='http://docs.python.org/library/time.html', id ='1197858549', onmouseover='highlight(1325127296)', title='time.strftime :: ? -> str'>strftime</a>(&#39;%Y%m%d%H%M%S&#39;, <a href='http://docs.python.org/library/time.html', id ='1197857810', onmouseover='highlight(1325127296)', title='utils.time :: time'>time</a>.<a href='http://docs.python.org/library/time.html', id ='1197857805', onmouseover='highlight(1325127296)', title='time.gmtime :: ? -> <datetime>'>gmtime</a>(<a href='#utils.make_msgid&timeval', id ='1197857777', onmouseover='highlight(1197858674)', title='utils.make_msgid&timeval :: ?'>timeval</a>))
<span class='lineno'>187</span>     <a name='utils.make_msgid&pid', id ='1197857742', onmouseover='highlight(1197855758)', title='utils.make_msgid&pid :: ?'><span class='identifier'>pid</a></span> = <a href='http://docs.python.org/library/os.html', id ='1197857715', onmouseover='highlight(503022217)', title='utils.os :: os'>os</a>.getpid()
<span class='lineno'>188</span>     <span class='identifier'><a name='utils.make_msgid&randint', id ='1197857657', onmouseover='highlight(1197855732)', title='utils.make_msgid&randint :: ?'>randint</a></span> = <a href='../random.py.html#random', id ='1197857626', onmouseover='highlight(1808796534)', title='random :: random'>random</a>.<a href='../random.py.html#random.randrange', id ='1197857619', onmouseover='highlight(2134718540)', title='random.randrange :: (Random, int, int, int, int, ?, int) -> ?'>randrange</a>(<span class='number'>100000</span>)
<span class='lineno'>189</span>     if <a href='#utils.make_msgid@idstring', id ='1197857531', onmouseover='highlight("1197881617","1197856696","1197856812")', title='utils.make_msgid@idstring :: str'>idstring</a> is <span class='builtin'><a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='1197856847', onmouseover='highlight(2016665419)', title='__builtin__.None :: ?'>None</a></span>:
<span class='lineno'>190</span>         <a name='utils.make_msgid@idstring', id ='1197856812', onmouseover='highlight("1197855702","1197856658","1197857531")', title='utils.make_msgid@idstring :: str'>idstring</a> = &#39;&#39;
<span class='lineno'>191</span>     else:
<span class='lineno'>192</span>         <a name='utils.make_msgid@idstring', id ='1197856696', onmouseover='highlight("1197855702","1197856658","1197857531")', title='utils.make_msgid@idstring :: str'>idstring</a> = &#39;.&#39; + <a href='#utils.make_msgid@idstring', id ='1197856658', onmouseover='highlight("1197881617","1197856696","1197856812")', title='utils.make_msgid@idstring :: str'>idstring</a>
<span class='lineno'>193</span>     <span class='identifier'><a name='utils.make_msgid&idhost', id ='1197856603', onmouseover='highlight(1197855671)', title='utils.make_msgid&idhost :: ?'>idhost</a></span> = <a href='../socket.py.html#socket', id ='1197856573', onmouseover='highlight(1808796534)', title='socket :: socket'>socket</a>.<a href='../socket.py.html#socket.getfqdn', id ='1197856566', onmouseover='highlight(321217680)', title='socket.getfqdn :: str -> ?'>getfqdn</a>()
<span class='lineno'>194</span>     <a name='utils.make_msgid&msgid', id ='1197855859', onmouseover='highlight(1197855610)', title='utils.make_msgid&msgid :: str'><span class='identifier'>msgid</span></a> = &#39;&lt;%s.%s.%s%s@%s&gt;&#39; % (<a href='#utils.make_msgid&utcdate', id ='1197855767', onmouseover='highlight(1197858585)', title='utils.make_msgid&utcdate :: ?'>utcdate</a>, <a href='#utils.make_msgid&pid', id ='1197855758', onmouseover='highlight(1197857742)', title='utils.make_msgid&pid :: ?'>pid</a>, <a href='#utils.make_msgid&randint', id ='1197855732', onmouseover='highlight(1197857657)', title='utils.make_msgid&randint :: ?'>randint</a>, <a href='#utils.make_msgid@idstring', id ='1197855702', onmouseover='highlight("1197881617","1197856696","1197856812")', title='utils.make_msgid@idstring :: str'>idstring</a>, <a href='#utils.make_msgid&idhost', id ='1197855671', onmouseover='highlight(1197856603)', title='utils.make_msgid&idhost :: ?'>idhost</a>)
<span class='lineno'>195</span>     return <a href='#utils.make_msgid&msgid', id ='1197855610', onmouseover='highlight(1197855859)', title='utils.make_msgid&msgid :: str'>msgid</a>
<span class='lineno'>196</span> 
<span class='lineno'>197</span> 
<span class='lineno'>198</span> 
<span class='lineno'>199</span> # These functions are in the standalone mimelib version only because they&#39;ve
<span class='lineno'>200</span> # subsequently been fixed in the latest Python versions.  We use this to worm
<span class='lineno'>201</span> # around broken older Pythons.
<span class='lineno'>202</span> def <span class='function'><a name='utils.parsedate', id ='1197853688', title='utils.parsedate :: ? -> ?'>parsedate</a></span>(<a name='utils.parsedate@data', id ='1197853006', onmouseover='highlight("1197852814","1197852946")', title='utils.parsedate@data :: ?'><span class='parameter'>data</span></a>):
<span class='lineno'>203</span>     if not <a href='#utils.parsedate@data', id ='1197852946', onmouseover='highlight(1197853006)', title='utils.parsedate@data :: ?'>data</a>:
<span class='lineno'>204</span>         return <span class='builtin'><a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='1197852883', onmouseover='highlight(2016665419)', title='__builtin__.None :: ?'>None</span></a>
<span class='lineno'>205</span>     return _parsedate(<a href='#utils.parsedate@data', id ='1197852814', onmouseover='highlight(1197853006)', title='utils.parsedate@data :: ?'>data</a>)
<span class='lineno'>206</span> 
<span class='lineno'>207</span> 
<span class='lineno'>208</span> def <span class='function'><a name='utils.parsedate_tz', id ='1197852760', title='utils.parsedate_tz :: ? -> ?'>parsedate_tz</span></a>(<span class='parameter'><a name='utils.parsedate_tz@data', id ='1197852726', onmouseover='highlight("1197851859","1197852015")', title='utils.parsedate_tz@data :: ?'>data</span></a>):
<span class='lineno'>209</span>     if not <a href='#utils.parsedate_tz@data', id ='1197852015', onmouseover='highlight(1197852726)', title='utils.parsedate_tz@data :: ?'>data</a>:
<span class='lineno'>210</span>         return <span class='builtin'><a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='1197851952', onmouseover='highlight(2016665419)', title='__builtin__.None :: ?'>None</a></span>
<span class='lineno'>211</span>     return _parsedate_tz(<a href='#utils.parsedate_tz@data', id ='1197851859', onmouseover='highlight(1197852726)', title='utils.parsedate_tz@data :: ?'>data</a>)
<span class='lineno'>212</span> 
<span class='lineno'>213</span> 
<span class='lineno'>214</span> def <span class='function'><a name='utils.parseaddr', id ='1197851826', onmouseover='highlight("157609026","157612864")', title='utils.parseaddr :: ? -> (str, str)'>parseaddr</span></a>(<a name='utils.parseaddr@addr', id ='1197851795', onmouseover='highlight(1197830868)', title='utils.parseaddr@addr :: ?'><span class='parameter'>addr</a></span>):
<span class='lineno'>215</span>     <a name='utils.parseaddr&addrs', id ='1197851763', onmouseover='highlight("1197830776","1197830652")', title='utils.parseaddr&addrs :: ?'><span class='identifier'>addrs</span></a> = _AddressList(<a href='#utils.parseaddr@addr', id ='1197830868', onmouseover='highlight(1197851795)', title='utils.parseaddr@addr :: ?'>addr</a>).addresslist
<span class='lineno'>216</span>     if not <a href='#utils.parseaddr&addrs', id ='1197830776', onmouseover='highlight(1197851763)', title='utils.parseaddr&addrs :: ?'>addrs</a>:
<span class='lineno'>217</span>         return &#39;&#39;, &#39;&#39;
<span class='lineno'>218</span>     return <a href='#utils.parseaddr&addrs', id ='1197830652', onmouseover='highlight(1197851763)', title='utils.parseaddr&addrs :: ?'>addrs</a>[<span class='number'>0</span>]
<span class='lineno'>219</span> 
<span class='lineno'>220</span> 
<span class='lineno'>221</span> # rfc822.unquote() doesn&#39;t properly de-backslash-ify in Python pre-2.3.
<span class='lineno'>222</span> def <span class='function'><a name='utils.unquote', id ='1197829725', onmouseover='highlight("1197736539","1197771320","1197733712")', title='utils.unquote :: ? -> ?'>unquote</span></a>(<span class='parameter'><a name='utils.unquote@str', id ='1197829696', onmouseover='highlight("1197827982","1197827772","1197828821","1197828734","1197826870","1197826933","1197828884","1197827055")', title='utils.unquote@str :: ?'>str</a></span>):
<span class='lineno'>223</span>     <span class='doc-string'>&quot;&quot;&quot;Remove quotes from a string.&quot;&quot;&quot;</span>
<span class='lineno'>224</span>     if <a href='http://docs.python.org/library/functions.html#len', id ='1197828888', onmouseover='highlight(134591780)', title='__builtin__.len :: ? -> int'>len</a>(<a href='#utils.unquote@str', id ='1197828884', onmouseover='highlight(1197829696)', title='utils.unquote@str :: ?'>str</a>) &gt; <span class='number'>1</span>:
<span class='lineno'>225</span>         if <a href='#utils.unquote@str', id ='1197828821', onmouseover='highlight(1197829696)', title='utils.unquote@str :: ?'>str</a>.startswith(<span class='doc-string'>&#39;&quot;&#39;</span>) and <a href='#utils.unquote@str', id ='1197828734', onmouseover='highlight(1197829696)', title='utils.unquote@str :: ?'>str</a>.endswith(<span class='doc-string'>&#39;&quot;&#39;</span>):
<span class='lineno'>226</span>             return <a href='#utils.unquote@str', id ='1197827982', onmouseover='highlight(1197829696)', title='utils.unquote@str :: ?'>str</a>[<span class='number'>1</span>:<span class='number'>-1</span>].replace(&#39;\\\\&#39;, &#39;\\&#39;).replace(&#39;\\&quot;&#39;, <span class='doc-string'>&#39;&quot;&#39;</span>)
<span class='lineno'>227</span>         if <a href='#utils.unquote@str', id ='1197827772', onmouseover='highlight(1197829696)', title='utils.unquote@str :: ?'>str</a>.startswith(&#39;&lt;&#39;) and <a href='#utils.unquote@str', id ='1197827055', onmouseover='highlight(1197829696)', title='utils.unquote@str :: ?'>str</a>.endswith(&#39;&gt;&#39;):
<span class='lineno'>228</span>             return <a href='#utils.unquote@str', id ='1197826933', onmouseover='highlight(1197829696)', title='utils.unquote@str :: ?'>str</a>[<span class='number'>1</span>:<span class='number'>-1</span>]
<span class='lineno'>229</span>     return <a href='#utils.unquote@str', id ='1197826870', onmouseover='highlight(1197829696)', title='utils.unquote@str :: ?'>str</a>
<span class='lineno'>230</span> 
<span class='lineno'>231</span> 
<span class='lineno'>232</span> 
<span class='lineno'>233</span> # RFC2231-related functions - parameter encoding and decoding
<span class='lineno'>234</span> def <span class='function'><a name='utils.decode_rfc2231', id ='1197825998', onmouseover='highlight(1197739607)', title='utils.decode_rfc2231 :: [?] -> (?, ?, [?])'>decode_rfc2231</a></span>(<a name='utils.decode_rfc2231@s', id ='1197825941', onmouseover='highlight("1197824887","1197825102")', title='utils.decode_rfc2231@s :: [?]'><span class='parameter'>s</span></a>):
<span class='lineno'>235</span>     <span class='doc-string'>&quot;&quot;&quot;Decode string according to RFC 2231&quot;&quot;&quot;</span>
<span class='lineno'>236</span>     <span class='identifier'><a name='utils.decode_rfc2231&parts', id ='1197825131', onmouseover='highlight("1197825011","1197824853")', title='utils.decode_rfc2231&parts :: ?'>parts</a></span> = <a href='#utils.decode_rfc2231@s', id ='1197825102', onmouseover='highlight(1197825941)', title='utils.decode_rfc2231@s :: [?]'>s</a>.split(<a href='#utils.TICK', id ='1197825073', onmouseover='highlight(1197979793)', title='utils.TICK :: str'>TICK</a>, <span class='number'>2</span>)
<span class='lineno'>237</span>     if <a href='http://docs.python.org/library/functions.html#len', id ='1197825015', onmouseover='highlight(134591780)', title='__builtin__.len :: ? -> int'>len</a>(<a href='#utils.decode_rfc2231&parts', id ='1197825011', onmouseover='highlight(1197825131)', title='utils.decode_rfc2231&parts :: ?'>parts</a>) &lt;= <span class='number'>2</span>:
<span class='lineno'>238</span>         return <a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='1197824920', onmouseover='highlight(2016665419)', title='__builtin__.None :: ?'><span class='builtin'>None</span></a>, <span class='builtin'><a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='1197824914', onmouseover='highlight(2016665419)', title='__builtin__.None :: ?'>None</span></a>, <a href='#utils.decode_rfc2231@s', id ='1197824887', onmouseover='highlight(1197825941)', title='utils.decode_rfc2231@s :: [?]'>s</a>
<span class='lineno'>239</span>     return <a href='#utils.decode_rfc2231&parts', id ='1197824853', onmouseover='highlight(1197825131)', title='utils.decode_rfc2231&parts :: ?'>parts</a>
<span class='lineno'>240</span> 
<span class='lineno'>241</span> 
<span class='lineno'>242</span> def <span class='function'><a name='utils.encode_rfc2231', id ='1197824169', title='utils.encode_rfc2231 :: (?, ?, ?) -> str'>encode_rfc2231</span></a>(<a name='utils.encode_rfc2231@s', id ='1197824112', onmouseover='highlight("1197801045","1197800826","1197799872")', title='utils.encode_rfc2231@s :: ?'>s</a>, <span class='parameter'><a name='utils.encode_rfc2231@charset', id ='1197824109', onmouseover='highlight("1197799933","1197800984")', title='utils.encode_rfc2231@charset :: ?'>charset</span></a>=<a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='1197824080', onmouseover='highlight(2016665419)', title='__builtin__.None :: ?'>None</a>, <a name='utils.encode_rfc2231@language', id ='1197824053', onmouseover='highlight("1197799903","1197800145","1197800922")', title='utils.encode_rfc2231@language :: str'>language</a>=<a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='1197824023', onmouseover='highlight(2016665419)', title='__builtin__.None :: ?'>None</a>):
<span class='lineno'>243</span>     <span class='doc-string'>&quot;&quot;&quot;Encode string according to RFC 2231.
<span class='lineno'>244</span> 
<span class='lineno'>245</span>     If neither charset nor language is given, then s is returned as-is.  If
<span class='lineno'>246</span>     charset is given but not language, the string is encoded using the empty
<span class='lineno'>247</span>     string for language.
<span class='lineno'>248</span>     &quot;&quot;&quot;</span>
<span class='lineno'>249</span>     import urllib
<span class='lineno'>250</span>     <span class='parameter'><a name='utils.encode_rfc2231@s', id ='1197801083', onmouseover='highlight("1197801045","1197800826","1197799872")', title='utils.encode_rfc2231@s :: ?'>s</span></a> = <a href='../urllib.py.html#urllib', id ='1197801079', onmouseover='highlight(1808796534)', title='urllib :: urllib'>urllib</a>.<a href='../urllib.py.html#urllib.quote', id ='1197801051', onmouseover='highlight(2084040299)', title='urllib.quote :: (str, str) -> str'>quote</a>(<a href='#utils.encode_rfc2231@s', id ='1197801045', onmouseover='highlight("1197801083","1197824112")', title='utils.encode_rfc2231@s :: ?'>s</a>, safe=&#39;&#39;)
<span class='lineno'>251</span>     if <a href='#utils.encode_rfc2231@charset', id ='1197800984', onmouseover='highlight(1197824109)', title='utils.encode_rfc2231@charset :: ?'>charset</a> is <span class='builtin'><a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='1197800952', onmouseover='highlight(2016665419)', title='__builtin__.None :: ?'>None</a></span> and <a href='#utils.encode_rfc2231@language', id ='1197800922', onmouseover='highlight("1197800056","1197824053")', title='utils.encode_rfc2231@language :: str'>language</a> is <a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='1197800889', onmouseover='highlight(2016665419)', title='__builtin__.None :: ?'><span class='builtin'>None</a></span>:
<span class='lineno'>252</span>         return <a href='#utils.encode_rfc2231@s', id ='1197800826', onmouseover='highlight("1197801083","1197824112")', title='utils.encode_rfc2231@s :: ?'>s</a>
<span class='lineno'>253</span>     if <a href='#utils.encode_rfc2231@language', id ='1197800145', onmouseover='highlight("1197800056","1197824053")', title='utils.encode_rfc2231@language :: str'>language</a> is <a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='1197800091', onmouseover='highlight(2016665419)', title='__builtin__.None :: ?'><span class='builtin'>None</a></span>:
<span class='lineno'>254</span>         <span class='parameter'><a name='utils.encode_rfc2231@language', id ='1197800056', onmouseover='highlight("1197799903","1197800145","1197800922")', title='utils.encode_rfc2231@language :: str'>language</span></a> = &#39;&#39;
<span class='lineno'>255</span>     return &quot;%s&#39;%s&#39;%s&quot; % (<a href='#utils.encode_rfc2231@charset', id ='1197799933', onmouseover='highlight(1197824109)', title='utils.encode_rfc2231@charset :: ?'>charset</a>, <a href='#utils.encode_rfc2231@language', id ='1197799903', onmouseover='highlight("1197800056","1197824053")', title='utils.encode_rfc2231@language :: str'>language</a>, <a href='#utils.encode_rfc2231@s', id ='1197799872', onmouseover='highlight("1197801083","1197824112")', title='utils.encode_rfc2231@s :: ?'>s</a>)
<span class='lineno'>256</span> 
<span class='lineno'>257</span> 
<span class='lineno'>258</span> <a name='utils.rfc2231_continuation', id ='1197799867', onmouseover='highlight(1197771229)', title='utils.rfc2231_continuation :: ?'>rfc2231_continuation</a> = <a href='../re.py.html#re', id ='1197799130', onmouseover='highlight(1808796534)', title='re :: re'>re</a>.<a href='../re.py.html#re.compile', id ='1197799127', onmouseover='highlight(2025599818)', title='re.compile :: (str, int) -> ? | (my_unicode, int) -> ?'>compile</a>(r&#39;^(?P&lt;name&gt;\w+)\*((?P&lt;num&gt;[0-9]+)\*?)?$&#39;)
<span class='lineno'>259</span> 
<span class='lineno'>260</span> def <a name='utils.decode_params', id ='1197798966', title='utils.decode_params :: ? -> [?]'><span class='function'>decode_params</a></span>(<a name='utils.decode_params@params', id ='1197798910', onmouseover='highlight("1197796303","1197793206","1197793299","1197794137")', title='utils.decode_params@params :: ?'>params</a>):
<span class='lineno'>261</span>     <span class='doc-string'>&quot;&quot;&quot;Decode parameters list according to RFC 2231.
<span class='lineno'>262</span> 
<span class='lineno'>263</span>     params is a sequence of 2-tuples containing (param name, string value).
<span class='lineno'>264</span>     &quot;&quot;&quot;</span>
<span class='lineno'>265</span>     # Copy params so we don&#39;t mess with the original
<span class='lineno'>266</span>     <span class='parameter'><a name='utils.decode_params@params', id ='1197796984', onmouseover='highlight("1197796303","1197793206","1197793299","1197794137")', title='utils.decode_params@params :: ?'>params</a></span> = <a href='#utils.decode_params@params', id ='1197796303', onmouseover='highlight("1197796984","1197798910")', title='utils.decode_params@params :: ?'>params</a>[:]
<span class='lineno'>267</span>     <span class='identifier'><a name='utils.decode_params&new_params', id ='1197796247', onmouseover='highlight("1197769118","1197793426","1197738548","1197739485","1197738369")', title='utils.decode_params&new_params :: [?]'>new_params</a></span> = []
<span class='lineno'>268</span>     # Map parameter&#39;s name to a list of continuations.  The values are a
<span class='lineno'>269</span>     # 3-tuple of the continuation number, the string value, and a flag
<span class='lineno'>270</span>     # specifying whether a particular segment is %-encoded.
<span class='lineno'>271</span>     <span class='identifier'><a name='utils.decode_params&rfc2231_params', id ='1197794259', onmouseover='highlight("1197768285","1197769399","1197767478")', title='utils.decode_params&rfc2231_params :: {?:?}'>rfc2231_params</span></a> = {}
<span class='lineno'>272</span>     <a name='utils.decode_params&name', id ='1197794193', onmouseover='highlight("1197739424","1197738487","1197769331","1197793139","1197771160","1197768406","1197793386")', title='utils.decode_params&name :: ?'>name</a>, <a name='utils.decode_params&value', id ='1197794166', onmouseover='highlight("1197739571","1197740502","1197771291","1197739326","1197793359","1197738430","1197768343","1197741338","1197769245")', title='utils.decode_params&value :: [?]'>value</a> = <a href='#utils.decode_params@params', id ='1197794137', onmouseover='highlight("1197796984","1197798910")', title='utils.decode_params@params :: ?'>params</a>.pop(<span class='number'>0</span>)
<span class='lineno'>273</span>     <a href='#utils.decode_params&new_params', id ='1197793426', onmouseover='highlight(1197796247)', title='utils.decode_params&new_params :: [?]'>new_params</a>.<a href='http://docs.python.org/library/stdtypes.html', id ='1197793394', onmouseover='highlight(592677897)', title='__builtin__.list.append :: ? -> None'>append</a>((<a href='#utils.decode_params&name', id ='1197793386', onmouseover='highlight("1197768215","1197771043","1197794193","1197793262")', title='utils.decode_params&name :: ?'>name</a>, <a href='#utils.decode_params&value', id ='1197793359', onmouseover='highlight("1197741247","1197767379","1197793235","1197792181","1197794166","1197740287")', title='utils.decode_params&value :: [?]'>value</a>))
<span class='lineno'>274</span>     while <a href='#utils.decode_params@params', id ='1197793299', onmouseover='highlight("1197796984","1197798910")', title='utils.decode_params@params :: ?'>params</a>:
<span class='lineno'>275</span>         <a name='utils.decode_params&name', id ='1197793262', onmouseover='highlight("1197739424","1197738487","1197769331","1197793139","1197771160","1197768406","1197793386")', title='utils.decode_params&name :: ?'>name</a>, <a name='utils.decode_params&value', id ='1197793235', onmouseover='highlight("1197739571","1197740502","1197771291","1197739326","1197793359","1197738430","1197768343","1197741338","1197769245")', title='utils.decode_params&value :: [?]'>value</a> = <a href='#utils.decode_params@params', id ='1197793206', onmouseover='highlight("1197796984","1197798910")', title='utils.decode_params@params :: ?'>params</a>.pop(<span class='number'>0</span>)
<span class='lineno'>276</span>         if <a href='#utils.decode_params&name', id ='1197793139', onmouseover='highlight("1197768215","1197771043","1197794193","1197793262")', title='utils.decode_params&name :: ?'>name</a>.endswith(&#39;*&#39;):
<span class='lineno'>277</span>             <a name='utils.decode_params&encoded', id ='1197792372', onmouseover='highlight("1197762483","1197769238")', title='utils.decode_params&encoded :: ?'>encoded</a> = <span class='builtin'><a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='1197792341', onmouseover='highlight(2016665419)', title='__builtin__.True :: ?'>True</a></span>
<span class='lineno'>278</span>         else:
<span class='lineno'>279</span>             <a name='utils.decode_params&encoded', id ='1197792247', onmouseover='highlight("1197762483","1197769238")', title='utils.decode_params&encoded :: ?'>encoded</a> = <span class='builtin'><a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='1197792216', onmouseover='highlight(2016665419)', title='__builtin__.False :: ?'>False</a></span>
<span class='lineno'>280</span>         <a name='utils.decode_params&value', id ='1197792181', onmouseover='highlight("1197739571","1197740502","1197771291","1197739326","1197793359","1197738430","1197768343","1197741338","1197769245")', title='utils.decode_params&value :: [?]'>value</a> = <a href='#utils.unquote', id ='1197771320', onmouseover='highlight(1197829725)', title='utils.unquote :: ? -> ?'>unquote</a>(<a href='#utils.decode_params&value', id ='1197771291', onmouseover='highlight("1197741247","1197767379","1197793235","1197792181","1197794166","1197740287")', title='utils.decode_params&value :: [?]'>value</a>)
<span class='lineno'>281</span>         <a name='utils.decode_params&mo', id ='1197771255', onmouseover='highlight("1197770359","1197771101")', title='utils.decode_params&mo :: ?'><span class='identifier'>mo</a></span> = <a href='#utils.rfc2231_continuation', id ='1197771229', onmouseover='highlight(1197799867)', title='utils.rfc2231_continuation :: ?'>rfc2231_continuation</a>.match(<a href='#utils.decode_params&name', id ='1197771160', onmouseover='highlight("1197768215","1197771043","1197794193","1197793262")', title='utils.decode_params&name :: ?'>name</a>)
<span class='lineno'>282</span>         if <a href='#utils.decode_params&mo', id ='1197771101', onmouseover='highlight(1197771255)', title='utils.decode_params&mo :: ?'>mo</a>:
<span class='lineno'>283</span>             <a name='utils.decode_params&name', id ='1197771043', onmouseover='highlight("1197739424","1197738487","1197769331","1197793139","1197771160","1197768406","1197793386")', title='utils.decode_params&name :: ?'>name</a>, <a name='utils.decode_params&num', id ='1197771037', onmouseover='highlight("1197770236","1197769271","1197770109")', title='utils.decode_params&num :: ?'>num</a> = <a href='#utils.decode_params&mo', id ='1197770359', onmouseover='highlight(1197771255)', title='utils.decode_params&mo :: ?'>mo</a>.group(&#39;name&#39;, &#39;num&#39;)
<span class='lineno'>284</span>             if <a href='#utils.decode_params&num', id ='1197770236', onmouseover='highlight("1197762641","1197771037","1197770140")', title='utils.decode_params&num :: ?'>num</a> is not <a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='1197770204', onmouseover='highlight(2016665419)', title='__builtin__.None :: ?'><span class='builtin'>None</span></a>:
<span class='lineno'>285</span>                 <a name='utils.decode_params&num', id ='1197770140', onmouseover='highlight("1197770236","1197769271","1197770109")', title='utils.decode_params&num :: ?'>num</a> = <a href='http://docs.python.org/library/functions.html#int', id ='1197770113', onmouseover='highlight(132095102)', title='__builtin__.int :: int'>int</a>(<a href='#utils.decode_params&num', id ='1197770109', onmouseover='highlight("1197762641","1197771037","1197770140")', title='utils.decode_params&num :: ?'>num</a>)
<span class='lineno'>286</span>             <a href='#utils.decode_params&rfc2231_params', id ='1197769399', onmouseover='highlight(1197794259)', title='utils.decode_params&rfc2231_params :: {?:?}'>rfc2231_params</a>.<a href='http://docs.python.org/tutorial/datastructures.html#dictionaries', id ='1197769363', onmouseover='highlight(1629002017)', title='__builtin__.dict.setdefault :: '>setdefault</a>(<a href='#utils.decode_params&name', id ='1197769331', onmouseover='highlight("1197768215","1197771043","1197794193","1197793262")', title='utils.decode_params&name :: ?'>name</a>, []).append((<a href='#utils.decode_params&num', id ='1197769271', onmouseover='highlight("1197762641","1197771037","1197770140")', title='utils.decode_params&num :: ?'>num</a>, <a href='#utils.decode_params&value', id ='1197769245', onmouseover='highlight("1197741247","1197767379","1197793235","1197792181","1197794166","1197740287")', title='utils.decode_params&value :: [?]'>value</a>, <a href='#utils.decode_params&encoded', id ='1197769238', onmouseover='highlight("1197762612","1197792247","1197792372")', title='utils.decode_params&encoded :: ?'>encoded</a>))
<span class='lineno'>287</span>         else:
<span class='lineno'>288</span>             <a href='#utils.decode_params&new_params', id ='1197769118', onmouseover='highlight(1197796247)', title='utils.decode_params&new_params :: [?]'>new_params</a>.<a href='http://docs.python.org/library/stdtypes.html', id ='1197768435', onmouseover='highlight(592677897)', title='__builtin__.list.append :: ? -> None'>append</a>((<a href='#utils.decode_params&name', id ='1197768406', onmouseover='highlight("1197768215","1197771043","1197794193","1197793262")', title='utils.decode_params&name :: ?'>name</a>, &#39;&quot;%s&quot;&#39; % quote(<a href='#utils.decode_params&value', id ='1197768343', onmouseover='highlight("1197741247","1197767379","1197793235","1197792181","1197794166","1197740287")', title='utils.decode_params&value :: [?]'>value</a>)))
<span class='lineno'>289</span>     if <a href='#utils.decode_params&rfc2231_params', id ='1197768285', onmouseover='highlight(1197794259)', title='utils.decode_params&rfc2231_params :: {?:?}'>rfc2231_params</a>:
<span class='lineno'>290</span>         for <span class='identifier'><a name='utils.decode_params&name', id ='1197768215', onmouseover='highlight("1197739424","1197738487","1197769331","1197793139","1197771160","1197768406","1197793386")', title='utils.decode_params&name :: ?'>name</span></a>, <a name='utils.decode_params&continuations', id ='1197768188', onmouseover='highlight("1197762580","1197766479")', title='utils.decode_params&continuations :: ?'>continuations</a> in <a href='#utils.decode_params&rfc2231_params', id ='1197767478', onmouseover='highlight(1197794259)', title='utils.decode_params&rfc2231_params :: {?:?}'>rfc2231_params</a>.<a href='http://docs.python.org/tutorial/datastructures.html#dictionaries', id ='1197767442', onmouseover='highlight(1629002017)', title='__builtin__.dict.items :: ? -> [(?, ?)]'>items</a>():
<span class='lineno'>291</span>             <a name='utils.decode_params&value', id ='1197767379', onmouseover='highlight("1197739571","1197740502","1197771291","1197739326","1197793359","1197738430","1197768343","1197741338","1197769245")', title='utils.decode_params&value :: [?]'>value</a> = []
<span class='lineno'>292</span>             <a name='utils.decode_params&extended', id ='1197767293', onmouseover='highlight(1197740416)', title='utils.decode_params&extended :: ?'>extended</a> = <span class='builtin'><a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='1197767261', onmouseover='highlight(2016665419)', title='__builtin__.False :: ?'>False</span></a>
<span class='lineno'>293</span>             # Sort by number
<span class='lineno'>294</span>             <a href='#utils.decode_params&continuations', id ='1197766479', onmouseover='highlight(1197768188)', title='utils.decode_params&continuations :: ?'>continuations</a>.sort()
<span class='lineno'>295</span>             # And now append all values in numerical order, converting
<span class='lineno'>296</span>             # %-encodings for the encoded segments.  If any of the
<span class='lineno'>297</span>             # continuation names ends in a *, then the entire string, after
<span class='lineno'>298</span>             # decoding segments and concatenating, must have the charset and
<span class='lineno'>299</span>             # language specifiers at the beginning of the string.
<span class='lineno'>300</span>             for <a name='utils.decode_params&num', id ='1197762641', onmouseover='highlight("1197770236","1197769271","1197770109")', title='utils.decode_params&num :: ?'><span class='identifier'>num</span></a>, <a name='utils.decode_params&s', id ='1197762636', onmouseover='highlight("1197741283","1197741498")', title='utils.decode_params&s :: ?'>s</a>, <a name='utils.decode_params&encoded', id ='1197762612', onmouseover='highlight("1197762483","1197769238")', title='utils.decode_params&encoded :: ?'><span class='identifier'>encoded</a></span> in <a href='#utils.decode_params&continuations', id ='1197762580', onmouseover='highlight(1197768188)', title='utils.decode_params&continuations :: ?'>continuations</a>:
<span class='lineno'>301</span>                 if <a href='#utils.decode_params&encoded', id ='1197762483', onmouseover='highlight("1197762612","1197792247","1197792372")', title='utils.decode_params&encoded :: ?'>encoded</a>:
<span class='lineno'>302</span>                     <a name='utils.decode_params&s', id ='1197762391', onmouseover='highlight("1197741283","1197741498")', title='utils.decode_params&s :: ?'>s</a> = <a href='../urllib.py.html#urllib', id ='1197762387', onmouseover='highlight(1808796534)', title='urllib :: urllib'>urllib</a>.<a href='../urllib.py.html#urllib.unquote', id ='1197741527', onmouseover='highlight(2084009482)', title='urllib.unquote :: str -> str'>unquote</a>(<a href='#utils.decode_params&s', id ='1197741498', onmouseover='highlight("1197762391","1197762636")', title='utils.decode_params&s :: ?'>s</a>)
<span class='lineno'>303</span>                     <a name='utils.decode_params&extended', id ='1197741433', onmouseover='highlight(1197740416)', title='utils.decode_params&extended :: ?'><span class='identifier'>extended</a></span> = <a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='1197741401', onmouseover='highlight(2016665419)', title='__builtin__.True :: ?'><span class='builtin'>True</a></span>
<span class='lineno'>304</span>                 <a href='#utils.decode_params&value', id ='1197741338', onmouseover='highlight("1197741247","1197767379","1197793235","1197792181","1197794166","1197740287")', title='utils.decode_params&value :: [?]'>value</a>.<a href='http://docs.python.org/library/stdtypes.html', id ='1197741311', onmouseover='highlight(592677897)', title='__builtin__.list.append :: ? -> None'>append</a>(<a href='#utils.decode_params&s', id ='1197741283', onmouseover='highlight("1197762391","1197762636")', title='utils.decode_params&s :: ?'>s</a>)
<span class='lineno'>305</span>             <a name='utils.decode_params&value', id ='1197741247', onmouseover='highlight("1197739571","1197740502","1197771291","1197739326","1197793359","1197738430","1197768343","1197741338","1197769245")', title='utils.decode_params&value :: [?]'><span class='identifier'>value</a></span> = quote(<a href='#utils.EMPTYSTRING', id ='1197740540', onmouseover='highlight(1208289386)', title='utils.EMPTYSTRING :: str'>EMPTYSTRING</a>.<a href='http://docs.python.org/library/stdtypes.html#str.join', id ='1197740507', onmouseover='highlight(760704539)', title='__builtin__.str.join :: ? -> str'>join</a>(<a href='#utils.decode_params&value', id ='1197740502', onmouseover='highlight("1197741247","1197767379","1197793235","1197792181","1197794166","1197740287")', title='utils.decode_params&value :: [?]'>value</a>))
<span class='lineno'>306</span>             if <a href='#utils.decode_params&extended', id ='1197740416', onmouseover='highlight("1197741433","1197767293")', title='utils.decode_params&extended :: ?'>extended</a>:
<span class='lineno'>307</span>                 <span class='identifier'><a name='utils.decode_params&charset', id ='1197740348', onmouseover='highlight(1197739417)', title='utils.decode_params&charset :: ?'>charset</a></span>, <span class='identifier'><a name='utils.decode_params&language', id ='1197740318', onmouseover='highlight(1197739387)', title='utils.decode_params&language :: ?'>language</span></a>, <a name='utils.decode_params&value', id ='1197740287', onmouseover='highlight("1197739571","1197740502","1197771291","1197739326","1197793359","1197738430","1197768343","1197741338","1197769245")', title='utils.decode_params&value :: [?]'>value</a> = <a href='#utils.decode_rfc2231', id ='1197739607', onmouseover='highlight(1197825998)', title='utils.decode_rfc2231 :: [?] -> (?, ?, [?])'>decode_rfc2231</a>(<a href='#utils.decode_params&value', id ='1197739571', onmouseover='highlight("1197741247","1197767379","1197793235","1197792181","1197794166","1197740287")', title='utils.decode_params&value :: [?]'>value</a>)
<span class='lineno'>308</span>                 <a href='#utils.decode_params&new_params', id ='1197739485', onmouseover='highlight(1197796247)', title='utils.decode_params&new_params :: [?]'>new_params</a>.<a href='http://docs.python.org/library/stdtypes.html', id ='1197739453', onmouseover='highlight(592677897)', title='__builtin__.list.append :: ? -> None'>append</a>((<a href='#utils.decode_params&name', id ='1197739424', onmouseover='highlight("1197768215","1197771043","1197794193","1197793262")', title='utils.decode_params&name :: ?'>name</a>, (<a href='#utils.decode_params&charset', id ='1197739417', onmouseover='highlight(1197740348)', title='utils.decode_params&charset :: ?'>charset</a>, <a href='#utils.decode_params&language', id ='1197739387', onmouseover='highlight(1197740318)', title='utils.decode_params&language :: ?'>language</a>, &#39;&quot;%s&quot;&#39; % <a href='#utils.decode_params&value', id ='1197739326', onmouseover='highlight("1197741247","1197767379","1197793235","1197792181","1197794166","1197740287")', title='utils.decode_params&value :: [?]'>value</a>)))
<span class='lineno'>309</span>             else:
<span class='lineno'>310</span>                 <a href='#utils.decode_params&new_params', id ='1197738548', onmouseover='highlight(1197796247)', title='utils.decode_params&new_params :: [?]'>new_params</a>.<a href='http://docs.python.org/library/stdtypes.html', id ='1197738516', onmouseover='highlight(592677897)', title='__builtin__.list.append :: ? -> None'>append</a>((<a href='#utils.decode_params&name', id ='1197738487', onmouseover='highlight("1197768215","1197771043","1197794193","1197793262")', title='utils.decode_params&name :: ?'>name</a>, &#39;&quot;%s&quot;&#39; % <a href='#utils.decode_params&value', id ='1197738430', onmouseover='highlight("1197741247","1197767379","1197793235","1197792181","1197794166","1197740287")', title='utils.decode_params&value :: [?]'>value</a>))
<span class='lineno'>311</span>     return <a href='#utils.decode_params&new_params', id ='1197738369', onmouseover='highlight(1197796247)', title='utils.decode_params&new_params :: [?]'>new_params</a>
<span class='lineno'>312</span> 
<span class='lineno'>313</span> def <a name='utils.collapse_rfc2231_value', id ='1197737681', title='utils.collapse_rfc2231_value :: (?, str, str) -> ?'><span class='function'>collapse_rfc2231_value</a></span>(<a name='utils.collapse_rfc2231_value@value', id ='1197737595', onmouseover='highlight("1197733683","1197736634","1197736510","1197736440")', title='utils.collapse_rfc2231_value@value :: ?'><span class='parameter'>value</a></span>, <span class='parameter'><a name='utils.collapse_rfc2231_value@errors', id ='1197737588', onmouseover='highlight("1197733808","1197735541")', title='utils.collapse_rfc2231_value@errors :: str'>errors</a></span>=&#39;replace&#39;,
<span class='lineno'>314</span>                            <a name='utils.collapse_rfc2231_value@fallback_charset', id ='1197737438', onmouseover='highlight(1197734519)', title='utils.collapse_rfc2231_value@fallback_charset :: str'><span class='parameter'>fallback_charset</a></span>=&#39;us-ascii&#39;):
<span class='lineno'>315</span>     if <a href='http://docs.python.org/library/functions.html#isinstance', id ='1197736687', onmouseover='highlight(37741720)', title='__builtin__.isinstance :: ? -> int'>isinstance</a>(<a href='#utils.collapse_rfc2231_value@value', id ='1197736634', onmouseover='highlight(1197737595)', title='utils.collapse_rfc2231_value@value :: ?'>value</a>, <a href='http://docs.python.org/library/functions.html#tuple', id ='1197736627', onmouseover='highlight(534381737)', title='__builtin__.tuple :: <tuple>'>tuple</a>):
<span class='lineno'>316</span>         <span class='identifier'><a name='utils.collapse_rfc2231_value&rawval', id ='1197736569', onmouseover='highlight("1197735579","1197734548")', title='utils.collapse_rfc2231_value&rawval :: ?'>rawval</span></a> = <a href='#utils.unquote', id ='1197736539', onmouseover='highlight(1197829725)', title='utils.unquote :: ? -> ?'>unquote</a>(<a href='#utils.collapse_rfc2231_value@value', id ='1197736510', onmouseover='highlight(1197737595)', title='utils.collapse_rfc2231_value@value :: ?'>value</a>[<span class='number'>2</span>])
<span class='lineno'>317</span>         <span class='identifier'><a name='utils.collapse_rfc2231_value&charset', id ='1197736471', onmouseover='highlight(1197735571)', title='utils.collapse_rfc2231_value&charset :: str'>charset</a></span> = <a href='#utils.collapse_rfc2231_value@value', id ='1197736440', onmouseover='highlight(1197737595)', title='utils.collapse_rfc2231_value@value :: ?'>value</a>[<span class='number'>0</span>] or &#39;us-ascii&#39;
<span class='lineno'>318</span>         try:
<span class='lineno'>319</span>             return <a href='http://docs.python.org/library/functions.html#unicode', id ='1197735608', onmouseover='highlight(1431294356)', title='__builtin__.unicode :: ? -> ?'>unicode</a>(<a href='#utils.collapse_rfc2231_value&rawval', id ='1197735579', onmouseover='highlight(1197736569)', title='utils.collapse_rfc2231_value&rawval :: ?'>rawval</a>, <a href='#utils.collapse_rfc2231_value&charset', id ='1197735571', onmouseover='highlight(1197736471)', title='utils.collapse_rfc2231_value&charset :: str'>charset</a>, <a href='#utils.collapse_rfc2231_value@errors', id ='1197735541', onmouseover='highlight(1197737588)', title='utils.collapse_rfc2231_value@errors :: str'>errors</a>)
<span class='lineno'>320</span>         except <a href='http://docs.python.org/reference/datamodel#org/yinwang/pysonar/types', id ='1197734804', onmouseover='highlight(2016665419)', title='__builtin__.LookupError :: <LookupError>'>LookupError</a>:
<span class='lineno'>321</span>             # XXX charset is unknown to Python.
<span class='lineno'>322</span>             return <a href='http://docs.python.org/library/functions.html#unicode', id ='1197734556', onmouseover='highlight(1431294356)', title='__builtin__.unicode :: ? -> ?'>unicode</a>(<a href='#utils.collapse_rfc2231_value&rawval', id ='1197734548', onmouseover='highlight(1197736569)', title='utils.collapse_rfc2231_value&rawval :: ?'>rawval</a>, <a href='#utils.collapse_rfc2231_value@fallback_charset', id ='1197734519', onmouseover='highlight(1197737438)', title='utils.collapse_rfc2231_value@fallback_charset :: str'>fallback_charset</a>, <a href='#utils.collapse_rfc2231_value@errors', id ='1197733808', onmouseover='highlight(1197737588)', title='utils.collapse_rfc2231_value@errors :: str'>errors</a>)
<span class='lineno'>323</span>     else:
<span class='lineno'>324</span>         return <a href='#utils.unquote', id ='1197733712', onmouseover='highlight(1197829725)', title='utils.unquote :: ? -> ?'>unquote</a>(<a href='#utils.collapse_rfc2231_value@value', id ='1197733683', onmouseover='highlight(1197737595)', title='utils.collapse_rfc2231_value@value :: ?'>value</a>)
</pre></td></tr></table></body></html>